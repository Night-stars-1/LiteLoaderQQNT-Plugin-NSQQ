var Nu=Object.create;var Hr=Object.defineProperty;var Fu=Object.getOwnPropertyDescriptor;var Uu=Object.getOwnPropertyNames;var Mu=Object.getPrototypeOf,ju=Object.prototype.hasOwnProperty;var $t=(r,t)=>()=>(r&&(t=r(r=0)),t);var M=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),eo=(r,t)=>{for(var i in t)Hr(r,i,{get:t[i],enumerable:!0})},to=(r,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Uu(t))!ju.call(r,o)&&o!==i&&Hr(r,o,{get:()=>t[o],enumerable:!(s=Fu(t,o))||s.enumerable});return r};var V=(r,t,i)=>(i=r!=null?Nu(Mu(r)):{},to(t||!r||!r.__esModule?Hr(i,"default",{value:r,enumerable:!0}):i,r)),zu=r=>to(Hr({},"__esModule",{value:!0}),r);var no=M((Kc,ro)=>{"use strict";function Vr(){this._types=Object.create(null),this._extensions=Object.create(null);for(let r=0;r<arguments.length;r++)this.define(arguments[r]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Vr.prototype.define=function(r,t){for(let i in r){let s=r[i].map(function(o){return o.toLowerCase()});i=i.toLowerCase();for(let o=0;o<s.length;o++){let l=s[o];if(l[0]!=="*"){if(!t&&l in this._types)throw new Error('Attempt to change mapping for "'+l+'" extension from "'+this._types[l]+'" to "'+i+'". Pass `force=true` to allow this, otherwise remove "'+l+'" from the list of extensions for "'+i+'".');this._types[l]=i}}if(t||!this._extensions[i]){let o=s[0];this._extensions[i]=o[0]!=="*"?o:o.substr(1)}}};Vr.prototype.getType=function(r){r=String(r);let t=r.replace(/^.*[/\\]/,"").toLowerCase(),i=t.replace(/^.*\./,"").toLowerCase(),s=t.length<r.length;return(i.length<t.length-1||!s)&&this._types[i]||null};Vr.prototype.getExtension=function(r){return r=/^\s*([^;\s]*)/.test(r)&&RegExp.$1,r&&this._extensions[r.toLowerCase()]||null};ro.exports=Vr});var so=M((Jc,io)=>{io.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}});var ao=M((Zc,oo)=>{"use strict";var $u=no();oo.exports=new $u(so())});var fo=M((Gr,uo)=>{(function(r,t){typeof Gr=="object"&&typeof uo<"u"?t(Gr):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.WebStreamsPolyfill={}))})(Gr,function(r){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function i(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let o=s();function l(e){return typeof e=="object"&&e!==null||typeof e=="function"}let f=i,m=Promise,p=Promise.prototype.then,d=Promise.resolve.bind(m),S=Promise.reject.bind(m);function b(e){return new m(e)}function w(e){return d(e)}function y(e){return S(e)}function g(e,n,a){return p.call(e,n,a)}function R(e,n,a){g(g(e,n,a),void 0,f)}function T(e,n){R(e,n)}function P(e,n){R(e,void 0,n)}function L(e,n,a){return g(e,n,a)}function F(e){g(e,void 0,f)}let v=(()=>{let e=o&&o.queueMicrotask;if(typeof e=="function")return e;let n=w(void 0);return a=>g(n,a)})();function q(e,n,a){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,n,a)}function O(e,n,a){try{return w(q(e,n,a))}catch(u){return y(u)}}let le=16384;class ${constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(n){let a=this._back,u=a;a._elements.length===le-1&&(u={_elements:[],_next:void 0}),a._elements.push(n),u!==a&&(this._back=u,a._next=u),++this._size}shift(){let n=this._front,a=n,u=this._cursor,c=u+1,h=n._elements,_=h[u];return c===le&&(a=n._next,c=0),--this._size,this._cursor=c,n!==a&&(this._front=a),h[u]=void 0,_}forEach(n){let a=this._cursor,u=this._front,c=u._elements;for(;(a!==c.length||u._next!==void 0)&&!(a===c.length&&(u=u._next,c=u._elements,a=0,c.length===0));)n(c[a]),++a}peek(){let n=this._front,a=this._cursor;return n._elements[a]}}function dr(e,n){e._ownerReadableStream=n,n._reader=e,n._state==="readable"?Sn(e):n._state==="closed"?hl(e):Ui(e,n._storedError)}function yn(e,n){let a=e._ownerReadableStream;return ce(a,n)}function xe(e){e._ownerReadableStream._state==="readable"?wn(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):pl(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ut(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Sn(e){e._closedPromise=b((n,a)=>{e._closedPromise_resolve=n,e._closedPromise_reject=a})}function Ui(e,n){Sn(e),wn(e,n)}function hl(e){Sn(e),Mi(e)}function wn(e,n){e._closedPromise_reject!==void 0&&(F(e._closedPromise),e._closedPromise_reject(n),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function pl(e,n){Ui(e,n)}function Mi(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let ji=t("[[AbortSteps]]"),zi=t("[[ErrorSteps]]"),xn=t("[[CancelSteps]]"),Rn=t("[[PullSteps]]"),$i=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},ml=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function _l(e){return typeof e=="object"||typeof e=="function"}function Re(e,n){if(e!==void 0&&!_l(e))throw new TypeError(`${n} is not an object.`)}function ue(e,n){if(typeof e!="function")throw new TypeError(`${n} is not a function.`)}function gl(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Hi(e,n){if(!gl(e))throw new TypeError(`${n} is not an object.`)}function Ee(e,n,a){if(e===void 0)throw new TypeError(`Parameter ${n} is required in '${a}'.`)}function En(e,n,a){if(e===void 0)throw new TypeError(`${n} is required in '${a}'.`)}function Tn(e){return Number(e)}function Vi(e){return e===0?0:e}function bl(e){return Vi(ml(e))}function Gi(e,n){let u=Number.MAX_SAFE_INTEGER,c=Number(e);if(c=Vi(c),!$i(c))throw new TypeError(`${n} is not a finite number`);if(c=bl(c),c<0||c>u)throw new TypeError(`${n} is outside the accepted range of 0 to ${u}, inclusive`);return!$i(c)||c===0?0:c}function vn(e,n){if(!Ue(e))throw new TypeError(`${n} is not a ReadableStream.`)}function ft(e){return new kt(e)}function Qi(e,n){e._reader._readRequests.push(n)}function Cn(e,n,a){let c=e._reader._readRequests.shift();a?c._closeSteps():c._chunkSteps(n)}function hr(e){return e._reader._readRequests.length}function Yi(e){let n=e._reader;return!(n===void 0||!De(n))}class kt{constructor(n){if(Ee(n,1,"ReadableStreamDefaultReader"),vn(n,"First parameter"),Me(n))throw new TypeError("This stream has already been locked for exclusive reading by another reader");dr(this,n),this._readRequests=new $}get closed(){return De(this)?this._closedPromise:y(pr("closed"))}cancel(n=void 0){return De(this)?this._ownerReadableStream===void 0?y(ut("cancel")):yn(this,n):y(pr("cancel"))}read(){if(!De(this))return y(pr("read"));if(this._ownerReadableStream===void 0)return y(ut("read from"));let n,a,u=b((h,_)=>{n=h,a=_});return At(this,{_chunkSteps:h=>n({value:h,done:!1}),_closeSteps:()=>n({value:void 0,done:!0}),_errorSteps:h=>a(h)}),u}releaseLock(){if(!De(this))throw pr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");xe(this)}}}Object.defineProperties(kt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(kt.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function De(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof kt}function At(e,n){let a=e._ownerReadableStream;a._disturbed=!0,a._state==="closed"?n._closeSteps():a._state==="errored"?n._errorSteps(a._storedError):a._readableStreamController[Rn](n)}function pr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Ki=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Ji{constructor(n,a){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=n,this._preventCancel=a}next(){let n=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?L(this._ongoingPromise,n,n):n(),this._ongoingPromise}return(n){let a=()=>this._returnSteps(n);return this._ongoingPromise?L(this._ongoingPromise,a,a):a()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let n=this._reader;if(n._ownerReadableStream===void 0)return y(ut("iterate"));let a,u,c=b((_,x)=>{a=_,u=x});return At(n,{_chunkSteps:_=>{this._ongoingPromise=void 0,v(()=>a({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,xe(n),a({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,xe(n),u(_)}}),c}_returnSteps(n){if(this._isFinished)return Promise.resolve({value:n,done:!0});this._isFinished=!0;let a=this._reader;if(a._ownerReadableStream===void 0)return y(ut("finish iterating"));if(!this._preventCancel){let u=yn(a,n);return xe(a),L(u,()=>({value:n,done:!0}))}return xe(a),w({value:n,done:!0})}}let Zi={next(){return Xi(this)?this._asyncIteratorImpl.next():y(es("next"))},return(e){return Xi(this)?this._asyncIteratorImpl.return(e):y(es("return"))}};Ki!==void 0&&Object.setPrototypeOf(Zi,Ki);function yl(e,n){let a=ft(e),u=new Ji(a,n),c=Object.create(Zi);return c._asyncIteratorImpl=u,c}function Xi(e){if(!l(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Ji}catch{return!1}}function es(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let ts=Number.isNaN||function(e){return e!==e};function Ot(e){return e.slice()}function rs(e,n,a,u,c){new Uint8Array(e).set(new Uint8Array(a,u,c),n)}function Qc(e){return e}function mr(e){return!1}function ns(e,n,a){if(e.slice)return e.slice(n,a);let u=a-n,c=new ArrayBuffer(u);return rs(c,0,e,n,u),c}function Sl(e){return!(typeof e!="number"||ts(e)||e<0)}function is(e){let n=ns(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(n)}function Pn(e){let n=e._queue.shift();return e._queueTotalSize-=n.size,e._queueTotalSize<0&&(e._queueTotalSize=0),n.value}function kn(e,n,a){if(!Sl(a)||a===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:n,size:a}),e._queueTotalSize+=a}function wl(e){return e._queue.peek().value}function qe(e){e._queue=new $,e._queueTotalSize=0}class Bt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!An(this))throw Ln("view");return this._view}respond(n){if(!An(this))throw Ln("respond");if(Ee(n,1,"respond"),n=Gi(n,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");mr(this._view.buffer),Sr(this._associatedReadableByteStreamController,n)}respondWithNewView(n){if(!An(this))throw Ln("respondWithNewView");if(Ee(n,1,"respondWithNewView"),!ArrayBuffer.isView(n))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");mr(n.buffer),wr(this._associatedReadableByteStreamController,n)}}Object.defineProperties(Bt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Bt.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ct{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Qe(this))throw Lt("byobRequest");return In(this)}get desiredSize(){if(!Qe(this))throw Lt("desiredSize");return ds(this)}close(){if(!Qe(this))throw Lt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let n=this._controlledReadableByteStream._state;if(n!=="readable")throw new TypeError(`The stream (in ${n} state) is not in the readable state and cannot be closed`);It(this)}enqueue(n){if(!Qe(this))throw Lt("enqueue");if(Ee(n,1,"enqueue"),!ArrayBuffer.isView(n))throw new TypeError("chunk must be an array buffer view");if(n.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(n.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError(`The stream (in ${a} state) is not in the readable state and cannot be enqueued to`);yr(this,n)}error(n=void 0){if(!Qe(this))throw Lt("error");fe(this,n)}[xn](n){ss(this),qe(this);let a=this._cancelAlgorithm(n);return br(this),a}[Rn](n){let a=this._controlledReadableByteStream;if(this._queueTotalSize>0){let c=this._queue.shift();this._queueTotalSize-=c.byteLength,us(this);let h=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);n._chunkSteps(h);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let c;try{c=new ArrayBuffer(u)}catch(_){n._errorSteps(_);return}let h={buffer:c,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(h)}Qi(a,n),Ye(this)}}Object.defineProperties(ct.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ct.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Qe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof ct}function An(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Bt}function Ye(e){if(!Tl(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let a=e._pullAlgorithm();R(a,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ye(e))},u=>{fe(e,u)})}function ss(e){Bn(e),e._pendingPullIntos=new $}function On(e,n){let a=!1;e._state==="closed"&&(a=!0);let u=os(n);n.readerType==="default"?Cn(e,u,a):Pl(e,u,a)}function os(e){let n=e.bytesFilled,a=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,n/a)}function _r(e,n,a,u){e._queue.push({buffer:n,byteOffset:a,byteLength:u}),e._queueTotalSize+=u}function as(e,n){let a=n.elementSize,u=n.bytesFilled-n.bytesFilled%a,c=Math.min(e._queueTotalSize,n.byteLength-n.bytesFilled),h=n.bytesFilled+c,_=h-h%a,x=c,C=!1;_>u&&(x=_-n.bytesFilled,C=!0);let A=e._queue;for(;x>0;){let B=A.peek(),I=Math.min(x,B.byteLength),U=n.byteOffset+n.bytesFilled;rs(n.buffer,U,B.buffer,B.byteOffset,I),B.byteLength===I?A.shift():(B.byteOffset+=I,B.byteLength-=I),e._queueTotalSize-=I,ls(e,I,n),x-=I}return C}function ls(e,n,a){a.bytesFilled+=n}function us(e){e._queueTotalSize===0&&e._closeRequested?(br(e),jt(e._controlledReadableByteStream)):Ye(e)}function Bn(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function fs(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let n=e._pendingPullIntos.peek();as(e,n)&&(gr(e),On(e._controlledReadableByteStream,n))}}function xl(e,n,a){let u=e._controlledReadableByteStream,c=1;n.constructor!==DataView&&(c=n.constructor.BYTES_PER_ELEMENT);let h=n.constructor,_=n.buffer,x={buffer:_,bufferByteLength:_.byteLength,byteOffset:n.byteOffset,byteLength:n.byteLength,bytesFilled:0,elementSize:c,viewConstructor:h,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(x),ms(u,a);return}if(u._state==="closed"){let C=new h(x.buffer,x.byteOffset,0);a._closeSteps(C);return}if(e._queueTotalSize>0){if(as(e,x)){let C=os(x);us(e),a._chunkSteps(C);return}if(e._closeRequested){let C=new TypeError("Insufficient bytes to fill elements in the given buffer");fe(e,C),a._errorSteps(C);return}}e._pendingPullIntos.push(x),ms(u,a),Ye(e)}function Rl(e,n){let a=e._controlledReadableByteStream;if(Wn(a))for(;_s(a)>0;){let u=gr(e);On(a,u)}}function El(e,n,a){if(ls(e,n,a),a.bytesFilled<a.elementSize)return;gr(e);let u=a.bytesFilled%a.elementSize;if(u>0){let c=a.byteOffset+a.bytesFilled,h=ns(a.buffer,c-u,c);_r(e,h,0,h.byteLength)}a.bytesFilled-=u,On(e._controlledReadableByteStream,a),fs(e)}function cs(e,n){let a=e._pendingPullIntos.peek();Bn(e),e._controlledReadableByteStream._state==="closed"?Rl(e):El(e,n,a),Ye(e)}function gr(e){return e._pendingPullIntos.shift()}function Tl(e){let n=e._controlledReadableByteStream;return n._state!=="readable"||e._closeRequested||!e._started?!1:!!(Yi(n)&&hr(n)>0||Wn(n)&&_s(n)>0||ds(e)>0)}function br(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function It(e){let n=e._controlledReadableByteStream;if(!(e._closeRequested||n._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw fe(e,u),u}br(e),jt(n)}}function yr(e,n){let a=e._controlledReadableByteStream;if(e._closeRequested||a._state!=="readable")return;let u=n.buffer,c=n.byteOffset,h=n.byteLength,_=u;if(e._pendingPullIntos.length>0){let x=e._pendingPullIntos.peek();mr(x.buffer),x.buffer=x.buffer}if(Bn(e),Yi(a))if(hr(a)===0)_r(e,_,c,h);else{e._pendingPullIntos.length>0&&gr(e);let x=new Uint8Array(_,c,h);Cn(a,x,!1)}else Wn(a)?(_r(e,_,c,h),fs(e)):_r(e,_,c,h);Ye(e)}function fe(e,n){let a=e._controlledReadableByteStream;a._state==="readable"&&(ss(e),qe(e),br(e),Us(a,n))}function In(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let n=e._pendingPullIntos.peek(),a=new Uint8Array(n.buffer,n.byteOffset+n.bytesFilled,n.byteLength-n.bytesFilled),u=Object.create(Bt.prototype);Cl(u,e,a),e._byobRequest=u}return e._byobRequest}function ds(e){let n=e._controlledReadableByteStream._state;return n==="errored"?null:n==="closed"?0:e._strategyHWM-e._queueTotalSize}function Sr(e,n){let a=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(n!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(n===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(a.bytesFilled+n>a.byteLength)throw new RangeError("bytesWritten out of range")}a.buffer=a.buffer,cs(e,n)}function wr(e,n){let a=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(n.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(n.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(a.byteOffset+a.bytesFilled!==n.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(a.bufferByteLength!==n.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(a.bytesFilled+n.byteLength>a.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let c=n.byteLength;a.buffer=n.buffer,cs(e,c)}function hs(e,n,a,u,c,h,_){n._controlledReadableByteStream=e,n._pullAgain=!1,n._pulling=!1,n._byobRequest=null,n._queue=n._queueTotalSize=void 0,qe(n),n._closeRequested=!1,n._started=!1,n._strategyHWM=h,n._pullAlgorithm=u,n._cancelAlgorithm=c,n._autoAllocateChunkSize=_,n._pendingPullIntos=new $,e._readableStreamController=n;let x=a();R(w(x),()=>{n._started=!0,Ye(n)},C=>{fe(n,C)})}function vl(e,n,a){let u=Object.create(ct.prototype),c=()=>{},h=()=>w(void 0),_=()=>w(void 0);n.start!==void 0&&(c=()=>n.start(u)),n.pull!==void 0&&(h=()=>n.pull(u)),n.cancel!==void 0&&(_=C=>n.cancel(C));let x=n.autoAllocateChunkSize;if(x===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");hs(e,u,c,h,_,a,x)}function Cl(e,n,a){e._associatedReadableByteStreamController=n,e._view=a}function Ln(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Lt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function ps(e){return new Wt(e)}function ms(e,n){e._reader._readIntoRequests.push(n)}function Pl(e,n,a){let c=e._reader._readIntoRequests.shift();a?c._closeSteps(n):c._chunkSteps(n)}function _s(e){return e._reader._readIntoRequests.length}function Wn(e){let n=e._reader;return!(n===void 0||!Ke(n))}class Wt{constructor(n){if(Ee(n,1,"ReadableStreamBYOBReader"),vn(n,"First parameter"),Me(n))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Qe(n._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");dr(this,n),this._readIntoRequests=new $}get closed(){return Ke(this)?this._closedPromise:y(xr("closed"))}cancel(n=void 0){return Ke(this)?this._ownerReadableStream===void 0?y(ut("cancel")):yn(this,n):y(xr("cancel"))}read(n){if(!Ke(this))return y(xr("read"));if(!ArrayBuffer.isView(n))return y(new TypeError("view must be an array buffer view"));if(n.byteLength===0)return y(new TypeError("view must have non-zero byteLength"));if(n.buffer.byteLength===0)return y(new TypeError("view's buffer must have non-zero byteLength"));if(mr(n.buffer),this._ownerReadableStream===void 0)return y(ut("read from"));let a,u,c=b((_,x)=>{a=_,u=x});return gs(this,n,{_chunkSteps:_=>a({value:_,done:!1}),_closeSteps:_=>a({value:_,done:!0}),_errorSteps:_=>u(_)}),c}releaseLock(){if(!Ke(this))throw xr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");xe(this)}}}Object.defineProperties(Wt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Wt.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Ke(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Wt}function gs(e,n,a){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?a._errorSteps(u._storedError):xl(u._readableStreamController,n,a)}function xr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Dt(e,n){let{highWaterMark:a}=e;if(a===void 0)return n;if(ts(a)||a<0)throw new RangeError("Invalid highWaterMark");return a}function Rr(e){let{size:n}=e;return n||(()=>1)}function Er(e,n){Re(e,n);let a=e?.highWaterMark,u=e?.size;return{highWaterMark:a===void 0?void 0:Tn(a),size:u===void 0?void 0:kl(u,`${n} has member 'size' that`)}}function kl(e,n){return ue(e,n),a=>Tn(e(a))}function Al(e,n){Re(e,n);let a=e?.abort,u=e?.close,c=e?.start,h=e?.type,_=e?.write;return{abort:a===void 0?void 0:Ol(a,e,`${n} has member 'abort' that`),close:u===void 0?void 0:Bl(u,e,`${n} has member 'close' that`),start:c===void 0?void 0:Il(c,e,`${n} has member 'start' that`),write:_===void 0?void 0:Ll(_,e,`${n} has member 'write' that`),type:h}}function Ol(e,n,a){return ue(e,a),u=>O(e,n,[u])}function Bl(e,n,a){return ue(e,a),()=>O(e,n,[])}function Il(e,n,a){return ue(e,a),u=>q(e,n,[u])}function Ll(e,n,a){return ue(e,a),(u,c)=>O(e,n,[u,c])}function bs(e,n){if(!dt(e))throw new TypeError(`${n} is not a WritableStream.`)}function Wl(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Dl=typeof AbortController=="function";function ql(){if(Dl)return new AbortController}class qt{constructor(n={},a={}){n===void 0?n=null:Hi(n,"First parameter");let u=Er(a,"Second parameter"),c=Al(n,"First parameter");if(Ss(this),c.type!==void 0)throw new RangeError("Invalid type is specified");let _=Rr(u),x=Dt(u,1);Jl(this,c,x,_)}get locked(){if(!dt(this))throw kr("locked");return ht(this)}abort(n=void 0){return dt(this)?ht(this)?y(new TypeError("Cannot abort a stream that already has a writer")):Tr(this,n):y(kr("abort"))}close(){return dt(this)?ht(this)?y(new TypeError("Cannot close a stream that already has a writer")):me(this)?y(new TypeError("Cannot close an already-closing stream")):ws(this):y(kr("close"))}getWriter(){if(!dt(this))throw kr("getWriter");return ys(this)}}Object.defineProperties(qt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function ys(e){return new Nt(e)}function Nl(e,n,a,u,c=1,h=()=>1){let _=Object.create(qt.prototype);Ss(_);let x=Object.create(pt.prototype);return Cs(_,x,e,n,a,u,c,h),_}function Ss(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new $,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function dt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof qt}function ht(e){return e._writer!==void 0}function Tr(e,n){var a;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=n,(a=e._writableStreamController._abortController)===null||a===void 0||a.abort();let u=e._state;if(u==="closed"||u==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let c=!1;u==="erroring"&&(c=!0,n=void 0);let h=b((_,x)=>{e._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:x,_reason:n,_wasAlreadyErroring:c}});return e._pendingAbortRequest._promise=h,c||qn(e,n),h}function ws(e){let n=e._state;if(n==="closed"||n==="errored")return y(new TypeError(`The stream (in ${n} state) is not in the writable state and cannot be closed`));let a=b((c,h)=>{let _={_resolve:c,_reject:h};e._closeRequest=_}),u=e._writer;return u!==void 0&&e._backpressure&&n==="writable"&&Vn(u),Zl(e._writableStreamController),a}function Fl(e){return b((a,u)=>{let c={_resolve:a,_reject:u};e._writeRequests.push(c)})}function Dn(e,n){if(e._state==="writable"){qn(e,n);return}Nn(e)}function qn(e,n){let a=e._writableStreamController;e._state="erroring",e._storedError=n;let u=e._writer;u!==void 0&&Rs(u,n),!$l(e)&&a._started&&Nn(e)}function Nn(e){e._state="errored",e._writableStreamController[zi]();let n=e._storedError;if(e._writeRequests.forEach(c=>{c._reject(n)}),e._writeRequests=new $,e._pendingAbortRequest===void 0){vr(e);return}let a=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,a._wasAlreadyErroring){a._reject(n),vr(e);return}let u=e._writableStreamController[ji](a._reason);R(u,()=>{a._resolve(),vr(e)},c=>{a._reject(c),vr(e)})}function Ul(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Ml(e,n){e._inFlightWriteRequest._reject(n),e._inFlightWriteRequest=void 0,Dn(e,n)}function jl(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let a=e._writer;a!==void 0&&Os(a)}function zl(e,n){e._inFlightCloseRequest._reject(n),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(n),e._pendingAbortRequest=void 0),Dn(e,n)}function me(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function $l(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Hl(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Vl(e){e._inFlightWriteRequest=e._writeRequests.shift()}function vr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let n=e._writer;n!==void 0&&$n(n,e._storedError)}function Fn(e,n){let a=e._writer;a!==void 0&&n!==e._backpressure&&(n?su(a):Vn(a)),e._backpressure=n}class Nt{constructor(n){if(Ee(n,1,"WritableStreamDefaultWriter"),bs(n,"First parameter"),ht(n))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=n,n._writer=this;let a=n._state;if(a==="writable")!me(n)&&n._backpressure?Or(this):Bs(this),Ar(this);else if(a==="erroring")Hn(this,n._storedError),Ar(this);else if(a==="closed")Bs(this),nu(this);else{let u=n._storedError;Hn(this,u),As(this,u)}}get closed(){return Je(this)?this._closedPromise:y(Ze("closed"))}get desiredSize(){if(!Je(this))throw Ze("desiredSize");if(this._ownerWritableStream===void 0)throw Ft("desiredSize");return Kl(this)}get ready(){return Je(this)?this._readyPromise:y(Ze("ready"))}abort(n=void 0){return Je(this)?this._ownerWritableStream===void 0?y(Ft("abort")):Gl(this,n):y(Ze("abort"))}close(){if(!Je(this))return y(Ze("close"));let n=this._ownerWritableStream;return n===void 0?y(Ft("close")):me(n)?y(new TypeError("Cannot close an already-closing stream")):xs(this)}releaseLock(){if(!Je(this))throw Ze("releaseLock");this._ownerWritableStream!==void 0&&Es(this)}write(n=void 0){return Je(this)?this._ownerWritableStream===void 0?y(Ft("write to")):Ts(this,n):y(Ze("write"))}}Object.defineProperties(Nt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Nt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Je(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Nt}function Gl(e,n){let a=e._ownerWritableStream;return Tr(a,n)}function xs(e){let n=e._ownerWritableStream;return ws(n)}function Ql(e){let n=e._ownerWritableStream,a=n._state;return me(n)||a==="closed"?w(void 0):a==="errored"?y(n._storedError):xs(e)}function Yl(e,n){e._closedPromiseState==="pending"?$n(e,n):iu(e,n)}function Rs(e,n){e._readyPromiseState==="pending"?Is(e,n):ou(e,n)}function Kl(e){let n=e._ownerWritableStream,a=n._state;return a==="errored"||a==="erroring"?null:a==="closed"?0:Ps(n._writableStreamController)}function Es(e){let n=e._ownerWritableStream,a=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Rs(e,a),Yl(e,a),n._writer=void 0,e._ownerWritableStream=void 0}function Ts(e,n){let a=e._ownerWritableStream,u=a._writableStreamController,c=Xl(u,n);if(a!==e._ownerWritableStream)return y(Ft("write to"));let h=a._state;if(h==="errored")return y(a._storedError);if(me(a)||h==="closed")return y(new TypeError("The stream is closing or closed and cannot be written to"));if(h==="erroring")return y(a._storedError);let _=Fl(a);return eu(u,n,c),_}let vs={};class pt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Un(this))throw zn("abortReason");return this._abortReason}get signal(){if(!Un(this))throw zn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(n=void 0){if(!Un(this))throw zn("error");this._controlledWritableStream._state==="writable"&&ks(this,n)}[ji](n){let a=this._abortAlgorithm(n);return Cr(this),a}[zi](){qe(this)}}Object.defineProperties(pt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(pt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Un(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof pt}function Cs(e,n,a,u,c,h,_,x){n._controlledWritableStream=e,e._writableStreamController=n,n._queue=void 0,n._queueTotalSize=void 0,qe(n),n._abortReason=void 0,n._abortController=ql(),n._started=!1,n._strategySizeAlgorithm=x,n._strategyHWM=_,n._writeAlgorithm=u,n._closeAlgorithm=c,n._abortAlgorithm=h;let C=jn(n);Fn(e,C);let A=a(),B=w(A);R(B,()=>{n._started=!0,Pr(n)},I=>{n._started=!0,Dn(e,I)})}function Jl(e,n,a,u){let c=Object.create(pt.prototype),h=()=>{},_=()=>w(void 0),x=()=>w(void 0),C=()=>w(void 0);n.start!==void 0&&(h=()=>n.start(c)),n.write!==void 0&&(_=A=>n.write(A,c)),n.close!==void 0&&(x=()=>n.close()),n.abort!==void 0&&(C=A=>n.abort(A)),Cs(e,c,h,_,x,C,a,u)}function Cr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Zl(e){kn(e,vs,0),Pr(e)}function Xl(e,n){try{return e._strategySizeAlgorithm(n)}catch(a){return Mn(e,a),1}}function Ps(e){return e._strategyHWM-e._queueTotalSize}function eu(e,n,a){try{kn(e,n,a)}catch(c){Mn(e,c);return}let u=e._controlledWritableStream;if(!me(u)&&u._state==="writable"){let c=jn(e);Fn(u,c)}Pr(e)}function Pr(e){let n=e._controlledWritableStream;if(!e._started||n._inFlightWriteRequest!==void 0)return;if(n._state==="erroring"){Nn(n);return}if(e._queue.length===0)return;let u=wl(e);u===vs?tu(e):ru(e,u)}function Mn(e,n){e._controlledWritableStream._state==="writable"&&ks(e,n)}function tu(e){let n=e._controlledWritableStream;Hl(n),Pn(e);let a=e._closeAlgorithm();Cr(e),R(a,()=>{jl(n)},u=>{zl(n,u)})}function ru(e,n){let a=e._controlledWritableStream;Vl(a);let u=e._writeAlgorithm(n);R(u,()=>{Ul(a);let c=a._state;if(Pn(e),!me(a)&&c==="writable"){let h=jn(e);Fn(a,h)}Pr(e)},c=>{a._state==="writable"&&Cr(e),Ml(a,c)})}function jn(e){return Ps(e)<=0}function ks(e,n){let a=e._controlledWritableStream;Cr(e),qn(a,n)}function kr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function zn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Ze(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Ft(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Ar(e){e._closedPromise=b((n,a)=>{e._closedPromise_resolve=n,e._closedPromise_reject=a,e._closedPromiseState="pending"})}function As(e,n){Ar(e),$n(e,n)}function nu(e){Ar(e),Os(e)}function $n(e,n){e._closedPromise_reject!==void 0&&(F(e._closedPromise),e._closedPromise_reject(n),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function iu(e,n){As(e,n)}function Os(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Or(e){e._readyPromise=b((n,a)=>{e._readyPromise_resolve=n,e._readyPromise_reject=a}),e._readyPromiseState="pending"}function Hn(e,n){Or(e),Is(e,n)}function Bs(e){Or(e),Vn(e)}function Is(e,n){e._readyPromise_reject!==void 0&&(F(e._readyPromise),e._readyPromise_reject(n),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function su(e){Or(e)}function ou(e,n){Hn(e,n)}function Vn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Ls=typeof DOMException<"u"?DOMException:void 0;function au(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function lu(){let e=function(a,u){this.message=a||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let uu=au(Ls)?Ls:lu();function Ws(e,n,a,u,c,h){let _=ft(e),x=ys(n);e._disturbed=!0;let C=!1,A=w(void 0);return b((B,I)=>{let U;if(h!==void 0){if(U=()=>{let E=new uu("Aborted","AbortError"),k=[];u||k.push(()=>n._state==="writable"?Tr(n,E):w(void 0)),c||k.push(()=>e._state==="readable"?ce(e,E):w(void 0)),Y(()=>Promise.all(k.map(W=>W())),!0,E)},h.aborted){U();return}h.addEventListener("abort",U)}function de(){return b((E,k)=>{function W(Z){Z?E():g(gt(),W,k)}W(!1)})}function gt(){return C?w(!0):g(x._readyPromise,()=>b((E,k)=>{At(_,{_chunkSteps:W=>{A=g(Ts(x,W),void 0,i),E(!1)},_closeSteps:()=>E(!0),_errorSteps:k})}))}if(Te(e,_._closedPromise,E=>{u?se(!0,E):Y(()=>Tr(n,E),!0,E)}),Te(n,x._closedPromise,E=>{c?se(!0,E):Y(()=>ce(e,E),!0,E)}),Q(e,_._closedPromise,()=>{a?se():Y(()=>Ql(x))}),me(n)||n._state==="closed"){let E=new TypeError("the destination writable stream closed before all data could be piped to it");c?se(!0,E):Y(()=>ce(e,E),!0,E)}F(de());function je(){let E=A;return g(A,()=>E!==A?je():void 0)}function Te(E,k,W){E._state==="errored"?W(E._storedError):P(k,W)}function Q(E,k,W){E._state==="closed"?W():T(k,W)}function Y(E,k,W){if(C)return;C=!0,n._state==="writable"&&!me(n)?T(je(),Z):Z();function Z(){R(E(),()=>ve(k,W),bt=>ve(!0,bt))}}function se(E,k){C||(C=!0,n._state==="writable"&&!me(n)?T(je(),()=>ve(E,k)):ve(E,k))}function ve(E,k){Es(x),xe(_),h!==void 0&&h.removeEventListener("abort",U),E?I(k):B(void 0)}})}class mt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Br(this))throw Wr("desiredSize");return Gn(this)}close(){if(!Br(this))throw Wr("close");if(!_t(this))throw new TypeError("The stream is not in a state that permits close");Mt(this)}enqueue(n=void 0){if(!Br(this))throw Wr("enqueue");if(!_t(this))throw new TypeError("The stream is not in a state that permits enqueue");return Lr(this,n)}error(n=void 0){if(!Br(this))throw Wr("error");Ne(this,n)}[xn](n){qe(this);let a=this._cancelAlgorithm(n);return Ir(this),a}[Rn](n){let a=this._controlledReadableStream;if(this._queue.length>0){let u=Pn(this);this._closeRequested&&this._queue.length===0?(Ir(this),jt(a)):Ut(this),n._chunkSteps(u)}else Qi(a,n),Ut(this)}}Object.defineProperties(mt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(mt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Br(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof mt}function Ut(e){if(!Ds(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let a=e._pullAlgorithm();R(a,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ut(e))},u=>{Ne(e,u)})}function Ds(e){let n=e._controlledReadableStream;return!_t(e)||!e._started?!1:!!(Me(n)&&hr(n)>0||Gn(e)>0)}function Ir(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Mt(e){if(!_t(e))return;let n=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Ir(e),jt(n))}function Lr(e,n){if(!_t(e))return;let a=e._controlledReadableStream;if(Me(a)&&hr(a)>0)Cn(a,n,!1);else{let u;try{u=e._strategySizeAlgorithm(n)}catch(c){throw Ne(e,c),c}try{kn(e,n,u)}catch(c){throw Ne(e,c),c}}Ut(e)}function Ne(e,n){let a=e._controlledReadableStream;a._state==="readable"&&(qe(e),Ir(e),Us(a,n))}function Gn(e){let n=e._controlledReadableStream._state;return n==="errored"?null:n==="closed"?0:e._strategyHWM-e._queueTotalSize}function fu(e){return!Ds(e)}function _t(e){let n=e._controlledReadableStream._state;return!e._closeRequested&&n==="readable"}function qs(e,n,a,u,c,h,_){n._controlledReadableStream=e,n._queue=void 0,n._queueTotalSize=void 0,qe(n),n._started=!1,n._closeRequested=!1,n._pullAgain=!1,n._pulling=!1,n._strategySizeAlgorithm=_,n._strategyHWM=h,n._pullAlgorithm=u,n._cancelAlgorithm=c,e._readableStreamController=n;let x=a();R(w(x),()=>{n._started=!0,Ut(n)},C=>{Ne(n,C)})}function cu(e,n,a,u){let c=Object.create(mt.prototype),h=()=>{},_=()=>w(void 0),x=()=>w(void 0);n.start!==void 0&&(h=()=>n.start(c)),n.pull!==void 0&&(_=()=>n.pull(c)),n.cancel!==void 0&&(x=C=>n.cancel(C)),qs(e,c,h,_,x,a,u)}function Wr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function du(e,n){return Qe(e._readableStreamController)?pu(e):hu(e)}function hu(e,n){let a=ft(e),u=!1,c=!1,h=!1,_=!1,x,C,A,B,I,U=b(Q=>{I=Q});function de(){return u?(c=!0,w(void 0)):(u=!0,At(a,{_chunkSteps:Y=>{v(()=>{c=!1;let se=Y,ve=Y;h||Lr(A._readableStreamController,se),_||Lr(B._readableStreamController,ve),u=!1,c&&de()})},_closeSteps:()=>{u=!1,h||Mt(A._readableStreamController),_||Mt(B._readableStreamController),(!h||!_)&&I(void 0)},_errorSteps:()=>{u=!1}}),w(void 0))}function gt(Q){if(h=!0,x=Q,_){let Y=Ot([x,C]),se=ce(e,Y);I(se)}return U}function je(Q){if(_=!0,C=Q,h){let Y=Ot([x,C]),se=ce(e,Y);I(se)}return U}function Te(){}return A=Qn(Te,de,gt),B=Qn(Te,de,je),P(a._closedPromise,Q=>{Ne(A._readableStreamController,Q),Ne(B._readableStreamController,Q),(!h||!_)&&I(void 0)}),[A,B]}function pu(e){let n=ft(e),a=!1,u=!1,c=!1,h=!1,_=!1,x,C,A,B,I,U=b(E=>{I=E});function de(E){P(E._closedPromise,k=>{E===n&&(fe(A._readableStreamController,k),fe(B._readableStreamController,k),(!h||!_)&&I(void 0))})}function gt(){Ke(n)&&(xe(n),n=ft(e),de(n)),At(n,{_chunkSteps:k=>{v(()=>{u=!1,c=!1;let W=k,Z=k;if(!h&&!_)try{Z=is(k)}catch(bt){fe(A._readableStreamController,bt),fe(B._readableStreamController,bt),I(ce(e,bt));return}h||yr(A._readableStreamController,W),_||yr(B._readableStreamController,Z),a=!1,u?Te():c&&Q()})},_closeSteps:()=>{a=!1,h||It(A._readableStreamController),_||It(B._readableStreamController),A._readableStreamController._pendingPullIntos.length>0&&Sr(A._readableStreamController,0),B._readableStreamController._pendingPullIntos.length>0&&Sr(B._readableStreamController,0),(!h||!_)&&I(void 0)},_errorSteps:()=>{a=!1}})}function je(E,k){De(n)&&(xe(n),n=ps(e),de(n));let W=k?B:A,Z=k?A:B;gs(n,E,{_chunkSteps:yt=>{v(()=>{u=!1,c=!1;let St=k?_:h;if(k?h:_)St||wr(W._readableStreamController,yt);else{let Xs;try{Xs=is(yt)}catch(Kn){fe(W._readableStreamController,Kn),fe(Z._readableStreamController,Kn),I(ce(e,Kn));return}St||wr(W._readableStreamController,yt),yr(Z._readableStreamController,Xs)}a=!1,u?Te():c&&Q()})},_closeSteps:yt=>{a=!1;let St=k?_:h,$r=k?h:_;St||It(W._readableStreamController),$r||It(Z._readableStreamController),yt!==void 0&&(St||wr(W._readableStreamController,yt),!$r&&Z._readableStreamController._pendingPullIntos.length>0&&Sr(Z._readableStreamController,0)),(!St||!$r)&&I(void 0)},_errorSteps:()=>{a=!1}})}function Te(){if(a)return u=!0,w(void 0);a=!0;let E=In(A._readableStreamController);return E===null?gt():je(E._view,!1),w(void 0)}function Q(){if(a)return c=!0,w(void 0);a=!0;let E=In(B._readableStreamController);return E===null?gt():je(E._view,!0),w(void 0)}function Y(E){if(h=!0,x=E,_){let k=Ot([x,C]),W=ce(e,k);I(W)}return U}function se(E){if(_=!0,C=E,h){let k=Ot([x,C]),W=ce(e,k);I(W)}return U}function ve(){}return A=Fs(ve,Te,Y),B=Fs(ve,Q,se),de(n),[A,B]}function mu(e,n){Re(e,n);let a=e,u=a?.autoAllocateChunkSize,c=a?.cancel,h=a?.pull,_=a?.start,x=a?.type;return{autoAllocateChunkSize:u===void 0?void 0:Gi(u,`${n} has member 'autoAllocateChunkSize' that`),cancel:c===void 0?void 0:_u(c,a,`${n} has member 'cancel' that`),pull:h===void 0?void 0:gu(h,a,`${n} has member 'pull' that`),start:_===void 0?void 0:bu(_,a,`${n} has member 'start' that`),type:x===void 0?void 0:yu(x,`${n} has member 'type' that`)}}function _u(e,n,a){return ue(e,a),u=>O(e,n,[u])}function gu(e,n,a){return ue(e,a),u=>O(e,n,[u])}function bu(e,n,a){return ue(e,a),u=>q(e,n,[u])}function yu(e,n){if(e=`${e}`,e!=="bytes")throw new TypeError(`${n} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Su(e,n){Re(e,n);let a=e?.mode;return{mode:a===void 0?void 0:wu(a,`${n} has member 'mode' that`)}}function wu(e,n){if(e=`${e}`,e!=="byob")throw new TypeError(`${n} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function xu(e,n){return Re(e,n),{preventCancel:!!e?.preventCancel}}function Ns(e,n){Re(e,n);let a=e?.preventAbort,u=e?.preventCancel,c=e?.preventClose,h=e?.signal;return h!==void 0&&Ru(h,`${n} has member 'signal' that`),{preventAbort:!!a,preventCancel:!!u,preventClose:!!c,signal:h}}function Ru(e,n){if(!Wl(e))throw new TypeError(`${n} is not an AbortSignal.`)}function Eu(e,n){Re(e,n);let a=e?.readable;En(a,"readable","ReadableWritablePair"),vn(a,`${n} has member 'readable' that`);let u=e?.writable;return En(u,"writable","ReadableWritablePair"),bs(u,`${n} has member 'writable' that`),{readable:a,writable:u}}class Fe{constructor(n={},a={}){n===void 0?n=null:Hi(n,"First parameter");let u=Er(a,"Second parameter"),c=mu(n,"First parameter");if(Yn(this),c.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let h=Dt(u,0);vl(this,c,h)}else{let h=Rr(u),_=Dt(u,1);cu(this,c,_,h)}}get locked(){if(!Ue(this))throw Xe("locked");return Me(this)}cancel(n=void 0){return Ue(this)?Me(this)?y(new TypeError("Cannot cancel a stream that already has a reader")):ce(this,n):y(Xe("cancel"))}getReader(n=void 0){if(!Ue(this))throw Xe("getReader");return Su(n,"First parameter").mode===void 0?ft(this):ps(this)}pipeThrough(n,a={}){if(!Ue(this))throw Xe("pipeThrough");Ee(n,1,"pipeThrough");let u=Eu(n,"First parameter"),c=Ns(a,"Second parameter");if(Me(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ht(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let h=Ws(this,u.writable,c.preventClose,c.preventAbort,c.preventCancel,c.signal);return F(h),u.readable}pipeTo(n,a={}){if(!Ue(this))return y(Xe("pipeTo"));if(n===void 0)return y("Parameter 1 is required in 'pipeTo'.");if(!dt(n))return y(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=Ns(a,"Second parameter")}catch(c){return y(c)}return Me(this)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ht(n)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Ws(this,n,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!Ue(this))throw Xe("tee");let n=du(this);return Ot(n)}values(n=void 0){if(!Ue(this))throw Xe("values");let a=xu(n,"First parameter");return yl(this,a.preventCancel)}}Object.defineProperties(Fe.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Fe.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(Fe.prototype,t.asyncIterator,{value:Fe.prototype.values,writable:!0,configurable:!0});function Qn(e,n,a,u=1,c=()=>1){let h=Object.create(Fe.prototype);Yn(h);let _=Object.create(mt.prototype);return qs(h,_,e,n,a,u,c),h}function Fs(e,n,a){let u=Object.create(Fe.prototype);Yn(u);let c=Object.create(ct.prototype);return hs(u,c,e,n,a,0,void 0),u}function Yn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Ue(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Fe}function Me(e){return e._reader!==void 0}function ce(e,n){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return y(e._storedError);jt(e);let a=e._reader;a!==void 0&&Ke(a)&&(a._readIntoRequests.forEach(c=>{c._closeSteps(void 0)}),a._readIntoRequests=new $);let u=e._readableStreamController[xn](n);return L(u,i)}function jt(e){e._state="closed";let n=e._reader;n!==void 0&&(Mi(n),De(n)&&(n._readRequests.forEach(a=>{a._closeSteps()}),n._readRequests=new $))}function Us(e,n){e._state="errored",e._storedError=n;let a=e._reader;a!==void 0&&(wn(a,n),De(a)?(a._readRequests.forEach(u=>{u._errorSteps(n)}),a._readRequests=new $):(a._readIntoRequests.forEach(u=>{u._errorSteps(n)}),a._readIntoRequests=new $))}function Xe(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Ms(e,n){Re(e,n);let a=e?.highWaterMark;return En(a,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Tn(a)}}let js=e=>e.byteLength;try{Object.defineProperty(js,"name",{value:"size",configurable:!0})}catch{}class Dr{constructor(n){Ee(n,1,"ByteLengthQueuingStrategy"),n=Ms(n,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=n.highWaterMark}get highWaterMark(){if(!$s(this))throw zs("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!$s(this))throw zs("size");return js}}Object.defineProperties(Dr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Dr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function zs(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function $s(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Dr}let Hs=()=>1;try{Object.defineProperty(Hs,"name",{value:"size",configurable:!0})}catch{}class qr{constructor(n){Ee(n,1,"CountQueuingStrategy"),n=Ms(n,"First parameter"),this._countQueuingStrategyHighWaterMark=n.highWaterMark}get highWaterMark(){if(!Gs(this))throw Vs("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Gs(this))throw Vs("size");return Hs}}Object.defineProperties(qr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Vs(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Gs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof qr}function Tu(e,n){Re(e,n);let a=e?.flush,u=e?.readableType,c=e?.start,h=e?.transform,_=e?.writableType;return{flush:a===void 0?void 0:vu(a,e,`${n} has member 'flush' that`),readableType:u,start:c===void 0?void 0:Cu(c,e,`${n} has member 'start' that`),transform:h===void 0?void 0:Pu(h,e,`${n} has member 'transform' that`),writableType:_}}function vu(e,n,a){return ue(e,a),u=>O(e,n,[u])}function Cu(e,n,a){return ue(e,a),u=>q(e,n,[u])}function Pu(e,n,a){return ue(e,a),(u,c)=>O(e,n,[u,c])}class Nr{constructor(n={},a={},u={}){n===void 0&&(n=null);let c=Er(a,"Second parameter"),h=Er(u,"Third parameter"),_=Tu(n,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let x=Dt(h,0),C=Rr(h),A=Dt(c,1),B=Rr(c),I,U=b(de=>{I=de});ku(this,U,A,B,x,C),Ou(this,_),_.start!==void 0?I(_.start(this._transformStreamController)):I(void 0)}get readable(){if(!Qs(this))throw Zs("readable");return this._readable}get writable(){if(!Qs(this))throw Zs("writable");return this._writable}}Object.defineProperties(Nr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Nr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function ku(e,n,a,u,c,h){function _(){return n}function x(U){return Lu(e,U)}function C(U){return Wu(e,U)}function A(){return Du(e)}e._writable=Nl(_,x,A,C,a,u);function B(){return qu(e)}function I(U){return Ur(e,U),w(void 0)}e._readable=Qn(_,B,I,c,h),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Mr(e,!0),e._transformStreamController=void 0}function Qs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Nr}function Fr(e,n){Ne(e._readable._readableStreamController,n),Ur(e,n)}function Ur(e,n){Ys(e._transformStreamController),Mn(e._writable._writableStreamController,n),e._backpressure&&Mr(e,!1)}function Mr(e,n){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=b(a=>{e._backpressureChangePromise_resolve=a}),e._backpressure=n}class zt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!jr(this))throw zr("desiredSize");let n=this._controlledTransformStream._readable._readableStreamController;return Gn(n)}enqueue(n=void 0){if(!jr(this))throw zr("enqueue");Ks(this,n)}error(n=void 0){if(!jr(this))throw zr("error");Bu(this,n)}terminate(){if(!jr(this))throw zr("terminate");Iu(this)}}Object.defineProperties(zt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(zt.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function jr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof zt}function Au(e,n,a,u){n._controlledTransformStream=e,e._transformStreamController=n,n._transformAlgorithm=a,n._flushAlgorithm=u}function Ou(e,n){let a=Object.create(zt.prototype),u=h=>{try{return Ks(a,h),w(void 0)}catch(_){return y(_)}},c=()=>w(void 0);n.transform!==void 0&&(u=h=>n.transform(h,a)),n.flush!==void 0&&(c=()=>n.flush(a)),Au(e,a,u,c)}function Ys(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Ks(e,n){let a=e._controlledTransformStream,u=a._readable._readableStreamController;if(!_t(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Lr(u,n)}catch(h){throw Ur(a,h),a._readable._storedError}fu(u)!==a._backpressure&&Mr(a,!0)}function Bu(e,n){Fr(e._controlledTransformStream,n)}function Js(e,n){let a=e._transformAlgorithm(n);return L(a,void 0,u=>{throw Fr(e._controlledTransformStream,u),u})}function Iu(e){let n=e._controlledTransformStream,a=n._readable._readableStreamController;Mt(a);let u=new TypeError("TransformStream terminated");Ur(n,u)}function Lu(e,n){let a=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return L(u,()=>{let c=e._writable;if(c._state==="erroring")throw c._storedError;return Js(a,n)})}return Js(a,n)}function Wu(e,n){return Fr(e,n),w(void 0)}function Du(e){let n=e._readable,a=e._transformStreamController,u=a._flushAlgorithm();return Ys(a),L(u,()=>{if(n._state==="errored")throw n._storedError;Mt(n._readableStreamController)},c=>{throw Fr(e,c),n._storedError})}function qu(e){return Mr(e,!1),e._backpressureChangePromise}function zr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Zs(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Dr,r.CountQueuingStrategy=qr,r.ReadableByteStreamController=ct,r.ReadableStream=Fe,r.ReadableStreamBYOBReader=Wt,r.ReadableStreamBYOBRequest=Bt,r.ReadableStreamDefaultController=mt,r.ReadableStreamDefaultReader=kt,r.TransformStream=Nr,r.TransformStreamDefaultController=zt,r.WritableStream=qt,r.WritableStreamDefaultController=pt,r.WritableStreamDefaultWriter=Nt,Object.defineProperty(r,"__esModule",{value:!0})})});var co=M(()=>{if(!globalThis.ReadableStream)try{let r=require("node:process"),{emitWarning:t}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),r.emitWarning=t}catch(i){throw r.emitWarning=t,i}}catch{Object.assign(globalThis,fo())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(i){let s=0,o=this;return new ReadableStream({type:"bytes",async pull(l){let m=await o.slice(s,Math.min(o.size,s+65536)).arrayBuffer();s+=m.byteLength,l.enqueue(new Uint8Array(m)),s===o.size&&l.close()}})})}catch{}});async function*Jn(r,t=!0){for(let i of r)if("stream"in i)yield*i.stream();else if(ArrayBuffer.isView(i))if(t){let s=i.byteOffset,o=i.byteOffset+i.byteLength;for(;s!==o;){let l=Math.min(o-s,ho),f=i.buffer.slice(s,s+l);s+=f.byteLength,yield new Uint8Array(f)}}else yield i;else{let s=0,o=i;for(;s!==o.size;){let f=await o.slice(s,Math.min(o.size,s+ho)).arrayBuffer();s+=f.byteLength,yield new Uint8Array(f)}}}var rd,ho,po,Vu,Ce,Ht=$t(()=>{rd=V(co(),1);ho=65536;po=class Zn{#e=[];#t="";#r=0;#n="transparent";constructor(t=[],i={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof i!="object"&&typeof i!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");i===null&&(i={});let s=new TextEncoder;for(let l of t){let f;ArrayBuffer.isView(l)?f=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?f=new Uint8Array(l.slice(0)):l instanceof Zn?f=l:f=s.encode(`${l}`),this.#r+=ArrayBuffer.isView(f)?f.byteLength:f.size,this.#e.push(f)}this.#n=`${i.endings===void 0?"transparent":i.endings}`;let o=i.type===void 0?"":String(i.type);this.#t=/^[\x20-\x7E]*$/.test(o)?o:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,i="";for await(let s of Jn(this.#e,!1))i+=t.decode(s,{stream:!0});return i+=t.decode(),i}async arrayBuffer(){let t=new Uint8Array(this.size),i=0;for await(let s of Jn(this.#e,!1))t.set(s,i),i+=s.length;return t.buffer}stream(){let t=Jn(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(i){let s=await t.next();s.done?i.close():i.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,i=this.size,s=""){let{size:o}=this,l=t<0?Math.max(o+t,0):Math.min(t,o),f=i<0?Math.max(o+i,0):Math.min(i,o),m=Math.max(f-l,0),p=this.#e,d=[],S=0;for(let w of p){if(S>=m)break;let y=ArrayBuffer.isView(w)?w.byteLength:w.size;if(l&&y<=l)l-=y,f-=y;else{let g;ArrayBuffer.isView(w)?(g=w.subarray(l,Math.min(y,f)),S+=g.byteLength):(g=w.slice(l,Math.min(y,f)),S+=g.size),f-=y,d.push(g),l=0}}let b=new Zn([],{type:String(s).toLowerCase()});return b.#r=m,b.#e=d,b}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(po.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Vu=po,Ce=Vu});var Gu,Qu,wt,Xn=$t(()=>{Ht();Gu=class extends Ce{#e=0;#t="";constructor(t,i,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let o=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(o)||(this.#e=o),this.#t=String(i)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof Ce&&/^(File)$/.test(t[Symbol.toStringTag])}},Qu=Gu,wt=Qu});function go(r,t=Ce){var i=`${mo()}${mo()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],o=`--${i}\r
Content-Disposition: form-data; name="`;return r.forEach((l,f)=>typeof l=="string"?s.push(o+ei(f)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(o+ei(f)+`"; filename="${ei(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),s.push(`--${i}--`),new t(s,{type:"multipart/form-data; boundary="+i})}var Vt,Yu,Ku,mo,Ju,_o,ei,et,tt,Qr=$t(()=>{Ht();Xn();({toStringTag:Vt,iterator:Yu,hasInstance:Ku}=Symbol),mo=Math.random,Ju="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),_o=(r,t,i)=>(r+="",/^(Blob|File)$/.test(t&&t[Vt])?[(i=i!==void 0?i+"":t[Vt]=="File"?t.name:"blob",r),t.name!==i||t[Vt]=="blob"?new wt([t],i,t):t]:[r,t+""]),ei=(r,t)=>(t?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),et=(r,t,i)=>{if(t.length<i)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${i} arguments required, but only ${t.length} present.`)},tt=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[Vt](){return"FormData"}[Yu](){return this.entries()}static[Ku](t){return t&&typeof t=="object"&&t[Vt]==="FormData"&&!Ju.some(i=>typeof t[i]!="function")}append(...t){et("append",arguments,2),this.#e.push(_o(...t))}delete(t){et("delete",arguments,1),t+="",this.#e=this.#e.filter(([i])=>i!==t)}get(t){et("get",arguments,1),t+="";for(var i=this.#e,s=i.length,o=0;o<s;o++)if(i[o][0]===t)return i[o][1];return null}getAll(t,i){return et("getAll",arguments,1),i=[],t+="",this.#e.forEach(s=>s[0]===t&&i.push(s[1])),i}has(t){return et("has",arguments,1),t+="",this.#e.some(i=>i[0]===t)}forEach(t,i){et("forEach",arguments,1);for(var[s,o]of this)t.call(i,o,s,this)}set(...t){et("set",arguments,2);var i=[],s=!0;t=_o(...t),this.#e.forEach(o=>{o[0]===t[0]?s&&(s=!i.push(t)):i.push(o)}),s&&i.push(t),this.#e=i}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var xo=M((md,wo)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=require("worker_threads"),t=new r().port1,i=new ArrayBuffer;t.postMessage(i,[i,i])}catch(r){r.constructor.name==="DOMException"&&(globalThis.DOMException=r.constructor)}wo.exports=globalThis.DOMException});var Qt,Eo,Zu,Ro,ri=$t(()=>{Qt=require("node:fs"),Eo=V(xo(),1);Xn();Ht();({stat:Zu}=Qt.promises),Ro=class r{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified}slice(t,i){return new r({path:this.#e,lastModified:this.lastModified,size:i-t,start:this.#t+t})}async*stream(){let{mtimeMs:t}=await Zu(this.#e);if(t>this.lastModified)throw new Eo.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,Qt.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var vo={};eo(vo,{toFormData:()=>of});function sf(r){let t=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let i=t[2]||t[3]||"",s=i.slice(i.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(o,l)=>String.fromCharCode(l)),s}async function of(r,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let i=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!i)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new ni(i[1]||i[2]),o,l,f,m,p,d,S=[],b=new tt,w=P=>{f+=T.decode(P,{stream:!0})},y=P=>{S.push(P)},g=()=>{let P=new wt(S,d,{type:p});b.append(m,P)},R=()=>{b.append(m,f)},T=new TextDecoder("utf-8");T.decode(),s.onPartBegin=function(){s.onPartData=w,s.onPartEnd=R,o="",l="",f="",m="",p="",d=null,S.length=0},s.onHeaderField=function(P){o+=T.decode(P,{stream:!0})},s.onHeaderValue=function(P){l+=T.decode(P,{stream:!0})},s.onHeaderEnd=function(){if(l+=T.decode(),o=o.toLowerCase(),o==="content-disposition"){let P=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);P&&(m=P[2]||P[3]||""),d=sf(l),d&&(s.onPartData=y,s.onPartEnd=g)}else o==="content-type"&&(p=l);l="",o=""};for await(let P of r)s.write(P);return s.end(),b}var _e,D,To,ze,Kr,Jr,Xu,Yt,ef,tf,rf,nf,rt,ni,Co=$t(()=>{ri();Qr();_e=0,D={START_BOUNDARY:_e++,HEADER_FIELD_START:_e++,HEADER_FIELD:_e++,HEADER_VALUE_START:_e++,HEADER_VALUE:_e++,HEADER_VALUE_ALMOST_DONE:_e++,HEADERS_ALMOST_DONE:_e++,PART_DATA_START:_e++,PART_DATA:_e++,END:_e++},To=1,ze={PART_BOUNDARY:To,LAST_BOUNDARY:To*=2},Kr=10,Jr=13,Xu=32,Yt=45,ef=58,tf=97,rf=122,nf=r=>r|32,rt=()=>{},ni=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=rt,this.onHeaderField=rt,this.onHeadersEnd=rt,this.onHeaderValue=rt,this.onPartBegin=rt,this.onPartData=rt,this.onPartEnd=rt,this.boundaryChars={},t=`\r
--`+t;let i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s),this.boundaryChars[i[s]]=!0;this.boundary=i,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=D.START_BOUNDARY}write(t){let i=0,s=t.length,o=this.index,{lookbehind:l,boundary:f,boundaryChars:m,index:p,state:d,flags:S}=this,b=this.boundary.length,w=b-1,y=t.length,g,R,T=v=>{this[v+"Mark"]=i},P=v=>{delete this[v+"Mark"]},L=(v,q,O,le)=>{(q===void 0||q!==O)&&this[v](le&&le.subarray(q,O))},F=(v,q)=>{let O=v+"Mark";O in this&&(q?(L(v,this[O],i,t),delete this[O]):(L(v,this[O],t.length,t),this[O]=0))};for(i=0;i<s;i++)switch(g=t[i],d){case D.START_BOUNDARY:if(p===f.length-2){if(g===Yt)S|=ze.LAST_BOUNDARY;else if(g!==Jr)return;p++;break}else if(p-1===f.length-2){if(S&ze.LAST_BOUNDARY&&g===Yt)d=D.END,S=0;else if(!(S&ze.LAST_BOUNDARY)&&g===Kr)p=0,L("onPartBegin"),d=D.HEADER_FIELD_START;else return;break}g!==f[p+2]&&(p=-2),g===f[p+2]&&p++;break;case D.HEADER_FIELD_START:d=D.HEADER_FIELD,T("onHeaderField"),p=0;case D.HEADER_FIELD:if(g===Jr){P("onHeaderField"),d=D.HEADERS_ALMOST_DONE;break}if(p++,g===Yt)break;if(g===ef){if(p===1)return;F("onHeaderField",!0),d=D.HEADER_VALUE_START;break}if(R=nf(g),R<tf||R>rf)return;break;case D.HEADER_VALUE_START:if(g===Xu)break;T("onHeaderValue"),d=D.HEADER_VALUE;case D.HEADER_VALUE:g===Jr&&(F("onHeaderValue",!0),L("onHeaderEnd"),d=D.HEADER_VALUE_ALMOST_DONE);break;case D.HEADER_VALUE_ALMOST_DONE:if(g!==Kr)return;d=D.HEADER_FIELD_START;break;case D.HEADERS_ALMOST_DONE:if(g!==Kr)return;L("onHeadersEnd"),d=D.PART_DATA_START;break;case D.PART_DATA_START:d=D.PART_DATA,T("onPartData");case D.PART_DATA:if(o=p,p===0){for(i+=w;i<y&&!(t[i]in m);)i+=b;i-=w,g=t[i]}if(p<f.length)f[p]===g?(p===0&&F("onPartData",!0),p++):p=0;else if(p===f.length)p++,g===Jr?S|=ze.PART_BOUNDARY:g===Yt?S|=ze.LAST_BOUNDARY:p=0;else if(p-1===f.length)if(S&ze.PART_BOUNDARY){if(p=0,g===Kr){S&=~ze.PART_BOUNDARY,L("onPartEnd"),L("onPartBegin"),d=D.HEADER_FIELD_START;break}}else S&ze.LAST_BOUNDARY&&g===Yt?(L("onPartEnd"),d=D.END,S=0):p=0;if(p>0)l[p-1]=g;else if(o>0){let v=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);L("onPartData",0,o,v),o=0,T("onPartData"),i--}break;case D.END:break;default:throw new Error(`Unexpected state entered: ${d}`)}F("onHeaderField"),F("onHeaderValue"),F("onPartData"),this.index=p,this.state=d,this.flags=S}end(){if(this.state===D.HEADER_FIELD_START&&this.index===0||this.state===D.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==D.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var sa=M((gh,ia)=>{"use strict";var{Duplex:bf}=require("stream");function ra(r){r.emit("close")}function yf(){!this.destroyed&&this._writableState.finished&&this.destroy()}function na(r){this.removeListener("error",na),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function Sf(r,t){let i=!0,s=new bf({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(l,f){let m=!f&&s._readableState.objectMode?l.toString():l;s.push(m)||r.pause()}),r.once("error",function(l){s.destroyed||(i=!1,s.destroy(l))}),r.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(o,l){if(r.readyState===r.CLOSED){l(o),process.nextTick(ra,s);return}let f=!1;r.once("error",function(p){f=!0,l(p)}),r.once("close",function(){f||l(o),process.nextTick(ra,s)}),i&&r.terminate()},s._final=function(o){if(r.readyState===r.CONNECTING){r.once("open",function(){s._final(o)});return}r._socket!==null&&(r._socket._writableState.finished?(o(),s._readableState.endEmitted&&s.destroy()):(r._socket.once("finish",function(){o()}),r.close()))},s._read=function(){r.isPaused&&r.resume()},s._write=function(o,l,f){if(r.readyState===r.CONNECTING){r.once("open",function(){s._write(o,l,f)});return}r.send(o,f)},s.on("end",yf),s.on("error",na),s}ia.exports=Sf});var $e=M((bh,oa)=>{"use strict";oa.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var tr=M((yh,sn)=>{"use strict";var{EMPTY_BUFFER:wf}=$e(),hi=Buffer[Symbol.species];function xf(r,t){if(r.length===0)return wf;if(r.length===1)return r[0];let i=Buffer.allocUnsafe(t),s=0;for(let o=0;o<r.length;o++){let l=r[o];i.set(l,s),s+=l.length}return s<t?new hi(i.buffer,i.byteOffset,s):i}function aa(r,t,i,s,o){for(let l=0;l<o;l++)i[s+l]=r[l]^t[l&3]}function la(r,t){for(let i=0;i<r.length;i++)r[i]^=t[i&3]}function Rf(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function pi(r){if(pi.readOnly=!0,Buffer.isBuffer(r))return r;let t;return r instanceof ArrayBuffer?t=new hi(r):ArrayBuffer.isView(r)?t=new hi(r.buffer,r.byteOffset,r.byteLength):(t=Buffer.from(r),pi.readOnly=!1),t}sn.exports={concat:xf,mask:aa,toArrayBuffer:Rf,toBuffer:pi,unmask:la};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=require("bufferutil");sn.exports.mask=function(t,i,s,o,l){l<48?aa(t,i,s,o,l):r.mask(t,i,s,o,l)},sn.exports.unmask=function(t,i){t.length<32?la(t,i):r.unmask(t,i)}}catch{}});var ca=M((Sh,fa)=>{"use strict";var ua=Symbol("kDone"),mi=Symbol("kRun"),_i=class{constructor(t){this[ua]=()=>{this.pending--,this[mi]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[mi]()}[mi](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[ua])}}};fa.exports=_i});var ir=M((wh,ma)=>{"use strict";var rr=require("zlib"),da=tr(),Ef=ca(),{kStatusCode:ha}=$e(),Tf=Buffer[Symbol.species],vf=Buffer.from([0,0,255,255]),ln=Symbol("permessage-deflate"),Ae=Symbol("total-length"),nr=Symbol("callback"),He=Symbol("buffers"),an=Symbol("error"),on,gi=class{constructor(t,i,s){if(this._maxPayload=s|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!i,this._deflate=null,this._inflate=null,this.params=null,!on){let o=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;on=new Ef(o)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[nr];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let i=this._options,s=t.find(o=>!(i.serverNoContextTakeover===!1&&o.server_no_context_takeover||o.server_max_window_bits&&(i.serverMaxWindowBits===!1||typeof i.serverMaxWindowBits=="number"&&i.serverMaxWindowBits>o.server_max_window_bits)||typeof i.clientMaxWindowBits=="number"&&!o.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return i.serverNoContextTakeover&&(s.server_no_context_takeover=!0),i.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof i.serverMaxWindowBits=="number"&&(s.server_max_window_bits=i.serverMaxWindowBits),typeof i.clientMaxWindowBits=="number"?s.client_max_window_bits=i.clientMaxWindowBits:(s.client_max_window_bits===!0||i.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(t){let i=t[0];if(this._options.clientNoContextTakeover===!1&&i.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!i.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(i.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&i.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return i}normalizeParams(t){return t.forEach(i=>{Object.keys(i).forEach(s=>{let o=i[s];if(o.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(o=o[0],s==="client_max_window_bits"){if(o!==!0){let l=+o;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${o}`);o=l}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${o}`)}else if(s==="server_max_window_bits"){let l=+o;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${o}`);o=l}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(o!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${o}`)}else throw new Error(`Unknown parameter "${s}"`);i[s]=o})}),t}decompress(t,i,s){on.add(o=>{this._decompress(t,i,(l,f)=>{o(),s(l,f)})})}compress(t,i,s){on.add(o=>{this._compress(t,i,(l,f)=>{o(),s(l,f)})})}_decompress(t,i,s){let o=this._isServer?"client":"server";if(!this._inflate){let l=`${o}_max_window_bits`,f=typeof this.params[l]!="number"?rr.Z_DEFAULT_WINDOWBITS:this.params[l];this._inflate=rr.createInflateRaw({...this._options.zlibInflateOptions,windowBits:f}),this._inflate[ln]=this,this._inflate[Ae]=0,this._inflate[He]=[],this._inflate.on("error",Pf),this._inflate.on("data",pa)}this._inflate[nr]=s,this._inflate.write(t),i&&this._inflate.write(vf),this._inflate.flush(()=>{let l=this._inflate[an];if(l){this._inflate.close(),this._inflate=null,s(l);return}let f=da.concat(this._inflate[He],this._inflate[Ae]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Ae]=0,this._inflate[He]=[],i&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),s(null,f)})}_compress(t,i,s){let o=this._isServer?"server":"client";if(!this._deflate){let l=`${o}_max_window_bits`,f=typeof this.params[l]!="number"?rr.Z_DEFAULT_WINDOWBITS:this.params[l];this._deflate=rr.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:f}),this._deflate[Ae]=0,this._deflate[He]=[],this._deflate.on("data",Cf)}this._deflate[nr]=s,this._deflate.write(t),this._deflate.flush(rr.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let l=da.concat(this._deflate[He],this._deflate[Ae]);i&&(l=new Tf(l.buffer,l.byteOffset,l.length-4)),this._deflate[nr]=null,this._deflate[Ae]=0,this._deflate[He]=[],i&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),s(null,l)})}};ma.exports=gi;function Cf(r){this[He].push(r),this[Ae]+=r.length}function pa(r){if(this[Ae]+=r.length,this[ln]._maxPayload<1||this[Ae]<=this[ln]._maxPayload){this[He].push(r);return}this[an]=new RangeError("Max payload size exceeded"),this[an].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[an][ha]=1009,this.removeListener("data",pa),this.reset()}function Pf(r){this[ln]._inflate=null,r[ha]=1007,this[nr](r)}});var sr=M((xh,un)=>{"use strict";var{isUtf8:_a}=require("buffer"),kf=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Af(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function bi(r){let t=r.length,i=0;for(;i<t;)if(!(r[i]&128))i++;else if((r[i]&224)===192){if(i+1===t||(r[i+1]&192)!==128||(r[i]&254)===192)return!1;i+=2}else if((r[i]&240)===224){if(i+2>=t||(r[i+1]&192)!==128||(r[i+2]&192)!==128||r[i]===224&&(r[i+1]&224)===128||r[i]===237&&(r[i+1]&224)===160)return!1;i+=3}else if((r[i]&248)===240){if(i+3>=t||(r[i+1]&192)!==128||(r[i+2]&192)!==128||(r[i+3]&192)!==128||r[i]===240&&(r[i+1]&240)===128||r[i]===244&&r[i+1]>143||r[i]>244)return!1;i+=4}else return!1;return!0}un.exports={isValidStatusCode:Af,isValidUTF8:bi,tokenChars:kf};if(_a)un.exports.isValidUTF8=function(r){return r.length<24?bi(r):_a(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");un.exports.isValidUTF8=function(t){return t.length<32?bi(t):r(t)}}catch{}});var Ri=M((Rh,Ea)=>{"use strict";var{Writable:Of}=require("stream"),ga=ir(),{BINARY_TYPES:Bf,EMPTY_BUFFER:ba,kStatusCode:If,kWebSocket:Lf}=$e(),{concat:yi,toArrayBuffer:Wf,unmask:Df}=tr(),{isValidStatusCode:qf,isValidUTF8:ya}=sr(),fn=Buffer[Symbol.species],Nf=Promise.resolve(),Ff=typeof queueMicrotask=="function"?queueMicrotask:Uf,Et=0,Sa=1,wa=2,xa=3,Si=4,Ra=5,wi=6,xi=class extends Of{constructor(t={}){super(),this._binaryType=t.binaryType||Bf[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[Lf]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=Et,this._loop=!1}_write(t,i,s){if(this._opcode===8&&this._state==Et)return s();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(s)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=new fn(s.buffer,s.byteOffset+t,s.length-t),new fn(s.buffer,s.byteOffset,t)}let i=Buffer.allocUnsafe(t);do{let s=this._buffers[0],o=i.length-t;t>=s.length?i.set(this._buffers.shift(),o):(i.set(new Uint8Array(s.buffer,s.byteOffset,t),o),this._buffers[0]=new fn(s.buffer,s.byteOffset+t,s.length-t)),t-=s.length}while(t>0);return i}startLoop(t){let i;this._loop=!0;do switch(this._state){case Et:i=this.getInfo();break;case Sa:i=this.getPayloadLength16();break;case wa:i=this.getPayloadLength64();break;case xa:this.getMask();break;case Si:i=this.getData(t);break;case Ra:this._loop=!1;return;default:this._loop=!1,Ff(()=>{this._state=Et,this.startLoop(t)});return}while(this._loop);t(i)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if(t[0]&48)return this._loop=!1,z(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let i=(t[0]&64)===64;if(i&&!this._extensions[ga.extensionName])return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(i)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,z(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=i}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,z(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(i)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1)return this._loop=!1,z(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,z(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,z(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=Sa;else if(this._payloadLength===127)this._state=wa;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),i=t.readUInt32BE(0);return i>Math.pow(2,53-32)-1?(this._loop=!1,z(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=i*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=xa:this._state=Si}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Si}getData(t){let i=ba;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}i=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&Df(i,this._mask)}if(this._opcode>7)return this.controlMessage(i);if(this._compressed){this._state=Ra,this.decompress(i,t);return}return i.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(i)),this.dataMessage()}decompress(t,i){this._extensions[ga.extensionName].decompress(t,this._fin,(o,l)=>{if(o)return i(o);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return i(z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}let f=this.dataMessage();if(f)return i(f);this.startLoop(i)})}dataMessage(){if(this._fin){let t=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=yi(i,t):this._binaryType==="arraybuffer"?s=Wf(yi(i,t)):s=i,this.emit("message",s,!0)}else{let s=yi(i,t);if(!this._skipUTF8Validation&&!ya(s))return this._loop=!1,z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=wi}controlMessage(t){if(this._opcode===8)if(this._loop=!1,t.length===0)this.emit("conclude",1005,ba),this.end(),this._state=Et;else{let i=t.readUInt16BE(0);if(!qf(i))return z(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=new fn(t.buffer,t.byteOffset+2,t.length-2);if(!this._skipUTF8Validation&&!ya(s))return z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",i,s),this.end(),this._state=Et}else this._opcode===9?(this.emit("ping",t),this._state=wi):(this.emit("pong",t),this._state=wi)}};Ea.exports=xi;function z(r,t,i,s,o){let l=new r(i?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(l,z),l.code=o,l[If]=s,l}function Uf(r){Nf.then(r).catch(jf)}function Mf(r){throw r}function jf(r){process.nextTick(Mf,r)}});var Ti=M((Th,Ca)=>{"use strict";var{Duplex:Eh}=require("stream"),{randomFillSync:zf}=require("crypto"),Ta=ir(),{EMPTY_BUFFER:$f}=$e(),{isValidStatusCode:Hf}=sr(),{mask:va,toBuffer:Tt}=tr(),pe=Symbol("kByteLength"),Vf=Buffer.alloc(4),Ei=class r{constructor(t,i,s){this._extensions=i||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,i){let s,o=!1,l=2,f=!1;i.mask&&(s=i.maskBuffer||Vf,i.generateMask?i.generateMask(s):zf(s,0,4),f=(s[0]|s[1]|s[2]|s[3])===0,l=6);let m;typeof t=="string"?(!i.mask||f)&&i[pe]!==void 0?m=i[pe]:(t=Buffer.from(t),m=t.length):(m=t.length,o=i.mask&&i.readOnly&&!f);let p=m;m>=65536?(l+=8,p=127):m>125&&(l+=2,p=126);let d=Buffer.allocUnsafe(o?m+l:l);return d[0]=i.fin?i.opcode|128:i.opcode,i.rsv1&&(d[0]|=64),d[1]=p,p===126?d.writeUInt16BE(m,2):p===127&&(d[2]=d[3]=0,d.writeUIntBE(m,4,6)),i.mask?(d[1]|=128,d[l-4]=s[0],d[l-3]=s[1],d[l-2]=s[2],d[l-1]=s[3],f?[d,t]:o?(va(t,s,d,l,m),[d]):(va(t,s,t,0,m),[d,t])):[d,t]}close(t,i,s,o){let l;if(t===void 0)l=$f;else{if(typeof t!="number"||!Hf(t))throw new TypeError("First argument must be a valid error code number");if(i===void 0||!i.length)l=Buffer.allocUnsafe(2),l.writeUInt16BE(t,0);else{let m=Buffer.byteLength(i);if(m>123)throw new RangeError("The message must not be greater than 123 bytes");l=Buffer.allocUnsafe(2+m),l.writeUInt16BE(t,0),typeof i=="string"?l.write(i,2):l.set(i,2)}}let f={[pe]:l.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,l,!1,f,o]):this.sendFrame(r.frame(l,f),o)}ping(t,i,s){let o,l;if(typeof t=="string"?(o=Buffer.byteLength(t),l=!1):(t=Tt(t),o=t.length,l=Tt.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let f={[pe]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:9,readOnly:l,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,f,s]):this.sendFrame(r.frame(t,f),s)}pong(t,i,s){let o,l;if(typeof t=="string"?(o=Buffer.byteLength(t),l=!1):(t=Tt(t),o=t.length,l=Tt.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let f={[pe]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:10,readOnly:l,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,f,s]):this.sendFrame(r.frame(t,f),s)}send(t,i,s){let o=this._extensions[Ta.extensionName],l=i.binary?2:1,f=i.compress,m,p;if(typeof t=="string"?(m=Buffer.byteLength(t),p=!1):(t=Tt(t),m=t.length,p=Tt.readOnly),this._firstFragment?(this._firstFragment=!1,f&&o&&o.params[o._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(f=m>=o._threshold),this._compress=f):(f=!1,l=0),i.fin&&(this._firstFragment=!0),o){let d={[pe]:m,fin:i.fin,generateMask:this._generateMask,mask:i.mask,maskBuffer:this._maskBuffer,opcode:l,readOnly:p,rsv1:f};this._deflating?this.enqueue([this.dispatch,t,this._compress,d,s]):this.dispatch(t,this._compress,d,s)}else this.sendFrame(r.frame(t,{[pe]:m,fin:i.fin,generateMask:this._generateMask,mask:i.mask,maskBuffer:this._maskBuffer,opcode:l,readOnly:p,rsv1:!1}),s)}dispatch(t,i,s,o){if(!i){this.sendFrame(r.frame(t,s),o);return}let l=this._extensions[Ta.extensionName];this._bufferedBytes+=s[pe],this._deflating=!0,l.compress(t,s.fin,(f,m)=>{if(this._socket.destroyed){let p=new Error("The socket was closed while data was being compressed");typeof o=="function"&&o(p);for(let d=0;d<this._queue.length;d++){let S=this._queue[d],b=S[S.length-1];typeof b=="function"&&b(p)}return}this._bufferedBytes-=s[pe],this._deflating=!1,s.readOnly=!1,this.sendFrame(r.frame(m,s),o),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[3][pe],Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[3][pe],this._queue.push(t)}sendFrame(t,i){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],i),this._socket.uncork()):this._socket.write(t[0],i)}};Ca.exports=Ei});var Da=M((vh,Wa)=>{"use strict";var{kForOnEventAttribute:or,kListener:vi}=$e(),Pa=Symbol("kCode"),ka=Symbol("kData"),Aa=Symbol("kError"),Oa=Symbol("kMessage"),Ba=Symbol("kReason"),vt=Symbol("kTarget"),Ia=Symbol("kType"),La=Symbol("kWasClean"),Oe=class{constructor(t){this[vt]=null,this[Ia]=t}get target(){return this[vt]}get type(){return this[Ia]}};Object.defineProperty(Oe.prototype,"target",{enumerable:!0});Object.defineProperty(Oe.prototype,"type",{enumerable:!0});var ot=class extends Oe{constructor(t,i={}){super(t),this[Pa]=i.code===void 0?0:i.code,this[Ba]=i.reason===void 0?"":i.reason,this[La]=i.wasClean===void 0?!1:i.wasClean}get code(){return this[Pa]}get reason(){return this[Ba]}get wasClean(){return this[La]}};Object.defineProperty(ot.prototype,"code",{enumerable:!0});Object.defineProperty(ot.prototype,"reason",{enumerable:!0});Object.defineProperty(ot.prototype,"wasClean",{enumerable:!0});var Ct=class extends Oe{constructor(t,i={}){super(t),this[Aa]=i.error===void 0?null:i.error,this[Oa]=i.message===void 0?"":i.message}get error(){return this[Aa]}get message(){return this[Oa]}};Object.defineProperty(Ct.prototype,"error",{enumerable:!0});Object.defineProperty(Ct.prototype,"message",{enumerable:!0});var ar=class extends Oe{constructor(t,i={}){super(t),this[ka]=i.data===void 0?null:i.data}get data(){return this[ka]}};Object.defineProperty(ar.prototype,"data",{enumerable:!0});var Gf={addEventListener(r,t,i={}){for(let o of this.listeners(r))if(!i[or]&&o[vi]===t&&!o[or])return;let s;if(r==="message")s=function(l,f){let m=new ar("message",{data:f?l:l.toString()});m[vt]=this,cn(t,this,m)};else if(r==="close")s=function(l,f){let m=new ot("close",{code:l,reason:f.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});m[vt]=this,cn(t,this,m)};else if(r==="error")s=function(l){let f=new Ct("error",{error:l,message:l.message});f[vt]=this,cn(t,this,f)};else if(r==="open")s=function(){let l=new Oe("open");l[vt]=this,cn(t,this,l)};else return;s[or]=!!i[or],s[vi]=t,i.once?this.once(r,s):this.on(r,s)},removeEventListener(r,t){for(let i of this.listeners(r))if(i[vi]===t&&!i[or]){this.removeListener(r,i);break}}};Wa.exports={CloseEvent:ot,ErrorEvent:Ct,Event:Oe,EventTarget:Gf,MessageEvent:ar};function cn(r,t,i){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,i):r.call(t,i)}});var Ci=M((Ch,qa)=>{"use strict";var{tokenChars:lr}=sr();function we(r,t,i){r[t]===void 0?r[t]=[i]:r[t].push(i)}function Qf(r){let t=Object.create(null),i=Object.create(null),s=!1,o=!1,l=!1,f,m,p=-1,d=-1,S=-1,b=0;for(;b<r.length;b++)if(d=r.charCodeAt(b),f===void 0)if(S===-1&&lr[d]===1)p===-1&&(p=b);else if(b!==0&&(d===32||d===9))S===-1&&p!==-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b);let y=r.slice(p,S);d===44?(we(t,y,i),i=Object.create(null)):f=y,p=S=-1}else throw new SyntaxError(`Unexpected character at index ${b}`);else if(m===void 0)if(S===-1&&lr[d]===1)p===-1&&(p=b);else if(d===32||d===9)S===-1&&p!==-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b),we(i,r.slice(p,S),!0),d===44&&(we(t,f,i),i=Object.create(null),f=void 0),p=S=-1}else if(d===61&&p!==-1&&S===-1)m=r.slice(p,b),p=S=-1;else throw new SyntaxError(`Unexpected character at index ${b}`);else if(o){if(lr[d]!==1)throw new SyntaxError(`Unexpected character at index ${b}`);p===-1?p=b:s||(s=!0),o=!1}else if(l)if(lr[d]===1)p===-1&&(p=b);else if(d===34&&p!==-1)l=!1,S=b;else if(d===92)o=!0;else throw new SyntaxError(`Unexpected character at index ${b}`);else if(d===34&&r.charCodeAt(b-1)===61)l=!0;else if(S===-1&&lr[d]===1)p===-1&&(p=b);else if(p!==-1&&(d===32||d===9))S===-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b);let y=r.slice(p,S);s&&(y=y.replace(/\\/g,""),s=!1),we(i,m,y),d===44&&(we(t,f,i),i=Object.create(null),f=void 0),m=void 0,p=S=-1}else throw new SyntaxError(`Unexpected character at index ${b}`);if(p===-1||l||d===32||d===9)throw new SyntaxError("Unexpected end of input");S===-1&&(S=b);let w=r.slice(p,S);return f===void 0?we(t,w,i):(m===void 0?we(i,w,!0):s?we(i,m,w.replace(/\\/g,"")):we(i,m,w),we(t,f,i)),t}function Yf(r){return Object.keys(r).map(t=>{let i=r[t];return Array.isArray(i)||(i=[i]),i.map(s=>[t].concat(Object.keys(s).map(o=>{let l=s[o];return Array.isArray(l)||(l=[l]),l.map(f=>f===!0?o:`${o}=${f}`).join("; ")})).join("; ")).join(", ")}).join(", ")}qa.exports={format:Yf,parse:Qf}});var Bi=M((Ah,Qa)=>{"use strict";var Kf=require("events"),Jf=require("https"),Zf=require("http"),Ua=require("net"),Xf=require("tls"),{randomBytes:ec,createHash:tc}=require("crypto"),{Duplex:Ph,Readable:kh}=require("stream"),{URL:Pi}=require("url"),Ve=ir(),rc=Ri(),nc=Ti(),{BINARY_TYPES:Na,EMPTY_BUFFER:dn,GUID:ic,kForOnEventAttribute:ki,kListener:sc,kStatusCode:oc,kWebSocket:G,NOOP:Ma}=$e(),{EventTarget:{addEventListener:ac,removeEventListener:lc}}=Da(),{format:uc,parse:fc}=Ci(),{toBuffer:cc}=tr(),dc=30*1e3,ja=Symbol("kAborted"),Ai=[8,13],Be=["CONNECTING","OPEN","CLOSING","CLOSED"],hc=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,N=class r extends Kf{constructor(t,i,s){super(),this._binaryType=Na[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=dn,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,i===void 0?i=[]:Array.isArray(i)||(typeof i=="object"&&i!==null?(s=i,i=[]):i=[i]),za(this,t,i,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){Na.includes(t)&&(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,i,s){let o=new rc({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new nc(t,this._extensions,s.generateMask),this._receiver=o,this._socket=t,o[G]=this,t[G]=this,o.on("conclude",_c),o.on("drain",gc),o.on("error",bc),o.on("message",yc),o.on("ping",Sc),o.on("pong",wc),t.setTimeout&&t.setTimeout(0),t.setNoDelay&&t.setNoDelay(),i.length>0&&t.unshift(i),t.on("close",Ha),t.on("data",pn),t.on("end",Va),t.on("error",Ga),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Ve.extensionName]&&this._extensions[Ve.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,i){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){let s="WebSocket was closed before the connection was established";re(this,this._req,s);return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(t,i,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),dc)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=i=void 0):typeof i=="function"&&(s=i,i=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){Oi(this,t,s);return}i===void 0&&(i=!this._isServer),this._sender.ping(t||dn,i,s)}pong(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=i=void 0):typeof i=="function"&&(s=i,i=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){Oi(this,t,s);return}i===void 0&&(i=!this._isServer),this._sender.pong(t||dn,i,s)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof i=="function"&&(s=i,i={}),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){Oi(this,t,s);return}let o={binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0,...i};this._extensions[Ve.extensionName]||(o.compress=!1),this._sender.send(t||dn,o,s)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){let t="WebSocket was closed before the connection was established";re(this,this._req,t);return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(N,"CONNECTING",{enumerable:!0,value:Be.indexOf("CONNECTING")});Object.defineProperty(N.prototype,"CONNECTING",{enumerable:!0,value:Be.indexOf("CONNECTING")});Object.defineProperty(N,"OPEN",{enumerable:!0,value:Be.indexOf("OPEN")});Object.defineProperty(N.prototype,"OPEN",{enumerable:!0,value:Be.indexOf("OPEN")});Object.defineProperty(N,"CLOSING",{enumerable:!0,value:Be.indexOf("CLOSING")});Object.defineProperty(N.prototype,"CLOSING",{enumerable:!0,value:Be.indexOf("CLOSING")});Object.defineProperty(N,"CLOSED",{enumerable:!0,value:Be.indexOf("CLOSED")});Object.defineProperty(N.prototype,"CLOSED",{enumerable:!0,value:Be.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(N.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(N.prototype,`on${r}`,{enumerable:!0,get(){for(let t of this.listeners(r))if(t[ki])return t[sc];return null},set(t){for(let i of this.listeners(r))if(i[ki]){this.removeListener(r,i);break}typeof t=="function"&&this.addEventListener(r,t,{[ki]:!0})}})});N.prototype.addEventListener=ac;N.prototype.removeEventListener=lc;Qa.exports=N;function za(r,t,i,s){let o={protocolVersion:Ai[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Ai.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${Ai.join(", ")})`);let l;if(t instanceof Pi)l=t;else try{l=new Pi(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}l.protocol==="http:"?l.protocol="ws:":l.protocol==="https:"&&(l.protocol="wss:"),r._url=l.href;let f=l.protocol==="wss:",m=l.protocol==="ws+unix:",p;if(l.protocol!=="ws:"&&!f&&!m?p=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:m&&!l.pathname?p="The URL's pathname is empty":l.hash&&(p="The URL contains a fragment identifier"),p){let R=new SyntaxError(p);if(r._redirects===0)throw R;hn(r,R);return}let d=f?443:80,S=ec(16).toString("base64"),b=f?Jf.request:Zf.request,w=new Set,y;if(o.createConnection=f?mc:pc,o.defaultPort=o.defaultPort||d,o.port=l.port||d,o.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":S,Connection:"Upgrade",Upgrade:"websocket"},o.path=l.pathname+l.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(y=new Ve(o.perMessageDeflate!==!0?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=uc({[Ve.extensionName]:y.offer()})),i.length){for(let R of i){if(typeof R!="string"||!hc.test(R)||w.has(R))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(R)}o.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(l.username||l.password)&&(o.auth=`${l.username}:${l.password}`),m){let R=o.path.split(":");o.socketPath=R[0],o.path=R[1]}let g;if(o.followRedirects){if(r._redirects===0){r._originalIpc=m,r._originalSecure=f,r._originalHostOrSocketPath=m?o.socketPath:l.host;let R=s&&s.headers;if(s={...s,headers:{}},R)for(let[T,P]of Object.entries(R))s.headers[T.toLowerCase()]=P}else if(r.listenerCount("redirect")===0){let R=m?r._originalIpc?o.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:l.host===r._originalHostOrSocketPath;(!R||r._originalSecure&&!f)&&(delete o.headers.authorization,delete o.headers.cookie,R||delete o.headers.host,o.auth=void 0)}o.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),g=r._req=b(o),r._redirects&&r.emit("redirect",r.url,g)}else g=r._req=b(o);o.timeout&&g.on("timeout",()=>{re(r,g,"Opening handshake has timed out")}),g.on("error",R=>{g===null||g[ja]||(g=r._req=null,hn(r,R))}),g.on("response",R=>{let T=R.headers.location,P=R.statusCode;if(T&&o.followRedirects&&P>=300&&P<400){if(++r._redirects>o.maxRedirects){re(r,g,"Maximum redirects exceeded");return}g.abort();let L;try{L=new Pi(T,t)}catch{let v=new SyntaxError(`Invalid URL: ${T}`);hn(r,v);return}za(r,L,i,s)}else r.emit("unexpected-response",g,R)||re(r,g,`Unexpected server response: ${R.statusCode}`)}),g.on("upgrade",(R,T,P)=>{if(r.emit("upgrade",R),r.readyState!==N.CONNECTING)return;if(g=r._req=null,R.headers.upgrade.toLowerCase()!=="websocket"){re(r,T,"Invalid Upgrade header");return}let L=tc("sha1").update(S+ic).digest("base64");if(R.headers["sec-websocket-accept"]!==L){re(r,T,"Invalid Sec-WebSocket-Accept header");return}let F=R.headers["sec-websocket-protocol"],v;if(F!==void 0?w.size?w.has(F)||(v="Server sent an invalid subprotocol"):v="Server sent a subprotocol but none was requested":w.size&&(v="Server sent no subprotocol"),v){re(r,T,v);return}F&&(r._protocol=F);let q=R.headers["sec-websocket-extensions"];if(q!==void 0){if(!y){re(r,T,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let O;try{O=fc(q)}catch{re(r,T,"Invalid Sec-WebSocket-Extensions header");return}let le=Object.keys(O);if(le.length!==1||le[0]!==Ve.extensionName){re(r,T,"Server indicated an extension that was not requested");return}try{y.accept(O[Ve.extensionName])}catch{re(r,T,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[Ve.extensionName]=y}r.setSocket(T,P,{generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})}),o.finishRequest?o.finishRequest(g,r):g.end()}function hn(r,t){r._readyState=N.CLOSING,r.emit("error",t),r.emitClose()}function pc(r){return r.path=r.socketPath,Ua.connect(r)}function mc(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=Ua.isIP(r.host)?"":r.host),Xf.connect(r)}function re(r,t,i){r._readyState=N.CLOSING;let s=new Error(i);Error.captureStackTrace(s,re),t.setHeader?(t[ja]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(hn,r,s)):(t.destroy(s),t.once("error",r.emit.bind(r,"error")),t.once("close",r.emitClose.bind(r)))}function Oi(r,t,i){if(t){let s=cc(t).length;r._socket?r._sender._bufferedBytes+=s:r._bufferedAmount+=s}if(i){let s=new Error(`WebSocket is not open: readyState ${r.readyState} (${Be[r.readyState]})`);process.nextTick(i,s)}}function _c(r,t){let i=this[G];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=r,i._socket[G]!==void 0&&(i._socket.removeListener("data",pn),process.nextTick($a,i._socket),r===1005?i.close():i.close(r,t))}function gc(){let r=this[G];r.isPaused||r._socket.resume()}function bc(r){let t=this[G];t._socket[G]!==void 0&&(t._socket.removeListener("data",pn),process.nextTick($a,t._socket),t.close(r[oc])),t.emit("error",r)}function Fa(){this[G].emitClose()}function yc(r,t){this[G].emit("message",r,t)}function Sc(r){let t=this[G];t.pong(r,!t._isServer,Ma),t.emit("ping",r)}function wc(r){this[G].emit("pong",r)}function $a(r){r.resume()}function Ha(){let r=this[G];this.removeListener("close",Ha),this.removeListener("data",pn),this.removeListener("end",Va),r._readyState=N.CLOSING;let t;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(t=r._socket.read())!==null&&r._receiver.write(t),r._receiver.end(),this[G]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",Fa),r._receiver.on("finish",Fa))}function pn(r){this[G]._receiver.write(r)||this.pause()}function Va(){let r=this[G];r._readyState=N.CLOSING,r._receiver.end(),this.end()}function Ga(){let r=this[G];this.removeListener("error",Ga),this.on("error",Ma),r&&(r._readyState=N.CLOSING,this.destroy())}});var Ka=M((Oh,Ya)=>{"use strict";var{tokenChars:xc}=sr();function Rc(r){let t=new Set,i=-1,s=-1,o=0;for(o;o<r.length;o++){let f=r.charCodeAt(o);if(s===-1&&xc[f]===1)i===-1&&(i=o);else if(o!==0&&(f===32||f===9))s===-1&&i!==-1&&(s=o);else if(f===44){if(i===-1)throw new SyntaxError(`Unexpected character at index ${o}`);s===-1&&(s=o);let m=r.slice(i,s);if(t.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);t.add(m),i=s=-1}else throw new SyntaxError(`Unexpected character at index ${o}`)}if(i===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let l=r.slice(i,o);if(t.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);return t.add(l),t}Ya.exports={parse:Rc}});var nl=M((Ih,rl)=>{"use strict";var Ec=require("events"),mn=require("http"),{Duplex:Bh}=require("stream"),{createHash:Tc}=require("crypto"),Ja=Ci(),at=ir(),vc=Ka(),Cc=Bi(),{GUID:Pc,kWebSocket:kc}=$e(),Ac=/^[+/0-9A-Za-z]{22}==$/,Za=0,Xa=1,tl=2,Ii=class extends Ec{constructor(t,i){if(super(),t={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Cc,...t},t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=mn.createServer((s,o)=>{let l=mn.STATUS_CODES[426];o.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),o.end(l)}),this._server.listen(t.port,t.host,t.backlog,i)):t.server&&(this._server=t.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=Oc(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(o,l,f)=>{this.handleUpgrade(o,l,f,s)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=Za}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===tl){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(ur,this);return}if(t&&this.once("close",t),this._state!==Xa)if(this._state=Xa,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(ur,this):process.nextTick(ur,this);else{let i=this._server;this._removeListeners(),this._removeListeners=this._server=null,i.close(()=>{ur(this)})}}shouldHandle(t){if(this.options.path){let i=t.url.indexOf("?");if((i!==-1?t.url.slice(0,i):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,i,s,o){i.on("error",el);let l=t.headers["sec-websocket-key"],f=+t.headers["sec-websocket-version"];if(t.method!=="GET"){lt(this,t,i,405,"Invalid HTTP method");return}if(t.headers.upgrade.toLowerCase()!=="websocket"){lt(this,t,i,400,"Invalid Upgrade header");return}if(!l||!Ac.test(l)){lt(this,t,i,400,"Missing or invalid Sec-WebSocket-Key header");return}if(f!==8&&f!==13){lt(this,t,i,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(t)){fr(i,400);return}let m=t.headers["sec-websocket-protocol"],p=new Set;if(m!==void 0)try{p=vc.parse(m)}catch{lt(this,t,i,400,"Invalid Sec-WebSocket-Protocol header");return}let d=t.headers["sec-websocket-extensions"],S={};if(this.options.perMessageDeflate&&d!==void 0){let b=new at(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let w=Ja.parse(d);w[at.extensionName]&&(b.accept(w[at.extensionName]),S[at.extensionName]=b)}catch{lt(this,t,i,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let b={origin:t.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(b,(w,y,g,R)=>{if(!w)return fr(i,y||401,g,R);this.completeUpgrade(S,l,p,t,i,s,o)});return}if(!this.options.verifyClient(b))return fr(i,401)}this.completeUpgrade(S,l,p,t,i,s,o)}completeUpgrade(t,i,s,o,l,f,m){if(!l.readable||!l.writable)return l.destroy();if(l[kc])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>Za)return fr(l,503);let d=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Tc("sha1").update(i+Pc).digest("base64")}`],S=new this.options.WebSocket(null);if(s.size){let b=this.options.handleProtocols?this.options.handleProtocols(s,o):s.values().next().value;b&&(d.push(`Sec-WebSocket-Protocol: ${b}`),S._protocol=b)}if(t[at.extensionName]){let b=t[at.extensionName].params,w=Ja.format({[at.extensionName]:[b]});d.push(`Sec-WebSocket-Extensions: ${w}`),S._extensions=t}this.emit("headers",d,o),l.write(d.concat(`\r
`).join(`\r
`)),l.removeListener("error",el),S.setSocket(l,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(S),S.on("close",()=>{this.clients.delete(S),this._shouldEmitClose&&!this.clients.size&&process.nextTick(ur,this)})),m(S,o)}};rl.exports=Ii;function Oc(r,t){for(let i of Object.keys(t))r.on(i,t[i]);return function(){for(let s of Object.keys(t))r.removeListener(s,t[s])}}function ur(r){r._state=tl,r.emit("close")}function el(){this.destroy()}function fr(r,t,i,s){i=i||mn.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(i),...s},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${t} ${mn.STATUS_CODES[t]}\r
`+Object.keys(s).map(o=>`${o}: ${s[o]}`).join(`\r
`)+`\r
\r
`+i)}function lt(r,t,i,s,o){if(r.listenerCount("wsClientError")){let l=new Error(o);Error.captureStackTrace(l,lt),r.emit("wsClientError",l,i,t)}else fr(i,s,o)}});var Gc={};eo(Gc,{onBrowserWindowCreated:()=>Hc,output:()=>We,requestCallbackMap:()=>Pt});module.exports=zu(Gc);var Ho=V(ao());var jo=V(require("node:http"),1),zo=V(require("node:https"),1),it=V(require("node:zlib"),1),te=V(require("node:stream"),1),Zt=require("node:buffer");function Hu(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let t=r.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let i=r.substring(5,t).split(";"),s="",o=!1,l=i[0]||"text/plain",f=l;for(let S=1;S<i.length;S++)i[S]==="base64"?o=!0:i[S]&&(f+=`;${i[S]}`,i[S].indexOf("charset=")===0&&(s=i[S].substring(8)));!i[0]&&!s.length&&(f+=";charset=US-ASCII",s="US-ASCII");let m=o?"base64":"ascii",p=unescape(r.substring(t+1)),d=Buffer.from(p,m);return d.type=l,d.typeFull=f,d.charset=s,d}var lo=Hu;var oe=V(require("node:stream"),1),ke=require("node:util"),X=require("node:buffer");Ht();Qr();var Pe=class extends Error{constructor(t,i){super(t),Error.captureStackTrace(this,this.constructor),this.type=i}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var K=class extends Pe{constructor(t,i,s){super(t,i),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var Yr=Symbol.toStringTag,ti=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[Yr]==="URLSearchParams",Gt=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[Yr]),bo=r=>typeof r=="object"&&(r[Yr]==="AbortSignal"||r[Yr]==="EventTarget"),yo=(r,t)=>{let i=new URL(t).hostname,s=new URL(r).hostname;return i===s||i.endsWith(`.${s}`)},So=(r,t)=>{let i=new URL(t).protocol,s=new URL(r).protocol;return i===s};var af=(0,ke.promisify)(oe.default.pipeline),J=Symbol("Body internals"),ge=class{constructor(t,{size:i=0}={}){let s=null;t===null?t=null:ti(t)?t=X.Buffer.from(t.toString()):Gt(t)||X.Buffer.isBuffer(t)||(ke.types.isAnyArrayBuffer(t)?t=X.Buffer.from(t):ArrayBuffer.isView(t)?t=X.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof oe.default||(t instanceof tt?(t=go(t),s=t.type.split("=")[1]):t=X.Buffer.from(String(t))));let o=t;X.Buffer.isBuffer(t)?o=oe.default.Readable.from(t):Gt(t)&&(o=oe.default.Readable.from(t.stream())),this[J]={body:t,stream:o,boundary:s,disturbed:!1,error:null},this.size=i,t instanceof oe.default&&t.on("error",l=>{let f=l instanceof Pe?l:new K(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[J].error=f})}get body(){return this[J].stream}get bodyUsed(){return this[J].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:i,byteLength:s}=await ii(this);return t.slice(i,i+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new tt,o=new URLSearchParams(await this.text());for(let[l,f]of o)s.append(l,f);return s}let{toFormData:i}=await Promise.resolve().then(()=>(Co(),vo));return i(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[J].body&&this[J].body.type||"",i=await this.arrayBuffer();return new Ce([i],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await ii(this);return new TextDecoder().decode(t)}buffer(){return ii(this)}};ge.prototype.buffer=(0,ke.deprecate)(ge.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ge.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,ke.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function ii(r){if(r[J].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[J].disturbed=!0,r[J].error)throw r[J].error;let{body:t}=r;if(t===null)return X.Buffer.alloc(0);if(!(t instanceof oe.default))return X.Buffer.alloc(0);let i=[],s=0;try{for await(let o of t){if(r.size>0&&s+o.length>r.size){let l=new K(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw t.destroy(l),l}s+=o.length,i.push(o)}}catch(o){throw o instanceof Pe?o:new K(`Invalid response body while trying to fetch ${r.url}: ${o.message}`,"system",o)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return i.every(o=>typeof o=="string")?X.Buffer.from(i.join("")):X.Buffer.concat(i,s)}catch(o){throw new K(`Could not create Buffer from response body for ${r.url}: ${o.message}`,"system",o)}else throw new K(`Premature close of server response while trying to fetch ${r.url}`)}var xt=(r,t)=>{let i,s,{body:o}=r[J];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof oe.default&&typeof o.getBoundary!="function"&&(i=new oe.PassThrough({highWaterMark:t}),s=new oe.PassThrough({highWaterMark:t}),o.pipe(i),o.pipe(s),r[J].stream=i,o=s),o},lf=(0,ke.deprecate)(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Zr=(r,t)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":ti(r)?"application/x-www-form-urlencoded;charset=UTF-8":Gt(r)?r.type||null:X.Buffer.isBuffer(r)||ke.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof tt?`multipart/form-data; boundary=${t[J].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${lf(r)}`:r instanceof oe.default?null:"text/plain;charset=UTF-8",Po=r=>{let{body:t}=r[J];return t===null?0:Gt(t)?t.size:X.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},ko=async(r,{body:t})=>{t===null?r.end():await af(t,r)};var si=require("node:util"),Kt=V(require("node:http"),1),Xr=typeof Kt.default.validateHeaderName=="function"?Kt.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let t=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},oi=typeof Kt.default.validateHeaderValue=="function"?Kt.default.validateHeaderValue:(r,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let i=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(i,"code",{value:"ERR_INVALID_CHAR"}),i}},ee=class r extends URLSearchParams{constructor(t){let i=[];if(t instanceof r){let s=t.raw();for(let[o,l]of Object.entries(s))i.push(...l.map(f=>[o,f]))}else if(t!=null)if(typeof t=="object"&&!si.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)i.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");i=[...t].map(o=>{if(typeof o!="object"||si.types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return[...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...o]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return i=i.length>0?i.map(([s,o])=>(Xr(s),oi(s,String(o)),[String(s).toLowerCase(),String(o)])):void 0,super(i),new Proxy(this,{get(s,o,l){switch(o){case"append":case"set":return(f,m)=>(Xr(f),oi(f,String(m)),URLSearchParams.prototype[o].call(s,String(f).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return f=>(Xr(f),URLSearchParams.prototype[o].call(s,String(f).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,o,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let i=this.getAll(t);if(i.length===0)return null;let s=i.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,i=void 0){for(let s of this.keys())Reflect.apply(t,i,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,i)=>(t[i]=this.getAll(i),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,i)=>{let s=this.getAll(i);return i==="host"?t[i]=s[0]:t[i]=s.length>1?s:s[0],t},{})}};Object.defineProperties(ee.prototype,["get","entries","forEach","values"].reduce((r,t)=>(r[t]={enumerable:!0},r),{}));function Ao(r=[]){return new ee(r.reduce((t,i,s,o)=>(s%2===0&&t.push(o.slice(s,s+2)),t),[]).filter(([t,i])=>{try{return Xr(t),oi(t,String(i)),!0}catch{return!1}}))}var uf=new Set([301,302,303,307,308]),en=r=>uf.has(r);var he=Symbol("Response internals"),ae=class r extends ge{constructor(t=null,i={}){super(t,i);let s=i.status!=null?i.status:200,o=new ee(i.headers);if(t!==null&&!o.has("Content-Type")){let l=Zr(t,this);l&&o.append("Content-Type",l)}this[he]={type:"default",url:i.url,status:s,statusText:i.statusText||"",headers:o,counter:i.counter,highWaterMark:i.highWaterMark}}get type(){return this[he].type}get url(){return this[he].url||""}get status(){return this[he].status}get ok(){return this[he].status>=200&&this[he].status<300}get redirected(){return this[he].counter>0}get statusText(){return this[he].statusText}get headers(){return this[he].headers}get highWaterMark(){return this[he].highWaterMark}clone(){return new r(xt(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,i=302){if(!en(i))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new r(null,{headers:{location:new URL(t).toString()},status:i})}static error(){let t=new r(null,{status:0,statusText:""});return t[he].type="error",t}static json(t=void 0,i={}){let s=JSON.stringify(t);if(s===void 0)throw new TypeError("data is not JSON serializable");let o=new ee(i&&i.headers);return o.has("content-type")||o.set("content-type","application/json"),new r(s,{...i,headers:o})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(ae.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Fo=require("node:url"),Uo=require("node:util");var Oo=r=>{if(r.search)return r.search;let t=r.href.length-1,i=r.hash||(r.href[t]==="#"?"#":"");return r.href[t-i.length]==="?"?"?":""};var Io=require("node:net");function Bo(r,t=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",t&&(r.pathname="",r.search=""),r)}var Lo=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Wo="strict-origin-when-cross-origin";function Do(r){if(!Lo.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function ff(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let t=r.host.replace(/(^\[)|(]$)/g,""),i=(0,Io.isIP)(t);return i===4&&/^127\./.test(t)||i===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function Rt(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:ff(r)}function qo(r,{referrerURLCallback:t,referrerOriginCallback:i}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let s=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let o=r.referrer,l=Bo(o),f=Bo(o,!0);l.toString().length>4096&&(l=f),t&&(l=t(l)),i&&(f=i(f));let m=new URL(r.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return f;case"unsafe-url":return l;case"strict-origin":return Rt(l)&&!Rt(m)?"no-referrer":f.toString();case"strict-origin-when-cross-origin":return l.origin===m.origin?l:Rt(l)&&!Rt(m)?"no-referrer":f;case"same-origin":return l.origin===m.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===m.origin?l:f;case"no-referrer-when-downgrade":return Rt(l)&&!Rt(m)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function No(r){let t=(r.get("referrer-policy")||"").split(/[,\s]+/),i="";for(let s of t)s&&Lo.has(s)&&(i=s);return i}var j=Symbol("Request internals"),Jt=r=>typeof r=="object"&&typeof r[j]=="object",cf=(0,Uo.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),nt=class r extends ge{constructor(t,i={}){let s;if(Jt(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let o=i.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!Jt(i)&&"data"in i&&cf(),(i.body!=null||Jt(t)&&t.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=i.body?i.body:Jt(t)&&t.body!==null?xt(t):null;super(l,{size:i.size||t.size||0});let f=new ee(i.headers||t.headers||{});if(l!==null&&!f.has("Content-Type")){let d=Zr(l,this);d&&f.set("Content-Type",d)}let m=Jt(t)?t.signal:null;if("signal"in i&&(m=i.signal),m!=null&&!bo(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let p=i.referrer==null?t.referrer:i.referrer;if(p==="")p="no-referrer";else if(p){let d=new URL(p);p=/^about:(\/\/)?client$/.test(d)?"client":d}else p=void 0;this[j]={method:o,redirect:i.redirect||t.redirect||"follow",headers:f,parsedURL:s,signal:m,referrer:p},this.follow=i.follow===void 0?t.follow===void 0?20:t.follow:i.follow,this.compress=i.compress===void 0?t.compress===void 0?!0:t.compress:i.compress,this.counter=i.counter||t.counter||0,this.agent=i.agent||t.agent,this.highWaterMark=i.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=i.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=i.referrerPolicy||t.referrerPolicy||""}get method(){return this[j].method}get url(){return(0,Fo.format)(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}get referrer(){if(this[j].referrer==="no-referrer")return"";if(this[j].referrer==="client")return"about:client";if(this[j].referrer)return this[j].referrer.toString()}get referrerPolicy(){return this[j].referrerPolicy}set referrerPolicy(t){this[j].referrerPolicy=Do(t)}clone(){return new r(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(nt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Mo=r=>{let{parsedURL:t}=r[j],i=new ee(r[j].headers);i.has("Accept")||i.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let m=Po(r);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&i.set("Content-Length",s),r.referrerPolicy===""&&(r.referrerPolicy=Wo),r.referrer&&r.referrer!=="no-referrer"?r[j].referrer=qo(r):r[j].referrer="no-referrer",r[j].referrer instanceof URL&&i.set("Referer",r.referrer),i.has("User-Agent")||i.set("User-Agent","node-fetch"),r.compress&&!i.has("Accept-Encoding")&&i.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=r;typeof o=="function"&&(o=o(t));let l=Oo(t),f={path:t.pathname+l,method:r.method,headers:i[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:o};return{parsedURL:t,options:f}};var tn=class extends Pe{constructor(t,i="aborted"){super(t,i)}};Qr();ri();var df=new Set(["data:","http:","https:"]);async function rn(r,t){return new Promise((i,s)=>{let o=new nt(r,t),{parsedURL:l,options:f}=Mo(o);if(!df.has(l.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let g=lo(o.url),R=new ae(g,{headers:{"Content-Type":g.typeFull}});i(R);return}let m=(l.protocol==="https:"?zo.default:jo.default).request,{signal:p}=o,d=null,S=()=>{let g=new tn("The operation was aborted.");s(g),o.body&&o.body instanceof te.default.Readable&&o.body.destroy(g),!(!d||!d.body)&&d.body.emit("error",g)};if(p&&p.aborted){S();return}let b=()=>{S(),y()},w=m(l.toString(),f);p&&p.addEventListener("abort",b);let y=()=>{w.abort(),p&&p.removeEventListener("abort",b)};w.on("error",g=>{s(new K(`request to ${o.url} failed, reason: ${g.message}`,"system",g)),y()}),hf(w,g=>{d&&d.body&&d.body.destroy(g)}),process.version<"v14"&&w.on("socket",g=>{let R;g.prependListener("end",()=>{R=g._eventsCount}),g.prependListener("close",T=>{if(d&&R<g._eventsCount&&!T){let P=new Error("Premature close");P.code="ERR_STREAM_PREMATURE_CLOSE",d.body.emit("error",P)}})}),w.on("response",g=>{w.setTimeout(0);let R=Ao(g.rawHeaders);if(en(g.statusCode)){let v=R.get("Location"),q=null;try{q=v===null?null:new URL(v,o.url)}catch{if(o.redirect!=="manual"){s(new K(`uri requested responds with an invalid redirect URL: ${v}`,"invalid-redirect")),y();return}}switch(o.redirect){case"error":s(new K(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),y();return;case"manual":break;case"follow":{if(q===null)break;if(o.counter>=o.follow){s(new K(`maximum redirect reached at: ${o.url}`,"max-redirect")),y();return}let O={headers:new ee(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:xt(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!yo(o.url,q)||!So(o.url,q))for(let $ of["authorization","www-authenticate","cookie","cookie2"])O.headers.delete($);if(g.statusCode!==303&&o.body&&t.body instanceof te.default.Readable){s(new K("Cannot follow redirect with body being a readable stream","unsupported-redirect")),y();return}(g.statusCode===303||(g.statusCode===301||g.statusCode===302)&&o.method==="POST")&&(O.method="GET",O.body=void 0,O.headers.delete("content-length"));let le=No(R);le&&(O.referrerPolicy=le),i(rn(new nt(q,O))),y();return}default:return s(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}p&&g.once("end",()=>{p.removeEventListener("abort",b)});let T=(0,te.pipeline)(g,new te.PassThrough,v=>{v&&s(v)});process.version<"v12.10"&&g.on("aborted",b);let P={url:o.url,status:g.statusCode,statusText:g.statusMessage,headers:R,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},L=R.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||L===null||g.statusCode===204||g.statusCode===304){d=new ae(T,P),i(d);return}let F={flush:it.default.Z_SYNC_FLUSH,finishFlush:it.default.Z_SYNC_FLUSH};if(L==="gzip"||L==="x-gzip"){T=(0,te.pipeline)(T,it.default.createGunzip(F),v=>{v&&s(v)}),d=new ae(T,P),i(d);return}if(L==="deflate"||L==="x-deflate"){let v=(0,te.pipeline)(g,new te.PassThrough,q=>{q&&s(q)});v.once("data",q=>{(q[0]&15)===8?T=(0,te.pipeline)(T,it.default.createInflate(),O=>{O&&s(O)}):T=(0,te.pipeline)(T,it.default.createInflateRaw(),O=>{O&&s(O)}),d=new ae(T,P),i(d)}),v.once("end",()=>{d||(d=new ae(T,P),i(d))});return}if(L==="br"){T=(0,te.pipeline)(T,it.default.createBrotliDecompress(),v=>{v&&s(v)}),d=new ae(T,P),i(d);return}d=new ae(T,P),i(d)}),ko(w,o).catch(s)})}function hf(r,t){let i=Zt.Buffer.from(`0\r
\r
`),s=!1,o=!1,l;r.on("response",f=>{let{headers:m}=f;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),r.on("socket",f=>{let m=()=>{if(s&&!o){let d=new Error("Premature close");d.code="ERR_STREAM_PREMATURE_CLOSE",t(d)}},p=d=>{o=Zt.Buffer.compare(d.slice(-5),i)===0,!o&&l&&(o=Zt.Buffer.compare(l.slice(-3),i.slice(0,3))===0&&Zt.Buffer.compare(d.slice(-2),i.slice(3))===0),l=d};f.prependListener("close",m),f.on("data",p),r.on("close",()=>{f.removeListener("close",m),f.removeListener("data",p)})})}var Se=require("node:fs/promises"),Vo=require("node:fs"),er=require("node:path"),Go=require("node:stream/promises"),Qo=require("node:crypto");var ye=require("fs"),li=require("path");var be,$o=LiteLoader.plugins.NSQQ.path.data,Xt=(0,li.join)($o,"tmp/upload"),nn=(0,li.join)($o,"settings.json"),ai={qq:"",url:"localhost:2536",debug_group:0};(0,ye.existsSync)(Xt)?ui(Xt):(0,ye.mkdirSync)(Xt,{recursive:!0});if(!(0,ye.existsSync)(nn))be=ai,(0,ye.writeFileSync)(nn,JSON.stringify(ai,null,4),"utf-8");else{let r=(0,ye.readFileSync)(nn,"utf-8");be=fi(JSON.parse(r),ai),(0,ye.writeFileSync)(nn,JSON.stringify(be,null,4),"utf-8")}var Yo=()=>(0,Qo.randomBytes)(16).toString("hex"),pf=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,Ko=r=>{let t=[],i=s=>{for(let o in s)s[o]instanceof Map||(typeof s[o]!="object"&&typeof s[o]!="function"?t.push([o,s[o],s]):i(s[o]))};return i(r),t};async function Jo(r){let t=new URL(r),i,s,o;switch(t.protocol){case"https:":{let l=await rn(t);i=(0,er.basename)(t.pathname);let f=l.headers.get("Content-Disposition");if(f&&f.indexOf("attachment")!==-1){let m=pf.exec(f);m&&m[1]&&(i=m[1].replace(/['"]/g,""))}if(o=l.headers.get("Content-Type")||void 0,o&&!i.includes(".")){let m=Ho.default.getExtension(o);i+=m?"."+m:""}s=await mf(l.body,i);break}case"base64:":{let l=t.hostname+t.pathname;i=Yo()+".png",s=await _f(Buffer.from(l,"base64"),i);break}default:throw new Error(`unsupportted protocol: ${t.protocol}`)}return s}async function mf(r,t){let i=await Zo(t);return await(0,Go.finished)(r.pipe((0,Vo.createWriteStream)(i))),i}async function _f(r,t){let i=await Zo(t);return await(0,Se.writeFile)(i,r),i}async function Zo(r){return(0,er.join)(Xt,`${Yo()}-${r}`)}async function ui(r){let t=await(0,Se.readdir)(r);for(let i of t){let s=(0,er.join)(r,i);(await(0,Se.lstat)(s)).isDirectory()?(ui(s),(0,Se.rmdir)(s)):(0,Se.unlink)(s)}}function fi(r,t){let i=Object.keys(r),s=Object.keys(t);for(let o of s)i.includes(o)?typeof r[o]=="object"&&typeof t[o]=="object"&&(r[o]=fi(r[o],t[o])):r[o]=t[o];return r}var ci={},di={};function Xo(r,t,i){console.log(`\x1B[34m[uinCache]\x1B[0m ${t} -> ${i}`),!(parseInt(t)===0||parseInt(i)===0)&&(r[t]=i,r[i]=t)}function gf(r){let t={uid:"uin",uin:"uid",Uid:"Uin",Uin:"Uid",uidStr:"uinStr",uinStr:"uidStr",UidStr:"UinStr",UinStr:"UidStr"};for(let i in t)if(r.endsWith(i))return r.slice(0,-i.length)+t[i]}function ea(r){for(let[t,i,s]of Ko(r)){let o;if(o=gf(t),o&&s[o]){if(parseInt(s[o])==0||ci[i]||parseInt(i)==0)continue;Xo(ci,i,s[o])}if(t==="msgId"){if(parseInt(s[t])==0||di[i]||parseInt(i)==0)continue;Xo(di,i,s.peerUid)}}}function st(r){return ci[r]??r}function ta(r){return di[r]??r}var fl=require("node:events");var Bc=V(sa(),1),Ic=V(Ri(),1),Lc=V(Ti(),1),Li=V(Bi(),1),Wc=V(nl(),1);var Ge=require("electron");var il=V(require("crypto")),gn=new Uint8Array(256),_n=gn.length;function Wi(){return _n>gn.length-16&&(il.default.randomFillSync(gn),_n=0),gn.slice(_n,_n+=16)}var H=[];for(let r=0;r<256;++r)H.push((r+256).toString(16).slice(1));function sl(r,t=0){return H[r[t+0]]+H[r[t+1]]+H[r[t+2]]+H[r[t+3]]+"-"+H[r[t+4]]+H[r[t+5]]+"-"+H[r[t+6]]+H[r[t+7]]+"-"+H[r[t+8]]+H[r[t+9]]+"-"+H[r[t+10]]+H[r[t+11]]+H[r[t+12]]+H[r[t+13]]+H[r[t+14]]+H[r[t+15]]}var ol=V(require("crypto")),Di={randomUUID:ol.default.randomUUID};function Dc(r,t,i){if(Di.randomUUID&&!t&&!r)return Di.randomUUID();r=r||{};let s=r.random||(r.rng||Wi)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){i=i||0;for(let o=0;o<16;++o)t[i+o]=s[o];return t}return sl(s)}var qi=Dc;Ge.ipcMain.emit=Ge.ipcMain.emit.bind(Ge.ipcMain);var ne=async(r,t,i,s)=>{let o=qi(),l=await Promise.race([new Promise(f=>{Pt.set(o,f),Ge.ipcMain.emit=Ge.ipcMain.emit.bind(Ge.ipcMain),Ge.ipcMain.emit(r,{},{type:"request",callbackId:o,eventName:t},[i,...s])})]);return Pt.delete(o),l};function qc(r){return{elementType:1,elementId:"",textElement:{content:r.data.text,atType:0,atUid:"",atTinyId:"",atNtUid:""}}}function Nc(r){let t=st(r.data.qq);return{elementType:1,elementId:"",textElement:{content:"",atType:t==="all"?1:2,atUid:t==="all"?"all":t,atTinyId:"",atNtUid:t==="all"?"all":t}}}async function Fc(r){let t=await ne("IPC_UP_2","ns-FsApi-2","getFileType",[r]),i=await ne("IPC_UP_2","ns-FsApi-2","getFileMd5",[r]),s=`${i}.${t.ext}`,o=await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/getRichMediaFilePathForGuild",[{path_info:{md5HexStr:i,fileName:s,elementType:2,elementSubType:0,thumbSize:0,needCreate:!0,downloadType:1,file_uuid:""}}]);await ne("IPC_UP_2","ns-FsApi-2","copyFile",[{fromPath:r,toPath:o}]);let l=await ne("IPC_UP_2","ns-FsApi-2","getImageSizeFromPath",[r]),f=await ne("IPC_UP_2","ns-FsApi-2","getFileSize",[r]);return{md5HexStr:i,fileSize:f,picWidth:l.width,picHeight:l.height,fileName:s,sourcePath:o,original:!0,picType:1001,picSubType:0,fileUuid:"",fileSubId:"",thumbFileSize:0,summary:""}}async function Uc(r){let t=await Jo(r.data.file);return r=await Fc(t),{elementType:2,elementId:"",picElement:r}}function Mc(r){return{chatType:r.chatType=="friend"?1:r.chatType=="group"?2:1,peerUid:r.uid,guildId:""}}var bn={Text:qc,At:Nc,Peer:Mc,Image:Uc};async function al(r){let t=r.action,i=r.params;switch(t){case"get_login_info":Ie({data:{user_id:ie,nickname:""},echo:r.echo});break;case"get_guild_service_profile":Ie({data:{nickname:ie,tiny_id:"",avatar_url:""},echo:r.echo});break;case"get_online_clients":Ie({data:{clients:[]},echo:r.echo});break;case"get_version_info":Ie({data:{app_name:"NSQQ",app_version:"v1.0.0",app_full_name:"NSQQ",protocol_name:6,protocol_version:"v11",coolq_edition:"pro",coolq_directory:"","go-cqhttp":!1,plugin_version:"4.15.0",plugin_build_number:99,plugin_build_configuration:"release",runtime_version:"v1.0.0",runtime_os:"ntqq",version:"v1.0.0"},echo:r.echo});break;case"send_msg":if(be.debug_group&&be.debug_group!==i.group_id)return;let s=i.message;ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/sendMsg",[{msgId:"0",peer:{chatType:i.group_id?2:1,peerUid:i.group_id?i.group_id:st(i.user_id),guildId:""},msgElements:await Promise.all(s.map(async o=>{if(o.type=="text")return bn.Text(o);if(o.type=="at")return bn.At(o);if(o.type=="image")return await bn.Image(o)})),msgAttributeInfos:new Map},void 0]),cr.once("my_message",o=>{Ie({data:{message_id:o.msgId},echo:r.echo})});break;case"delete_msg":await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/recallMsg",[{peer:{chatType:2,peerUid:ta(i.message_id),guildId:""},msgIds:[i.message_id]}]);case"send_like":await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelProfileLikeService/setBuddyProfileLike",[{doLikeUserInfo:{friendUid:"u_4B8ETD3ySVv--pNnQAupOA",sourceId:71,doLikeCount:1,doLikeTollCount:0}},void 0]);default:break}}var jc=`ws://${be.url}/go-cqhttp`,Le,ll=null,zc=5,Ni=0;async function Fi(){return await Promise.race([new Promise(r=>{Le=new Li.default(jc),We(`\u8FDE\u63A5\u5730\u5740: ${Le.url}`),Le.on("open",()=>{if(We("WebSocket \u8FDE\u63A5\u5DF2\u5EFA\u7ACB"),Ni=0,ie!==0){let t={time:Date.now(),self_id:ie,post_type:"meta_event",meta_event_type:"lifecycle",sub_type:"enable"};Ie(t),r(!0)}}),Le.on("message",t=>{al(JSON.parse(t))}),Le.on("close",(t,i)=>{We(`WebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED\uFF0C\u4EE3\u7801: ${t}, \u539F\u56E0: ${i}`),Ni<zc?(Ni++,ll=setTimeout(()=>{We("\u5C1D\u8BD5\u91CD\u65B0\u8FDE\u63A5 WebSocket..."),Fi()},5e3)):(clearInterval(ll),We("\u8FBE\u5230\u6700\u5927\u91CD\u8FDE\u5C1D\u8BD5\u6B21\u6570\uFF0C\u505C\u6B62\u91CD\u8FDE\u3002"))}),Le.on("error",t=>{console.error(`WebSocket \u8FDE\u63A5\u51FA\u73B0\u9519\u8BEF: ${t.message}`)})})])}function Ie(r){Le.send(JSON.stringify(r))}async function ul(r){await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelGroupService/getMemberInfo",[r,void 0])}var ie=0,cr=new fl.EventEmitter;function $c(r,t){for(let i in r)if(r.hasOwnProperty(i)&&i.endsWith(t)&&r[i]!==null)return i}async function cl(r){let t=r?.[0]?.cmdName,i=r?.[0]?.payload;if(r?.account?.length>0&&ie===0){if(String(parseInt(r.account,10))!==be.qq)return;ie=parseInt(r.account,10);let s={time:Date.now(),self_id:ie,post_type:"meta_event",meta_event_type:"lifecycle",sub_type:"enable"};await Fi(),Ie(s),We(`${ie} - \u767B\u5F55\u6210\u529F`)}if(ie!==0)switch(ea(i),t){case"nodeIKernelMsgListener/onRecvMsg":let s=i.msgList[0];await ul({forceUpdate:!1,groupCode:+s.peerUid,uids:[s.senderUid]});let o={time:Date.now(),self_id:ie,post_type:"message",message_type:s.chatType===1?"private":"group",sub_type:s.chatType===1?"other":"normal",message_id:s.msgId,group_id:parseInt(s.peerUid,10),user_id:st(s.senderUid),anonymous:null,message:[],raw_message:"",font:0,sender:{user_id:st(s.senderUid),nickname:s.sendNickName,sex:"",age:0}};s.elements.forEach(f=>{switch($c(f,"Element")){case"textElement":o.raw_message+=f.textElement?.content,o.message.push({type:"text",data:{text:f.textElement?.content}});break;case"faceElement":o.message.push({type:"face",data:{id:f.faceElement?.faceIndex}});break;case"picElement":o.message.push({type:"image",data:{file:f.picElement?.sourcePath}});break}}),Le.send(JSON.stringify(o));break;case"nodeIKernelMsgListener/onAddSendMsg":let l=i.msgRecord;parseInt(l.senderUin,10)===ie&&cr.emit("my_message",l);break;case"nodeIKernelProfileListener/onProfileDetailInfoChanged":cr.emit("getUserInfo",i.info);break;default:break}}var Pt=new Map;async function Hc(r){let t=r.webContents.send,i=(s,...o)=>(Pt.has(o[0].callbackId)&&Pt.get(o[0].callbackId)?.call(o[0],o[1]),cl(o?.[1]),t.call(r.webContents,s,...o));r.webContents.send=i}function dl(r,t){if(typeof r=="object")for(let i in r)r.hasOwnProperty(i)&&(r[i]=dl(r[i],t));else typeof r=="string"&&r.length>t&&(r=r.substring(0,t-2)+"..");return r}function Vc(r,t=64){try{return r.map(i=>{if(typeof i!="object")return i;let s=JSON.parse(i);return s=dl(s,t),JSON.stringify(s)})}catch{return r}}function We(...r){console.log("\x1B[32m[NSQQ]\x1B[0m",...Vc(r))}0&&(module.exports={onBrowserWindowCreated,output,requestCallbackMap});
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
