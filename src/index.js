var qu=Object.create;var jr=Object.defineProperty;var Fu=Object.getOwnPropertyDescriptor;var Nu=Object.getOwnPropertyNames;var Uu=Object.getPrototypeOf,Mu=Object.prototype.hasOwnProperty;var jt=(r,t)=>()=>(r&&(t=r(r=0)),t);var M=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Zs=(r,t)=>{for(var i in t)jr(r,i,{get:t[i],enumerable:!0})},Xs=(r,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Nu(t))!Mu.call(r,o)&&o!==i&&jr(r,o,{get:()=>t[o],enumerable:!(s=Fu(t,o))||s.enumerable});return r};var V=(r,t,i)=>(i=r!=null?qu(Uu(r)):{},Xs(t||!r||!r.__esModule?jr(i,"default",{value:r,enumerable:!0}):i,r)),ju=r=>Xs(jr({},"__esModule",{value:!0}),r);var to=M((Yc,eo)=>{"use strict";function zr(){this._types=Object.create(null),this._extensions=Object.create(null);for(let r=0;r<arguments.length;r++)this.define(arguments[r]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}zr.prototype.define=function(r,t){for(let i in r){let s=r[i].map(function(o){return o.toLowerCase()});i=i.toLowerCase();for(let o=0;o<s.length;o++){let l=s[o];if(l[0]!=="*"){if(!t&&l in this._types)throw new Error('Attempt to change mapping for "'+l+'" extension from "'+this._types[l]+'" to "'+i+'". Pass `force=true` to allow this, otherwise remove "'+l+'" from the list of extensions for "'+i+'".');this._types[l]=i}}if(t||!this._extensions[i]){let o=s[0];this._extensions[i]=o[0]!=="*"?o:o.substr(1)}}};zr.prototype.getType=function(r){r=String(r);let t=r.replace(/^.*[/\\]/,"").toLowerCase(),i=t.replace(/^.*\./,"").toLowerCase(),s=t.length<r.length;return(i.length<t.length-1||!s)&&this._types[i]||null};zr.prototype.getExtension=function(r){return r=/^\s*([^;\s]*)/.test(r)&&RegExp.$1,r&&this._extensions[r.toLowerCase()]||null};eo.exports=zr});var no=M((Kc,ro)=>{ro.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}});var so=M((Jc,io)=>{"use strict";var zu=to();io.exports=new zu(no())});var lo=M(($r,ao)=>{(function(r,t){typeof $r=="object"&&typeof ao<"u"?t($r):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.WebStreamsPolyfill={}))})($r,function(r){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function i(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let o=s();function l(e){return typeof e=="object"&&e!==null||typeof e=="function"}let f=i,m=Promise,p=Promise.prototype.then,d=Promise.resolve.bind(m),S=Promise.reject.bind(m);function b(e){return new m(e)}function w(e){return d(e)}function y(e){return S(e)}function g(e,n,a){return p.call(e,n,a)}function R(e,n,a){g(g(e,n,a),void 0,f)}function v(e,n){R(e,n)}function P(e,n){R(e,void 0,n)}function L(e,n,a){return g(e,n,a)}function N(e){g(e,void 0,f)}let T=(()=>{let e=o&&o.queueMicrotask;if(typeof e=="function")return e;let n=w(void 0);return a=>g(n,a)})();function q(e,n,a){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,n,a)}function O(e,n,a){try{return w(q(e,n,a))}catch(u){return y(u)}}let le=16384;class ${constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(n){let a=this._back,u=a;a._elements.length===le-1&&(u={_elements:[],_next:void 0}),a._elements.push(n),u!==a&&(this._back=u,a._next=u),++this._size}shift(){let n=this._front,a=n,u=this._cursor,c=u+1,h=n._elements,_=h[u];return c===le&&(a=n._next,c=0),--this._size,this._cursor=c,n!==a&&(this._front=a),h[u]=void 0,_}forEach(n){let a=this._cursor,u=this._front,c=u._elements;for(;(a!==c.length||u._next!==void 0)&&!(a===c.length&&(u=u._next,c=u._elements,a=0,c.length===0));)n(c[a]),++a}peek(){let n=this._front,a=this._cursor;return n._elements[a]}}function ur(e,n){e._ownerReadableStream=n,n._reader=e,n._state==="readable"?yn(e):n._state==="closed"?dl(e):Fi(e,n._storedError)}function bn(e,n){let a=e._ownerReadableStream;return ce(a,n)}function Se(e){e._ownerReadableStream._state==="readable"?Sn(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):hl(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function at(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function yn(e){e._closedPromise=b((n,a)=>{e._closedPromise_resolve=n,e._closedPromise_reject=a})}function Fi(e,n){yn(e),Sn(e,n)}function dl(e){yn(e),Ni(e)}function Sn(e,n){e._closedPromise_reject!==void 0&&(N(e._closedPromise),e._closedPromise_reject(n),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function hl(e,n){Fi(e,n)}function Ni(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Ui=t("[[AbortSteps]]"),Mi=t("[[ErrorSteps]]"),wn=t("[[CancelSteps]]"),xn=t("[[PullSteps]]"),ji=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},pl=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function ml(e){return typeof e=="object"||typeof e=="function"}function we(e,n){if(e!==void 0&&!ml(e))throw new TypeError(`${n} is not an object.`)}function ue(e,n){if(typeof e!="function")throw new TypeError(`${n} is not a function.`)}function _l(e){return typeof e=="object"&&e!==null||typeof e=="function"}function zi(e,n){if(!_l(e))throw new TypeError(`${n} is not an object.`)}function xe(e,n,a){if(e===void 0)throw new TypeError(`Parameter ${n} is required in '${a}'.`)}function Rn(e,n,a){if(e===void 0)throw new TypeError(`${n} is required in '${a}'.`)}function En(e){return Number(e)}function $i(e){return e===0?0:e}function gl(e){return $i(pl(e))}function Hi(e,n){let u=Number.MAX_SAFE_INTEGER,c=Number(e);if(c=$i(c),!ji(c))throw new TypeError(`${n} is not a finite number`);if(c=gl(c),c<0||c>u)throw new TypeError(`${n} is outside the accepted range of 0 to ${u}, inclusive`);return!ji(c)||c===0?0:c}function vn(e,n){if(!Fe(e))throw new TypeError(`${n} is not a ReadableStream.`)}function lt(e){return new Ct(e)}function Vi(e,n){e._reader._readRequests.push(n)}function Tn(e,n,a){let c=e._reader._readRequests.shift();a?c._closeSteps():c._chunkSteps(n)}function fr(e){return e._reader._readRequests.length}function Gi(e){let n=e._reader;return!(n===void 0||!Le(n))}class Ct{constructor(n){if(xe(n,1,"ReadableStreamDefaultReader"),vn(n,"First parameter"),Ne(n))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ur(this,n),this._readRequests=new $}get closed(){return Le(this)?this._closedPromise:y(cr("closed"))}cancel(n=void 0){return Le(this)?this._ownerReadableStream===void 0?y(at("cancel")):bn(this,n):y(cr("cancel"))}read(){if(!Le(this))return y(cr("read"));if(this._ownerReadableStream===void 0)return y(at("read from"));let n,a,u=b((h,_)=>{n=h,a=_});return Pt(this,{_chunkSteps:h=>n({value:h,done:!1}),_closeSteps:()=>n({value:void 0,done:!0}),_errorSteps:h=>a(h)}),u}releaseLock(){if(!Le(this))throw cr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Se(this)}}}Object.defineProperties(Ct.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ct.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Le(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Ct}function Pt(e,n){let a=e._ownerReadableStream;a._disturbed=!0,a._state==="closed"?n._closeSteps():a._state==="errored"?n._errorSteps(a._storedError):a._readableStreamController[xn](n)}function cr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Qi=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Yi{constructor(n,a){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=n,this._preventCancel=a}next(){let n=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?L(this._ongoingPromise,n,n):n(),this._ongoingPromise}return(n){let a=()=>this._returnSteps(n);return this._ongoingPromise?L(this._ongoingPromise,a,a):a()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let n=this._reader;if(n._ownerReadableStream===void 0)return y(at("iterate"));let a,u,c=b((_,x)=>{a=_,u=x});return Pt(n,{_chunkSteps:_=>{this._ongoingPromise=void 0,T(()=>a({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Se(n),a({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,Se(n),u(_)}}),c}_returnSteps(n){if(this._isFinished)return Promise.resolve({value:n,done:!0});this._isFinished=!0;let a=this._reader;if(a._ownerReadableStream===void 0)return y(at("finish iterating"));if(!this._preventCancel){let u=bn(a,n);return Se(a),L(u,()=>({value:n,done:!0}))}return Se(a),w({value:n,done:!0})}}let Ki={next(){return Ji(this)?this._asyncIteratorImpl.next():y(Zi("next"))},return(e){return Ji(this)?this._asyncIteratorImpl.return(e):y(Zi("return"))}};Qi!==void 0&&Object.setPrototypeOf(Ki,Qi);function bl(e,n){let a=lt(e),u=new Yi(a,n),c=Object.create(Ki);return c._asyncIteratorImpl=u,c}function Ji(e){if(!l(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Yi}catch{return!1}}function Zi(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Xi=Number.isNaN||function(e){return e!==e};function kt(e){return e.slice()}function es(e,n,a,u,c){new Uint8Array(e).set(new Uint8Array(a,u,c),n)}function Gc(e){return e}function dr(e){return!1}function ts(e,n,a){if(e.slice)return e.slice(n,a);let u=a-n,c=new ArrayBuffer(u);return es(c,0,e,n,u),c}function yl(e){return!(typeof e!="number"||Xi(e)||e<0)}function rs(e){let n=ts(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(n)}function Cn(e){let n=e._queue.shift();return e._queueTotalSize-=n.size,e._queueTotalSize<0&&(e._queueTotalSize=0),n.value}function Pn(e,n,a){if(!yl(a)||a===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:n,size:a}),e._queueTotalSize+=a}function Sl(e){return e._queue.peek().value}function We(e){e._queue=new $,e._queueTotalSize=0}class At{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!kn(this))throw In("view");return this._view}respond(n){if(!kn(this))throw In("respond");if(xe(n,1,"respond"),n=Hi(n,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");dr(this._view.buffer),gr(this._associatedReadableByteStreamController,n)}respondWithNewView(n){if(!kn(this))throw In("respondWithNewView");if(xe(n,1,"respondWithNewView"),!ArrayBuffer.isView(n))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");dr(n.buffer),br(this._associatedReadableByteStreamController,n)}}Object.defineProperties(At.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(At.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ut{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ve(this))throw Bt("byobRequest");return Bn(this)}get desiredSize(){if(!Ve(this))throw Bt("desiredSize");return fs(this)}close(){if(!Ve(this))throw Bt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let n=this._controlledReadableByteStream._state;if(n!=="readable")throw new TypeError(`The stream (in ${n} state) is not in the readable state and cannot be closed`);Ot(this)}enqueue(n){if(!Ve(this))throw Bt("enqueue");if(xe(n,1,"enqueue"),!ArrayBuffer.isView(n))throw new TypeError("chunk must be an array buffer view");if(n.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(n.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let a=this._controlledReadableByteStream._state;if(a!=="readable")throw new TypeError(`The stream (in ${a} state) is not in the readable state and cannot be enqueued to`);_r(this,n)}error(n=void 0){if(!Ve(this))throw Bt("error");fe(this,n)}[wn](n){ns(this),We(this);let a=this._cancelAlgorithm(n);return mr(this),a}[xn](n){let a=this._controlledReadableByteStream;if(this._queueTotalSize>0){let c=this._queue.shift();this._queueTotalSize-=c.byteLength,as(this);let h=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);n._chunkSteps(h);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let c;try{c=new ArrayBuffer(u)}catch(_){n._errorSteps(_);return}let h={buffer:c,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(h)}Vi(a,n),Ge(this)}}Object.defineProperties(ut.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ut.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ve(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof ut}function kn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof At}function Ge(e){if(!El(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let a=e._pullAlgorithm();R(a,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ge(e))},u=>{fe(e,u)})}function ns(e){On(e),e._pendingPullIntos=new $}function An(e,n){let a=!1;e._state==="closed"&&(a=!0);let u=is(n);n.readerType==="default"?Tn(e,u,a):Cl(e,u,a)}function is(e){let n=e.bytesFilled,a=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,n/a)}function hr(e,n,a,u){e._queue.push({buffer:n,byteOffset:a,byteLength:u}),e._queueTotalSize+=u}function ss(e,n){let a=n.elementSize,u=n.bytesFilled-n.bytesFilled%a,c=Math.min(e._queueTotalSize,n.byteLength-n.bytesFilled),h=n.bytesFilled+c,_=h-h%a,x=c,C=!1;_>u&&(x=_-n.bytesFilled,C=!0);let A=e._queue;for(;x>0;){let B=A.peek(),I=Math.min(x,B.byteLength),U=n.byteOffset+n.bytesFilled;es(n.buffer,U,B.buffer,B.byteOffset,I),B.byteLength===I?A.shift():(B.byteOffset+=I,B.byteLength-=I),e._queueTotalSize-=I,os(e,I,n),x-=I}return C}function os(e,n,a){a.bytesFilled+=n}function as(e){e._queueTotalSize===0&&e._closeRequested?(mr(e),Ut(e._controlledReadableByteStream)):Ge(e)}function On(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ls(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let n=e._pendingPullIntos.peek();ss(e,n)&&(pr(e),An(e._controlledReadableByteStream,n))}}function wl(e,n,a){let u=e._controlledReadableByteStream,c=1;n.constructor!==DataView&&(c=n.constructor.BYTES_PER_ELEMENT);let h=n.constructor,_=n.buffer,x={buffer:_,bufferByteLength:_.byteLength,byteOffset:n.byteOffset,byteLength:n.byteLength,bytesFilled:0,elementSize:c,viewConstructor:h,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(x),hs(u,a);return}if(u._state==="closed"){let C=new h(x.buffer,x.byteOffset,0);a._closeSteps(C);return}if(e._queueTotalSize>0){if(ss(e,x)){let C=is(x);as(e),a._chunkSteps(C);return}if(e._closeRequested){let C=new TypeError("Insufficient bytes to fill elements in the given buffer");fe(e,C),a._errorSteps(C);return}}e._pendingPullIntos.push(x),hs(u,a),Ge(e)}function xl(e,n){let a=e._controlledReadableByteStream;if(Ln(a))for(;ps(a)>0;){let u=pr(e);An(a,u)}}function Rl(e,n,a){if(os(e,n,a),a.bytesFilled<a.elementSize)return;pr(e);let u=a.bytesFilled%a.elementSize;if(u>0){let c=a.byteOffset+a.bytesFilled,h=ts(a.buffer,c-u,c);hr(e,h,0,h.byteLength)}a.bytesFilled-=u,An(e._controlledReadableByteStream,a),ls(e)}function us(e,n){let a=e._pendingPullIntos.peek();On(e),e._controlledReadableByteStream._state==="closed"?xl(e):Rl(e,n,a),Ge(e)}function pr(e){return e._pendingPullIntos.shift()}function El(e){let n=e._controlledReadableByteStream;return n._state!=="readable"||e._closeRequested||!e._started?!1:!!(Gi(n)&&fr(n)>0||Ln(n)&&ps(n)>0||fs(e)>0)}function mr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ot(e){let n=e._controlledReadableByteStream;if(!(e._closeRequested||n._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw fe(e,u),u}mr(e),Ut(n)}}function _r(e,n){let a=e._controlledReadableByteStream;if(e._closeRequested||a._state!=="readable")return;let u=n.buffer,c=n.byteOffset,h=n.byteLength,_=u;if(e._pendingPullIntos.length>0){let x=e._pendingPullIntos.peek();dr(x.buffer),x.buffer=x.buffer}if(On(e),Gi(a))if(fr(a)===0)hr(e,_,c,h);else{e._pendingPullIntos.length>0&&pr(e);let x=new Uint8Array(_,c,h);Tn(a,x,!1)}else Ln(a)?(hr(e,_,c,h),ls(e)):hr(e,_,c,h);Ge(e)}function fe(e,n){let a=e._controlledReadableByteStream;a._state==="readable"&&(ns(e),We(e),mr(e),Fs(a,n))}function Bn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let n=e._pendingPullIntos.peek(),a=new Uint8Array(n.buffer,n.byteOffset+n.bytesFilled,n.byteLength-n.bytesFilled),u=Object.create(At.prototype);Tl(u,e,a),e._byobRequest=u}return e._byobRequest}function fs(e){let n=e._controlledReadableByteStream._state;return n==="errored"?null:n==="closed"?0:e._strategyHWM-e._queueTotalSize}function gr(e,n){let a=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(n!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(n===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(a.bytesFilled+n>a.byteLength)throw new RangeError("bytesWritten out of range")}a.buffer=a.buffer,us(e,n)}function br(e,n){let a=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(n.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(n.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(a.byteOffset+a.bytesFilled!==n.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(a.bufferByteLength!==n.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(a.bytesFilled+n.byteLength>a.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let c=n.byteLength;a.buffer=n.buffer,us(e,c)}function cs(e,n,a,u,c,h,_){n._controlledReadableByteStream=e,n._pullAgain=!1,n._pulling=!1,n._byobRequest=null,n._queue=n._queueTotalSize=void 0,We(n),n._closeRequested=!1,n._started=!1,n._strategyHWM=h,n._pullAlgorithm=u,n._cancelAlgorithm=c,n._autoAllocateChunkSize=_,n._pendingPullIntos=new $,e._readableStreamController=n;let x=a();R(w(x),()=>{n._started=!0,Ge(n)},C=>{fe(n,C)})}function vl(e,n,a){let u=Object.create(ut.prototype),c=()=>{},h=()=>w(void 0),_=()=>w(void 0);n.start!==void 0&&(c=()=>n.start(u)),n.pull!==void 0&&(h=()=>n.pull(u)),n.cancel!==void 0&&(_=C=>n.cancel(C));let x=n.autoAllocateChunkSize;if(x===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");cs(e,u,c,h,_,a,x)}function Tl(e,n,a){e._associatedReadableByteStreamController=n,e._view=a}function In(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Bt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function ds(e){return new It(e)}function hs(e,n){e._reader._readIntoRequests.push(n)}function Cl(e,n,a){let c=e._reader._readIntoRequests.shift();a?c._closeSteps(n):c._chunkSteps(n)}function ps(e){return e._reader._readIntoRequests.length}function Ln(e){let n=e._reader;return!(n===void 0||!Qe(n))}class It{constructor(n){if(xe(n,1,"ReadableStreamBYOBReader"),vn(n,"First parameter"),Ne(n))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ve(n._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ur(this,n),this._readIntoRequests=new $}get closed(){return Qe(this)?this._closedPromise:y(yr("closed"))}cancel(n=void 0){return Qe(this)?this._ownerReadableStream===void 0?y(at("cancel")):bn(this,n):y(yr("cancel"))}read(n){if(!Qe(this))return y(yr("read"));if(!ArrayBuffer.isView(n))return y(new TypeError("view must be an array buffer view"));if(n.byteLength===0)return y(new TypeError("view must have non-zero byteLength"));if(n.buffer.byteLength===0)return y(new TypeError("view's buffer must have non-zero byteLength"));if(dr(n.buffer),this._ownerReadableStream===void 0)return y(at("read from"));let a,u,c=b((_,x)=>{a=_,u=x});return ms(this,n,{_chunkSteps:_=>a({value:_,done:!1}),_closeSteps:_=>a({value:_,done:!0}),_errorSteps:_=>u(_)}),c}releaseLock(){if(!Qe(this))throw yr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Se(this)}}}Object.defineProperties(It.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(It.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Qe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof It}function ms(e,n,a){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?a._errorSteps(u._storedError):wl(u._readableStreamController,n,a)}function yr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Lt(e,n){let{highWaterMark:a}=e;if(a===void 0)return n;if(Xi(a)||a<0)throw new RangeError("Invalid highWaterMark");return a}function Sr(e){let{size:n}=e;return n||(()=>1)}function wr(e,n){we(e,n);let a=e?.highWaterMark,u=e?.size;return{highWaterMark:a===void 0?void 0:En(a),size:u===void 0?void 0:Pl(u,`${n} has member 'size' that`)}}function Pl(e,n){return ue(e,n),a=>En(e(a))}function kl(e,n){we(e,n);let a=e?.abort,u=e?.close,c=e?.start,h=e?.type,_=e?.write;return{abort:a===void 0?void 0:Al(a,e,`${n} has member 'abort' that`),close:u===void 0?void 0:Ol(u,e,`${n} has member 'close' that`),start:c===void 0?void 0:Bl(c,e,`${n} has member 'start' that`),write:_===void 0?void 0:Il(_,e,`${n} has member 'write' that`),type:h}}function Al(e,n,a){return ue(e,a),u=>O(e,n,[u])}function Ol(e,n,a){return ue(e,a),()=>O(e,n,[])}function Bl(e,n,a){return ue(e,a),u=>q(e,n,[u])}function Il(e,n,a){return ue(e,a),(u,c)=>O(e,n,[u,c])}function _s(e,n){if(!ft(e))throw new TypeError(`${n} is not a WritableStream.`)}function Ll(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Wl=typeof AbortController=="function";function Dl(){if(Wl)return new AbortController}class Wt{constructor(n={},a={}){n===void 0?n=null:zi(n,"First parameter");let u=wr(a,"Second parameter"),c=kl(n,"First parameter");if(bs(this),c.type!==void 0)throw new RangeError("Invalid type is specified");let _=Sr(u),x=Lt(u,1);Kl(this,c,x,_)}get locked(){if(!ft(this))throw Tr("locked");return ct(this)}abort(n=void 0){return ft(this)?ct(this)?y(new TypeError("Cannot abort a stream that already has a writer")):xr(this,n):y(Tr("abort"))}close(){return ft(this)?ct(this)?y(new TypeError("Cannot close a stream that already has a writer")):me(this)?y(new TypeError("Cannot close an already-closing stream")):ys(this):y(Tr("close"))}getWriter(){if(!ft(this))throw Tr("getWriter");return gs(this)}}Object.defineProperties(Wt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Wt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function gs(e){return new Dt(e)}function ql(e,n,a,u,c=1,h=()=>1){let _=Object.create(Wt.prototype);bs(_);let x=Object.create(dt.prototype);return vs(_,x,e,n,a,u,c,h),_}function bs(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new $,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function ft(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Wt}function ct(e){return e._writer!==void 0}function xr(e,n){var a;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=n,(a=e._writableStreamController._abortController)===null||a===void 0||a.abort();let u=e._state;if(u==="closed"||u==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let c=!1;u==="erroring"&&(c=!0,n=void 0);let h=b((_,x)=>{e._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:x,_reason:n,_wasAlreadyErroring:c}});return e._pendingAbortRequest._promise=h,c||Dn(e,n),h}function ys(e){let n=e._state;if(n==="closed"||n==="errored")return y(new TypeError(`The stream (in ${n} state) is not in the writable state and cannot be closed`));let a=b((c,h)=>{let _={_resolve:c,_reject:h};e._closeRequest=_}),u=e._writer;return u!==void 0&&e._backpressure&&n==="writable"&&Hn(u),Jl(e._writableStreamController),a}function Fl(e){return b((a,u)=>{let c={_resolve:a,_reject:u};e._writeRequests.push(c)})}function Wn(e,n){if(e._state==="writable"){Dn(e,n);return}qn(e)}function Dn(e,n){let a=e._writableStreamController;e._state="erroring",e._storedError=n;let u=e._writer;u!==void 0&&ws(u,n),!zl(e)&&a._started&&qn(e)}function qn(e){e._state="errored",e._writableStreamController[Mi]();let n=e._storedError;if(e._writeRequests.forEach(c=>{c._reject(n)}),e._writeRequests=new $,e._pendingAbortRequest===void 0){Rr(e);return}let a=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,a._wasAlreadyErroring){a._reject(n),Rr(e);return}let u=e._writableStreamController[Ui](a._reason);R(u,()=>{a._resolve(),Rr(e)},c=>{a._reject(c),Rr(e)})}function Nl(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Ul(e,n){e._inFlightWriteRequest._reject(n),e._inFlightWriteRequest=void 0,Wn(e,n)}function Ml(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let a=e._writer;a!==void 0&&ks(a)}function jl(e,n){e._inFlightCloseRequest._reject(n),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(n),e._pendingAbortRequest=void 0),Wn(e,n)}function me(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function zl(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function $l(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Hl(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Rr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let n=e._writer;n!==void 0&&zn(n,e._storedError)}function Fn(e,n){let a=e._writer;a!==void 0&&n!==e._backpressure&&(n?iu(a):Hn(a)),e._backpressure=n}class Dt{constructor(n){if(xe(n,1,"WritableStreamDefaultWriter"),_s(n,"First parameter"),ct(n))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=n,n._writer=this;let a=n._state;if(a==="writable")!me(n)&&n._backpressure?Pr(this):As(this),Cr(this);else if(a==="erroring")$n(this,n._storedError),Cr(this);else if(a==="closed")As(this),ru(this);else{let u=n._storedError;$n(this,u),Ps(this,u)}}get closed(){return Ye(this)?this._closedPromise:y(Ke("closed"))}get desiredSize(){if(!Ye(this))throw Ke("desiredSize");if(this._ownerWritableStream===void 0)throw qt("desiredSize");return Yl(this)}get ready(){return Ye(this)?this._readyPromise:y(Ke("ready"))}abort(n=void 0){return Ye(this)?this._ownerWritableStream===void 0?y(qt("abort")):Vl(this,n):y(Ke("abort"))}close(){if(!Ye(this))return y(Ke("close"));let n=this._ownerWritableStream;return n===void 0?y(qt("close")):me(n)?y(new TypeError("Cannot close an already-closing stream")):Ss(this)}releaseLock(){if(!Ye(this))throw Ke("releaseLock");this._ownerWritableStream!==void 0&&xs(this)}write(n=void 0){return Ye(this)?this._ownerWritableStream===void 0?y(qt("write to")):Rs(this,n):y(Ke("write"))}}Object.defineProperties(Dt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Dt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ye(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Dt}function Vl(e,n){let a=e._ownerWritableStream;return xr(a,n)}function Ss(e){let n=e._ownerWritableStream;return ys(n)}function Gl(e){let n=e._ownerWritableStream,a=n._state;return me(n)||a==="closed"?w(void 0):a==="errored"?y(n._storedError):Ss(e)}function Ql(e,n){e._closedPromiseState==="pending"?zn(e,n):nu(e,n)}function ws(e,n){e._readyPromiseState==="pending"?Os(e,n):su(e,n)}function Yl(e){let n=e._ownerWritableStream,a=n._state;return a==="errored"||a==="erroring"?null:a==="closed"?0:Ts(n._writableStreamController)}function xs(e){let n=e._ownerWritableStream,a=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ws(e,a),Ql(e,a),n._writer=void 0,e._ownerWritableStream=void 0}function Rs(e,n){let a=e._ownerWritableStream,u=a._writableStreamController,c=Zl(u,n);if(a!==e._ownerWritableStream)return y(qt("write to"));let h=a._state;if(h==="errored")return y(a._storedError);if(me(a)||h==="closed")return y(new TypeError("The stream is closing or closed and cannot be written to"));if(h==="erroring")return y(a._storedError);let _=Fl(a);return Xl(u,n,c),_}let Es={};class dt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Nn(this))throw jn("abortReason");return this._abortReason}get signal(){if(!Nn(this))throw jn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(n=void 0){if(!Nn(this))throw jn("error");this._controlledWritableStream._state==="writable"&&Cs(this,n)}[Ui](n){let a=this._abortAlgorithm(n);return Er(this),a}[Mi](){We(this)}}Object.defineProperties(dt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(dt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Nn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof dt}function vs(e,n,a,u,c,h,_,x){n._controlledWritableStream=e,e._writableStreamController=n,n._queue=void 0,n._queueTotalSize=void 0,We(n),n._abortReason=void 0,n._abortController=Dl(),n._started=!1,n._strategySizeAlgorithm=x,n._strategyHWM=_,n._writeAlgorithm=u,n._closeAlgorithm=c,n._abortAlgorithm=h;let C=Mn(n);Fn(e,C);let A=a(),B=w(A);R(B,()=>{n._started=!0,vr(n)},I=>{n._started=!0,Wn(e,I)})}function Kl(e,n,a,u){let c=Object.create(dt.prototype),h=()=>{},_=()=>w(void 0),x=()=>w(void 0),C=()=>w(void 0);n.start!==void 0&&(h=()=>n.start(c)),n.write!==void 0&&(_=A=>n.write(A,c)),n.close!==void 0&&(x=()=>n.close()),n.abort!==void 0&&(C=A=>n.abort(A)),vs(e,c,h,_,x,C,a,u)}function Er(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Jl(e){Pn(e,Es,0),vr(e)}function Zl(e,n){try{return e._strategySizeAlgorithm(n)}catch(a){return Un(e,a),1}}function Ts(e){return e._strategyHWM-e._queueTotalSize}function Xl(e,n,a){try{Pn(e,n,a)}catch(c){Un(e,c);return}let u=e._controlledWritableStream;if(!me(u)&&u._state==="writable"){let c=Mn(e);Fn(u,c)}vr(e)}function vr(e){let n=e._controlledWritableStream;if(!e._started||n._inFlightWriteRequest!==void 0)return;if(n._state==="erroring"){qn(n);return}if(e._queue.length===0)return;let u=Sl(e);u===Es?eu(e):tu(e,u)}function Un(e,n){e._controlledWritableStream._state==="writable"&&Cs(e,n)}function eu(e){let n=e._controlledWritableStream;$l(n),Cn(e);let a=e._closeAlgorithm();Er(e),R(a,()=>{Ml(n)},u=>{jl(n,u)})}function tu(e,n){let a=e._controlledWritableStream;Hl(a);let u=e._writeAlgorithm(n);R(u,()=>{Nl(a);let c=a._state;if(Cn(e),!me(a)&&c==="writable"){let h=Mn(e);Fn(a,h)}vr(e)},c=>{a._state==="writable"&&Er(e),Ul(a,c)})}function Mn(e){return Ts(e)<=0}function Cs(e,n){let a=e._controlledWritableStream;Er(e),Dn(a,n)}function Tr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function jn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Ke(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function qt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Cr(e){e._closedPromise=b((n,a)=>{e._closedPromise_resolve=n,e._closedPromise_reject=a,e._closedPromiseState="pending"})}function Ps(e,n){Cr(e),zn(e,n)}function ru(e){Cr(e),ks(e)}function zn(e,n){e._closedPromise_reject!==void 0&&(N(e._closedPromise),e._closedPromise_reject(n),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function nu(e,n){Ps(e,n)}function ks(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Pr(e){e._readyPromise=b((n,a)=>{e._readyPromise_resolve=n,e._readyPromise_reject=a}),e._readyPromiseState="pending"}function $n(e,n){Pr(e),Os(e,n)}function As(e){Pr(e),Hn(e)}function Os(e,n){e._readyPromise_reject!==void 0&&(N(e._readyPromise),e._readyPromise_reject(n),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function iu(e){Pr(e)}function su(e,n){$n(e,n)}function Hn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Bs=typeof DOMException<"u"?DOMException:void 0;function ou(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function au(){let e=function(a,u){this.message=a||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let lu=ou(Bs)?Bs:au();function Is(e,n,a,u,c,h){let _=lt(e),x=gs(n);e._disturbed=!0;let C=!1,A=w(void 0);return b((B,I)=>{let U;if(h!==void 0){if(U=()=>{let E=new lu("Aborted","AbortError"),k=[];u||k.push(()=>n._state==="writable"?xr(n,E):w(void 0)),c||k.push(()=>e._state==="readable"?ce(e,E):w(void 0)),Y(()=>Promise.all(k.map(W=>W())),!0,E)},h.aborted){U();return}h.addEventListener("abort",U)}function de(){return b((E,k)=>{function W(Z){Z?E():g(mt(),W,k)}W(!1)})}function mt(){return C?w(!0):g(x._readyPromise,()=>b((E,k)=>{Pt(_,{_chunkSteps:W=>{A=g(Rs(x,W),void 0,i),E(!1)},_closeSteps:()=>E(!0),_errorSteps:k})}))}if(Re(e,_._closedPromise,E=>{u?se(!0,E):Y(()=>xr(n,E),!0,E)}),Re(n,x._closedPromise,E=>{c?se(!0,E):Y(()=>ce(e,E),!0,E)}),Q(e,_._closedPromise,()=>{a?se():Y(()=>Gl(x))}),me(n)||n._state==="closed"){let E=new TypeError("the destination writable stream closed before all data could be piped to it");c?se(!0,E):Y(()=>ce(e,E),!0,E)}N(de());function Ue(){let E=A;return g(A,()=>E!==A?Ue():void 0)}function Re(E,k,W){E._state==="errored"?W(E._storedError):P(k,W)}function Q(E,k,W){E._state==="closed"?W():v(k,W)}function Y(E,k,W){if(C)return;C=!0,n._state==="writable"&&!me(n)?v(Ue(),Z):Z();function Z(){R(E(),()=>Ee(k,W),_t=>Ee(!0,_t))}}function se(E,k){C||(C=!0,n._state==="writable"&&!me(n)?v(Ue(),()=>Ee(E,k)):Ee(E,k))}function Ee(E,k){xs(x),Se(_),h!==void 0&&h.removeEventListener("abort",U),E?I(k):B(void 0)}})}class ht{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!kr(this))throw Br("desiredSize");return Vn(this)}close(){if(!kr(this))throw Br("close");if(!pt(this))throw new TypeError("The stream is not in a state that permits close");Nt(this)}enqueue(n=void 0){if(!kr(this))throw Br("enqueue");if(!pt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Or(this,n)}error(n=void 0){if(!kr(this))throw Br("error");De(this,n)}[wn](n){We(this);let a=this._cancelAlgorithm(n);return Ar(this),a}[xn](n){let a=this._controlledReadableStream;if(this._queue.length>0){let u=Cn(this);this._closeRequested&&this._queue.length===0?(Ar(this),Ut(a)):Ft(this),n._chunkSteps(u)}else Vi(a,n),Ft(this)}}Object.defineProperties(ht.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function kr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof ht}function Ft(e){if(!Ls(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let a=e._pullAlgorithm();R(a,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ft(e))},u=>{De(e,u)})}function Ls(e){let n=e._controlledReadableStream;return!pt(e)||!e._started?!1:!!(Ne(n)&&fr(n)>0||Vn(e)>0)}function Ar(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Nt(e){if(!pt(e))return;let n=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Ar(e),Ut(n))}function Or(e,n){if(!pt(e))return;let a=e._controlledReadableStream;if(Ne(a)&&fr(a)>0)Tn(a,n,!1);else{let u;try{u=e._strategySizeAlgorithm(n)}catch(c){throw De(e,c),c}try{Pn(e,n,u)}catch(c){throw De(e,c),c}}Ft(e)}function De(e,n){let a=e._controlledReadableStream;a._state==="readable"&&(We(e),Ar(e),Fs(a,n))}function Vn(e){let n=e._controlledReadableStream._state;return n==="errored"?null:n==="closed"?0:e._strategyHWM-e._queueTotalSize}function uu(e){return!Ls(e)}function pt(e){let n=e._controlledReadableStream._state;return!e._closeRequested&&n==="readable"}function Ws(e,n,a,u,c,h,_){n._controlledReadableStream=e,n._queue=void 0,n._queueTotalSize=void 0,We(n),n._started=!1,n._closeRequested=!1,n._pullAgain=!1,n._pulling=!1,n._strategySizeAlgorithm=_,n._strategyHWM=h,n._pullAlgorithm=u,n._cancelAlgorithm=c,e._readableStreamController=n;let x=a();R(w(x),()=>{n._started=!0,Ft(n)},C=>{De(n,C)})}function fu(e,n,a,u){let c=Object.create(ht.prototype),h=()=>{},_=()=>w(void 0),x=()=>w(void 0);n.start!==void 0&&(h=()=>n.start(c)),n.pull!==void 0&&(_=()=>n.pull(c)),n.cancel!==void 0&&(x=C=>n.cancel(C)),Ws(e,c,h,_,x,a,u)}function Br(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function cu(e,n){return Ve(e._readableStreamController)?hu(e):du(e)}function du(e,n){let a=lt(e),u=!1,c=!1,h=!1,_=!1,x,C,A,B,I,U=b(Q=>{I=Q});function de(){return u?(c=!0,w(void 0)):(u=!0,Pt(a,{_chunkSteps:Y=>{T(()=>{c=!1;let se=Y,Ee=Y;h||Or(A._readableStreamController,se),_||Or(B._readableStreamController,Ee),u=!1,c&&de()})},_closeSteps:()=>{u=!1,h||Nt(A._readableStreamController),_||Nt(B._readableStreamController),(!h||!_)&&I(void 0)},_errorSteps:()=>{u=!1}}),w(void 0))}function mt(Q){if(h=!0,x=Q,_){let Y=kt([x,C]),se=ce(e,Y);I(se)}return U}function Ue(Q){if(_=!0,C=Q,h){let Y=kt([x,C]),se=ce(e,Y);I(se)}return U}function Re(){}return A=Gn(Re,de,mt),B=Gn(Re,de,Ue),P(a._closedPromise,Q=>{De(A._readableStreamController,Q),De(B._readableStreamController,Q),(!h||!_)&&I(void 0)}),[A,B]}function hu(e){let n=lt(e),a=!1,u=!1,c=!1,h=!1,_=!1,x,C,A,B,I,U=b(E=>{I=E});function de(E){P(E._closedPromise,k=>{E===n&&(fe(A._readableStreamController,k),fe(B._readableStreamController,k),(!h||!_)&&I(void 0))})}function mt(){Qe(n)&&(Se(n),n=lt(e),de(n)),Pt(n,{_chunkSteps:k=>{T(()=>{u=!1,c=!1;let W=k,Z=k;if(!h&&!_)try{Z=rs(k)}catch(_t){fe(A._readableStreamController,_t),fe(B._readableStreamController,_t),I(ce(e,_t));return}h||_r(A._readableStreamController,W),_||_r(B._readableStreamController,Z),a=!1,u?Re():c&&Q()})},_closeSteps:()=>{a=!1,h||Ot(A._readableStreamController),_||Ot(B._readableStreamController),A._readableStreamController._pendingPullIntos.length>0&&gr(A._readableStreamController,0),B._readableStreamController._pendingPullIntos.length>0&&gr(B._readableStreamController,0),(!h||!_)&&I(void 0)},_errorSteps:()=>{a=!1}})}function Ue(E,k){Le(n)&&(Se(n),n=ds(e),de(n));let W=k?B:A,Z=k?A:B;ms(n,E,{_chunkSteps:gt=>{T(()=>{u=!1,c=!1;let bt=k?_:h;if(k?h:_)bt||br(W._readableStreamController,gt);else{let Js;try{Js=rs(gt)}catch(Yn){fe(W._readableStreamController,Yn),fe(Z._readableStreamController,Yn),I(ce(e,Yn));return}bt||br(W._readableStreamController,gt),_r(Z._readableStreamController,Js)}a=!1,u?Re():c&&Q()})},_closeSteps:gt=>{a=!1;let bt=k?_:h,Mr=k?h:_;bt||Ot(W._readableStreamController),Mr||Ot(Z._readableStreamController),gt!==void 0&&(bt||br(W._readableStreamController,gt),!Mr&&Z._readableStreamController._pendingPullIntos.length>0&&gr(Z._readableStreamController,0)),(!bt||!Mr)&&I(void 0)},_errorSteps:()=>{a=!1}})}function Re(){if(a)return u=!0,w(void 0);a=!0;let E=Bn(A._readableStreamController);return E===null?mt():Ue(E._view,!1),w(void 0)}function Q(){if(a)return c=!0,w(void 0);a=!0;let E=Bn(B._readableStreamController);return E===null?mt():Ue(E._view,!0),w(void 0)}function Y(E){if(h=!0,x=E,_){let k=kt([x,C]),W=ce(e,k);I(W)}return U}function se(E){if(_=!0,C=E,h){let k=kt([x,C]),W=ce(e,k);I(W)}return U}function Ee(){}return A=qs(Ee,Re,Y),B=qs(Ee,Q,se),de(n),[A,B]}function pu(e,n){we(e,n);let a=e,u=a?.autoAllocateChunkSize,c=a?.cancel,h=a?.pull,_=a?.start,x=a?.type;return{autoAllocateChunkSize:u===void 0?void 0:Hi(u,`${n} has member 'autoAllocateChunkSize' that`),cancel:c===void 0?void 0:mu(c,a,`${n} has member 'cancel' that`),pull:h===void 0?void 0:_u(h,a,`${n} has member 'pull' that`),start:_===void 0?void 0:gu(_,a,`${n} has member 'start' that`),type:x===void 0?void 0:bu(x,`${n} has member 'type' that`)}}function mu(e,n,a){return ue(e,a),u=>O(e,n,[u])}function _u(e,n,a){return ue(e,a),u=>O(e,n,[u])}function gu(e,n,a){return ue(e,a),u=>q(e,n,[u])}function bu(e,n){if(e=`${e}`,e!=="bytes")throw new TypeError(`${n} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function yu(e,n){we(e,n);let a=e?.mode;return{mode:a===void 0?void 0:Su(a,`${n} has member 'mode' that`)}}function Su(e,n){if(e=`${e}`,e!=="byob")throw new TypeError(`${n} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function wu(e,n){return we(e,n),{preventCancel:!!e?.preventCancel}}function Ds(e,n){we(e,n);let a=e?.preventAbort,u=e?.preventCancel,c=e?.preventClose,h=e?.signal;return h!==void 0&&xu(h,`${n} has member 'signal' that`),{preventAbort:!!a,preventCancel:!!u,preventClose:!!c,signal:h}}function xu(e,n){if(!Ll(e))throw new TypeError(`${n} is not an AbortSignal.`)}function Ru(e,n){we(e,n);let a=e?.readable;Rn(a,"readable","ReadableWritablePair"),vn(a,`${n} has member 'readable' that`);let u=e?.writable;return Rn(u,"writable","ReadableWritablePair"),_s(u,`${n} has member 'writable' that`),{readable:a,writable:u}}class qe{constructor(n={},a={}){n===void 0?n=null:zi(n,"First parameter");let u=wr(a,"Second parameter"),c=pu(n,"First parameter");if(Qn(this),c.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let h=Lt(u,0);vl(this,c,h)}else{let h=Sr(u),_=Lt(u,1);fu(this,c,_,h)}}get locked(){if(!Fe(this))throw Je("locked");return Ne(this)}cancel(n=void 0){return Fe(this)?Ne(this)?y(new TypeError("Cannot cancel a stream that already has a reader")):ce(this,n):y(Je("cancel"))}getReader(n=void 0){if(!Fe(this))throw Je("getReader");return yu(n,"First parameter").mode===void 0?lt(this):ds(this)}pipeThrough(n,a={}){if(!Fe(this))throw Je("pipeThrough");xe(n,1,"pipeThrough");let u=Ru(n,"First parameter"),c=Ds(a,"Second parameter");if(Ne(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ct(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let h=Is(this,u.writable,c.preventClose,c.preventAbort,c.preventCancel,c.signal);return N(h),u.readable}pipeTo(n,a={}){if(!Fe(this))return y(Je("pipeTo"));if(n===void 0)return y("Parameter 1 is required in 'pipeTo'.");if(!ft(n))return y(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=Ds(a,"Second parameter")}catch(c){return y(c)}return Ne(this)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ct(n)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Is(this,n,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!Fe(this))throw Je("tee");let n=cu(this);return kt(n)}values(n=void 0){if(!Fe(this))throw Je("values");let a=wu(n,"First parameter");return bl(this,a.preventCancel)}}Object.defineProperties(qe.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qe.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(qe.prototype,t.asyncIterator,{value:qe.prototype.values,writable:!0,configurable:!0});function Gn(e,n,a,u=1,c=()=>1){let h=Object.create(qe.prototype);Qn(h);let _=Object.create(ht.prototype);return Ws(h,_,e,n,a,u,c),h}function qs(e,n,a){let u=Object.create(qe.prototype);Qn(u);let c=Object.create(ut.prototype);return cs(u,c,e,n,a,0,void 0),u}function Qn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Fe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof qe}function Ne(e){return e._reader!==void 0}function ce(e,n){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return y(e._storedError);Ut(e);let a=e._reader;a!==void 0&&Qe(a)&&(a._readIntoRequests.forEach(c=>{c._closeSteps(void 0)}),a._readIntoRequests=new $);let u=e._readableStreamController[wn](n);return L(u,i)}function Ut(e){e._state="closed";let n=e._reader;n!==void 0&&(Ni(n),Le(n)&&(n._readRequests.forEach(a=>{a._closeSteps()}),n._readRequests=new $))}function Fs(e,n){e._state="errored",e._storedError=n;let a=e._reader;a!==void 0&&(Sn(a,n),Le(a)?(a._readRequests.forEach(u=>{u._errorSteps(n)}),a._readRequests=new $):(a._readIntoRequests.forEach(u=>{u._errorSteps(n)}),a._readIntoRequests=new $))}function Je(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Ns(e,n){we(e,n);let a=e?.highWaterMark;return Rn(a,"highWaterMark","QueuingStrategyInit"),{highWaterMark:En(a)}}let Us=e=>e.byteLength;try{Object.defineProperty(Us,"name",{value:"size",configurable:!0})}catch{}class Ir{constructor(n){xe(n,1,"ByteLengthQueuingStrategy"),n=Ns(n,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=n.highWaterMark}get highWaterMark(){if(!js(this))throw Ms("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!js(this))throw Ms("size");return Us}}Object.defineProperties(Ir.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ir.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Ms(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function js(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Ir}let zs=()=>1;try{Object.defineProperty(zs,"name",{value:"size",configurable:!0})}catch{}class Lr{constructor(n){xe(n,1,"CountQueuingStrategy"),n=Ns(n,"First parameter"),this._countQueuingStrategyHighWaterMark=n.highWaterMark}get highWaterMark(){if(!Hs(this))throw $s("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Hs(this))throw $s("size");return zs}}Object.defineProperties(Lr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Lr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function $s(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Hs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Lr}function Eu(e,n){we(e,n);let a=e?.flush,u=e?.readableType,c=e?.start,h=e?.transform,_=e?.writableType;return{flush:a===void 0?void 0:vu(a,e,`${n} has member 'flush' that`),readableType:u,start:c===void 0?void 0:Tu(c,e,`${n} has member 'start' that`),transform:h===void 0?void 0:Cu(h,e,`${n} has member 'transform' that`),writableType:_}}function vu(e,n,a){return ue(e,a),u=>O(e,n,[u])}function Tu(e,n,a){return ue(e,a),u=>q(e,n,[u])}function Cu(e,n,a){return ue(e,a),(u,c)=>O(e,n,[u,c])}class Wr{constructor(n={},a={},u={}){n===void 0&&(n=null);let c=wr(a,"Second parameter"),h=wr(u,"Third parameter"),_=Eu(n,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let x=Lt(h,0),C=Sr(h),A=Lt(c,1),B=Sr(c),I,U=b(de=>{I=de});Pu(this,U,A,B,x,C),Au(this,_),_.start!==void 0?I(_.start(this._transformStreamController)):I(void 0)}get readable(){if(!Vs(this))throw Ks("readable");return this._readable}get writable(){if(!Vs(this))throw Ks("writable");return this._writable}}Object.defineProperties(Wr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Wr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Pu(e,n,a,u,c,h){function _(){return n}function x(U){return Iu(e,U)}function C(U){return Lu(e,U)}function A(){return Wu(e)}e._writable=ql(_,x,A,C,a,u);function B(){return Du(e)}function I(U){return qr(e,U),w(void 0)}e._readable=Gn(_,B,I,c,h),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Fr(e,!0),e._transformStreamController=void 0}function Vs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Wr}function Dr(e,n){De(e._readable._readableStreamController,n),qr(e,n)}function qr(e,n){Gs(e._transformStreamController),Un(e._writable._writableStreamController,n),e._backpressure&&Fr(e,!1)}function Fr(e,n){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=b(a=>{e._backpressureChangePromise_resolve=a}),e._backpressure=n}class Mt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Nr(this))throw Ur("desiredSize");let n=this._controlledTransformStream._readable._readableStreamController;return Vn(n)}enqueue(n=void 0){if(!Nr(this))throw Ur("enqueue");Qs(this,n)}error(n=void 0){if(!Nr(this))throw Ur("error");Ou(this,n)}terminate(){if(!Nr(this))throw Ur("terminate");Bu(this)}}Object.defineProperties(Mt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Mt.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Nr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Mt}function ku(e,n,a,u){n._controlledTransformStream=e,e._transformStreamController=n,n._transformAlgorithm=a,n._flushAlgorithm=u}function Au(e,n){let a=Object.create(Mt.prototype),u=h=>{try{return Qs(a,h),w(void 0)}catch(_){return y(_)}},c=()=>w(void 0);n.transform!==void 0&&(u=h=>n.transform(h,a)),n.flush!==void 0&&(c=()=>n.flush(a)),ku(e,a,u,c)}function Gs(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Qs(e,n){let a=e._controlledTransformStream,u=a._readable._readableStreamController;if(!pt(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Or(u,n)}catch(h){throw qr(a,h),a._readable._storedError}uu(u)!==a._backpressure&&Fr(a,!0)}function Ou(e,n){Dr(e._controlledTransformStream,n)}function Ys(e,n){let a=e._transformAlgorithm(n);return L(a,void 0,u=>{throw Dr(e._controlledTransformStream,u),u})}function Bu(e){let n=e._controlledTransformStream,a=n._readable._readableStreamController;Nt(a);let u=new TypeError("TransformStream terminated");qr(n,u)}function Iu(e,n){let a=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return L(u,()=>{let c=e._writable;if(c._state==="erroring")throw c._storedError;return Ys(a,n)})}return Ys(a,n)}function Lu(e,n){return Dr(e,n),w(void 0)}function Wu(e){let n=e._readable,a=e._transformStreamController,u=a._flushAlgorithm();return Gs(a),L(u,()=>{if(n._state==="errored")throw n._storedError;Nt(n._readableStreamController)},c=>{throw Dr(e,c),n._storedError})}function Du(e){return Fr(e,!1),e._backpressureChangePromise}function Ur(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Ks(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Ir,r.CountQueuingStrategy=Lr,r.ReadableByteStreamController=ut,r.ReadableStream=qe,r.ReadableStreamBYOBReader=It,r.ReadableStreamBYOBRequest=At,r.ReadableStreamDefaultController=ht,r.ReadableStreamDefaultReader=Ct,r.TransformStream=Wr,r.TransformStreamDefaultController=Mt,r.WritableStream=Wt,r.WritableStreamDefaultController=dt,r.WritableStreamDefaultWriter=Dt,Object.defineProperty(r,"__esModule",{value:!0})})});var uo=M(()=>{if(!globalThis.ReadableStream)try{let r=require("node:process"),{emitWarning:t}=r;try{r.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),r.emitWarning=t}catch(i){throw r.emitWarning=t,i}}catch{Object.assign(globalThis,lo())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(i){let s=0,o=this;return new ReadableStream({type:"bytes",async pull(l){let m=await o.slice(s,Math.min(o.size,s+65536)).arrayBuffer();s+=m.byteLength,l.enqueue(new Uint8Array(m)),s===o.size&&l.close()}})})}catch{}});async function*Kn(r,t=!0){for(let i of r)if("stream"in i)yield*i.stream();else if(ArrayBuffer.isView(i))if(t){let s=i.byteOffset,o=i.byteOffset+i.byteLength;for(;s!==o;){let l=Math.min(o-s,fo),f=i.buffer.slice(s,s+l);s+=f.byteLength,yield new Uint8Array(f)}}else yield i;else{let s=0,o=i;for(;s!==o.size;){let f=await o.slice(s,Math.min(o.size,s+fo)).arrayBuffer();s+=f.byteLength,yield new Uint8Array(f)}}}var td,fo,co,Hu,ve,zt=jt(()=>{td=V(uo(),1);fo=65536;co=class Jn{#e=[];#t="";#r=0;#n="transparent";constructor(t=[],i={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof i!="object"&&typeof i!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");i===null&&(i={});let s=new TextEncoder;for(let l of t){let f;ArrayBuffer.isView(l)?f=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?f=new Uint8Array(l.slice(0)):l instanceof Jn?f=l:f=s.encode(`${l}`),this.#r+=ArrayBuffer.isView(f)?f.byteLength:f.size,this.#e.push(f)}this.#n=`${i.endings===void 0?"transparent":i.endings}`;let o=i.type===void 0?"":String(i.type);this.#t=/^[\x20-\x7E]*$/.test(o)?o:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,i="";for await(let s of Kn(this.#e,!1))i+=t.decode(s,{stream:!0});return i+=t.decode(),i}async arrayBuffer(){let t=new Uint8Array(this.size),i=0;for await(let s of Kn(this.#e,!1))t.set(s,i),i+=s.length;return t.buffer}stream(){let t=Kn(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(i){let s=await t.next();s.done?i.close():i.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,i=this.size,s=""){let{size:o}=this,l=t<0?Math.max(o+t,0):Math.min(t,o),f=i<0?Math.max(o+i,0):Math.min(i,o),m=Math.max(f-l,0),p=this.#e,d=[],S=0;for(let w of p){if(S>=m)break;let y=ArrayBuffer.isView(w)?w.byteLength:w.size;if(l&&y<=l)l-=y,f-=y;else{let g;ArrayBuffer.isView(w)?(g=w.subarray(l,Math.min(y,f)),S+=g.byteLength):(g=w.slice(l,Math.min(y,f)),S+=g.size),f-=y,d.push(g),l=0}}let b=new Jn([],{type:String(s).toLowerCase()});return b.#r=m,b.#e=d,b}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(co.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Hu=co,ve=Hu});var Vu,Gu,yt,Zn=jt(()=>{zt();Vu=class extends ve{#e=0;#t="";constructor(t,i,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s),s===null&&(s={});let o=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(o)||(this.#e=o),this.#t=String(i)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof ve&&/^(File)$/.test(t[Symbol.toStringTag])}},Gu=Vu,yt=Gu});function mo(r,t=ve){var i=`${ho()}${ho()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],o=`--${i}\r
Content-Disposition: form-data; name="`;return r.forEach((l,f)=>typeof l=="string"?s.push(o+Xn(f)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(o+Xn(f)+`"; filename="${Xn(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),s.push(`--${i}--`),new t(s,{type:"multipart/form-data; boundary="+i})}var $t,Qu,Yu,ho,Ku,po,Xn,Ze,Xe,Hr=jt(()=>{zt();Zn();({toStringTag:$t,iterator:Qu,hasInstance:Yu}=Symbol),ho=Math.random,Ku="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),po=(r,t,i)=>(r+="",/^(Blob|File)$/.test(t&&t[$t])?[(i=i!==void 0?i+"":t[$t]=="File"?t.name:"blob",r),t.name!==i||t[$t]=="blob"?new yt([t],i,t):t]:[r,t+""]),Xn=(r,t)=>(t?r:r.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),Ze=(r,t,i)=>{if(t.length<i)throw new TypeError(`Failed to execute '${r}' on 'FormData': ${i} arguments required, but only ${t.length} present.`)},Xe=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[$t](){return"FormData"}[Qu](){return this.entries()}static[Yu](t){return t&&typeof t=="object"&&t[$t]==="FormData"&&!Ku.some(i=>typeof t[i]!="function")}append(...t){Ze("append",arguments,2),this.#e.push(po(...t))}delete(t){Ze("delete",arguments,1),t+="",this.#e=this.#e.filter(([i])=>i!==t)}get(t){Ze("get",arguments,1),t+="";for(var i=this.#e,s=i.length,o=0;o<s;o++)if(i[o][0]===t)return i[o][1];return null}getAll(t,i){return Ze("getAll",arguments,1),i=[],t+="",this.#e.forEach(s=>s[0]===t&&i.push(s[1])),i}has(t){return Ze("has",arguments,1),t+="",this.#e.some(i=>i[0]===t)}forEach(t,i){Ze("forEach",arguments,1);for(var[s,o]of this)t.call(i,o,s,this)}set(...t){Ze("set",arguments,2);var i=[],s=!0;t=po(...t),this.#e.forEach(o=>{o[0]===t[0]?s&&(s=!i.push(t)):i.push(o)}),s&&i.push(t),this.#e=i}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var So=M((pd,yo)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=require("worker_threads"),t=new r().port1,i=new ArrayBuffer;t.postMessage(i,[i,i])}catch(r){r.constructor.name==="DOMException"&&(globalThis.DOMException=r.constructor)}yo.exports=globalThis.DOMException});var Vt,xo,Ju,wo,ti=jt(()=>{Vt=require("node:fs"),xo=V(So(),1);Zn();zt();({stat:Ju}=Vt.promises),wo=class r{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified}slice(t,i){return new r({path:this.#e,lastModified:this.lastModified,size:i-t,start:this.#t+t})}async*stream(){let{mtimeMs:t}=await Ju(this.#e);if(t>this.lastModified)throw new xo.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,Vt.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var Eo={};Zs(Eo,{toFormData:()=>sf});function nf(r){let t=r.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let i=t[2]||t[3]||"",s=i.slice(i.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(o,l)=>String.fromCharCode(l)),s}async function sf(r,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let i=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!i)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new ri(i[1]||i[2]),o,l,f,m,p,d,S=[],b=new Xe,w=P=>{f+=v.decode(P,{stream:!0})},y=P=>{S.push(P)},g=()=>{let P=new yt(S,d,{type:p});b.append(m,P)},R=()=>{b.append(m,f)},v=new TextDecoder("utf-8");v.decode(),s.onPartBegin=function(){s.onPartData=w,s.onPartEnd=R,o="",l="",f="",m="",p="",d=null,S.length=0},s.onHeaderField=function(P){o+=v.decode(P,{stream:!0})},s.onHeaderValue=function(P){l+=v.decode(P,{stream:!0})},s.onHeaderEnd=function(){if(l+=v.decode(),o=o.toLowerCase(),o==="content-disposition"){let P=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);P&&(m=P[2]||P[3]||""),d=nf(l),d&&(s.onPartData=y,s.onPartEnd=g)}else o==="content-type"&&(p=l);l="",o=""};for await(let P of r)s.write(P);return s.end(),b}var _e,D,Ro,Me,Gr,Qr,Zu,Gt,Xu,ef,tf,rf,et,ri,vo=jt(()=>{ti();Hr();_e=0,D={START_BOUNDARY:_e++,HEADER_FIELD_START:_e++,HEADER_FIELD:_e++,HEADER_VALUE_START:_e++,HEADER_VALUE:_e++,HEADER_VALUE_ALMOST_DONE:_e++,HEADERS_ALMOST_DONE:_e++,PART_DATA_START:_e++,PART_DATA:_e++,END:_e++},Ro=1,Me={PART_BOUNDARY:Ro,LAST_BOUNDARY:Ro*=2},Gr=10,Qr=13,Zu=32,Gt=45,Xu=58,ef=97,tf=122,rf=r=>r|32,et=()=>{},ri=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=et,this.onHeaderField=et,this.onHeadersEnd=et,this.onHeaderValue=et,this.onPartBegin=et,this.onPartData=et,this.onPartEnd=et,this.boundaryChars={},t=`\r
--`+t;let i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s),this.boundaryChars[i[s]]=!0;this.boundary=i,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=D.START_BOUNDARY}write(t){let i=0,s=t.length,o=this.index,{lookbehind:l,boundary:f,boundaryChars:m,index:p,state:d,flags:S}=this,b=this.boundary.length,w=b-1,y=t.length,g,R,v=T=>{this[T+"Mark"]=i},P=T=>{delete this[T+"Mark"]},L=(T,q,O,le)=>{(q===void 0||q!==O)&&this[T](le&&le.subarray(q,O))},N=(T,q)=>{let O=T+"Mark";O in this&&(q?(L(T,this[O],i,t),delete this[O]):(L(T,this[O],t.length,t),this[O]=0))};for(i=0;i<s;i++)switch(g=t[i],d){case D.START_BOUNDARY:if(p===f.length-2){if(g===Gt)S|=Me.LAST_BOUNDARY;else if(g!==Qr)return;p++;break}else if(p-1===f.length-2){if(S&Me.LAST_BOUNDARY&&g===Gt)d=D.END,S=0;else if(!(S&Me.LAST_BOUNDARY)&&g===Gr)p=0,L("onPartBegin"),d=D.HEADER_FIELD_START;else return;break}g!==f[p+2]&&(p=-2),g===f[p+2]&&p++;break;case D.HEADER_FIELD_START:d=D.HEADER_FIELD,v("onHeaderField"),p=0;case D.HEADER_FIELD:if(g===Qr){P("onHeaderField"),d=D.HEADERS_ALMOST_DONE;break}if(p++,g===Gt)break;if(g===Xu){if(p===1)return;N("onHeaderField",!0),d=D.HEADER_VALUE_START;break}if(R=rf(g),R<ef||R>tf)return;break;case D.HEADER_VALUE_START:if(g===Zu)break;v("onHeaderValue"),d=D.HEADER_VALUE;case D.HEADER_VALUE:g===Qr&&(N("onHeaderValue",!0),L("onHeaderEnd"),d=D.HEADER_VALUE_ALMOST_DONE);break;case D.HEADER_VALUE_ALMOST_DONE:if(g!==Gr)return;d=D.HEADER_FIELD_START;break;case D.HEADERS_ALMOST_DONE:if(g!==Gr)return;L("onHeadersEnd"),d=D.PART_DATA_START;break;case D.PART_DATA_START:d=D.PART_DATA,v("onPartData");case D.PART_DATA:if(o=p,p===0){for(i+=w;i<y&&!(t[i]in m);)i+=b;i-=w,g=t[i]}if(p<f.length)f[p]===g?(p===0&&N("onPartData",!0),p++):p=0;else if(p===f.length)p++,g===Qr?S|=Me.PART_BOUNDARY:g===Gt?S|=Me.LAST_BOUNDARY:p=0;else if(p-1===f.length)if(S&Me.PART_BOUNDARY){if(p=0,g===Gr){S&=~Me.PART_BOUNDARY,L("onPartEnd"),L("onPartBegin"),d=D.HEADER_FIELD_START;break}}else S&Me.LAST_BOUNDARY&&g===Gt?(L("onPartEnd"),d=D.END,S=0):p=0;if(p>0)l[p-1]=g;else if(o>0){let T=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);L("onPartData",0,o,T),o=0,v("onPartData"),i--}break;case D.END:break;default:throw new Error(`Unexpected state entered: ${d}`)}N("onHeaderField"),N("onHeaderValue"),N("onPartData"),this.index=p,this.state=d,this.flags=S}end(){if(this.state===D.HEADER_FIELD_START&&this.index===0||this.state===D.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==D.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var ia=M((_h,na)=>{"use strict";var{Duplex:gf}=require("stream");function ta(r){r.emit("close")}function bf(){!this.destroyed&&this._writableState.finished&&this.destroy()}function ra(r){this.removeListener("error",ra),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function yf(r,t){let i=!0,s=new gf({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(l,f){let m=!f&&s._readableState.objectMode?l.toString():l;s.push(m)||r.pause()}),r.once("error",function(l){s.destroyed||(i=!1,s.destroy(l))}),r.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(o,l){if(r.readyState===r.CLOSED){l(o),process.nextTick(ta,s);return}let f=!1;r.once("error",function(p){f=!0,l(p)}),r.once("close",function(){f||l(o),process.nextTick(ta,s)}),i&&r.terminate()},s._final=function(o){if(r.readyState===r.CONNECTING){r.once("open",function(){s._final(o)});return}r._socket!==null&&(r._socket._writableState.finished?(o(),s._readableState.endEmitted&&s.destroy()):(r._socket.once("finish",function(){o()}),r.close()))},s._read=function(){r.isPaused&&r.resume()},s._write=function(o,l,f){if(r.readyState===r.CONNECTING){r.once("open",function(){s._write(o,l,f)});return}r.send(o,f)},s.on("end",bf),s.on("error",ra),s}na.exports=yf});var je=M((gh,sa)=>{"use strict";sa.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Zt=M((bh,nn)=>{"use strict";var{EMPTY_BUFFER:Sf}=je(),ci=Buffer[Symbol.species];function wf(r,t){if(r.length===0)return Sf;if(r.length===1)return r[0];let i=Buffer.allocUnsafe(t),s=0;for(let o=0;o<r.length;o++){let l=r[o];i.set(l,s),s+=l.length}return s<t?new ci(i.buffer,i.byteOffset,s):i}function oa(r,t,i,s,o){for(let l=0;l<o;l++)i[s+l]=r[l]^t[l&3]}function aa(r,t){for(let i=0;i<r.length;i++)r[i]^=t[i&3]}function xf(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function di(r){if(di.readOnly=!0,Buffer.isBuffer(r))return r;let t;return r instanceof ArrayBuffer?t=new ci(r):ArrayBuffer.isView(r)?t=new ci(r.buffer,r.byteOffset,r.byteLength):(t=Buffer.from(r),di.readOnly=!1),t}nn.exports={concat:wf,mask:oa,toArrayBuffer:xf,toBuffer:di,unmask:aa};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=require("bufferutil");nn.exports.mask=function(t,i,s,o,l){l<48?oa(t,i,s,o,l):r.mask(t,i,s,o,l)},nn.exports.unmask=function(t,i){t.length<32?aa(t,i):r.unmask(t,i)}}catch{}});var fa=M((yh,ua)=>{"use strict";var la=Symbol("kDone"),hi=Symbol("kRun"),pi=class{constructor(t){this[la]=()=>{this.pending--,this[hi]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[hi]()}[hi](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[la])}}};ua.exports=pi});var tr=M((Sh,pa)=>{"use strict";var Xt=require("zlib"),ca=Zt(),Rf=fa(),{kStatusCode:da}=je(),Ef=Buffer[Symbol.species],vf=Buffer.from([0,0,255,255]),an=Symbol("permessage-deflate"),Pe=Symbol("total-length"),er=Symbol("callback"),ze=Symbol("buffers"),on=Symbol("error"),sn,mi=class{constructor(t,i,s){if(this._maxPayload=s|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!i,this._deflate=null,this._inflate=null,this.params=null,!sn){let o=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;sn=new Rf(o)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[er];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let i=this._options,s=t.find(o=>!(i.serverNoContextTakeover===!1&&o.server_no_context_takeover||o.server_max_window_bits&&(i.serverMaxWindowBits===!1||typeof i.serverMaxWindowBits=="number"&&i.serverMaxWindowBits>o.server_max_window_bits)||typeof i.clientMaxWindowBits=="number"&&!o.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return i.serverNoContextTakeover&&(s.server_no_context_takeover=!0),i.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof i.serverMaxWindowBits=="number"&&(s.server_max_window_bits=i.serverMaxWindowBits),typeof i.clientMaxWindowBits=="number"?s.client_max_window_bits=i.clientMaxWindowBits:(s.client_max_window_bits===!0||i.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(t){let i=t[0];if(this._options.clientNoContextTakeover===!1&&i.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!i.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(i.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&i.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return i}normalizeParams(t){return t.forEach(i=>{Object.keys(i).forEach(s=>{let o=i[s];if(o.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(o=o[0],s==="client_max_window_bits"){if(o!==!0){let l=+o;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${o}`);o=l}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${o}`)}else if(s==="server_max_window_bits"){let l=+o;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${o}`);o=l}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(o!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${o}`)}else throw new Error(`Unknown parameter "${s}"`);i[s]=o})}),t}decompress(t,i,s){sn.add(o=>{this._decompress(t,i,(l,f)=>{o(),s(l,f)})})}compress(t,i,s){sn.add(o=>{this._compress(t,i,(l,f)=>{o(),s(l,f)})})}_decompress(t,i,s){let o=this._isServer?"client":"server";if(!this._inflate){let l=`${o}_max_window_bits`,f=typeof this.params[l]!="number"?Xt.Z_DEFAULT_WINDOWBITS:this.params[l];this._inflate=Xt.createInflateRaw({...this._options.zlibInflateOptions,windowBits:f}),this._inflate[an]=this,this._inflate[Pe]=0,this._inflate[ze]=[],this._inflate.on("error",Cf),this._inflate.on("data",ha)}this._inflate[er]=s,this._inflate.write(t),i&&this._inflate.write(vf),this._inflate.flush(()=>{let l=this._inflate[on];if(l){this._inflate.close(),this._inflate=null,s(l);return}let f=ca.concat(this._inflate[ze],this._inflate[Pe]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Pe]=0,this._inflate[ze]=[],i&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),s(null,f)})}_compress(t,i,s){let o=this._isServer?"server":"client";if(!this._deflate){let l=`${o}_max_window_bits`,f=typeof this.params[l]!="number"?Xt.Z_DEFAULT_WINDOWBITS:this.params[l];this._deflate=Xt.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:f}),this._deflate[Pe]=0,this._deflate[ze]=[],this._deflate.on("data",Tf)}this._deflate[er]=s,this._deflate.write(t),this._deflate.flush(Xt.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let l=ca.concat(this._deflate[ze],this._deflate[Pe]);i&&(l=new Ef(l.buffer,l.byteOffset,l.length-4)),this._deflate[er]=null,this._deflate[Pe]=0,this._deflate[ze]=[],i&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),s(null,l)})}};pa.exports=mi;function Tf(r){this[ze].push(r),this[Pe]+=r.length}function ha(r){if(this[Pe]+=r.length,this[an]._maxPayload<1||this[Pe]<=this[an]._maxPayload){this[ze].push(r);return}this[on]=new RangeError("Max payload size exceeded"),this[on].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[on][da]=1009,this.removeListener("data",ha),this.reset()}function Cf(r){this[an]._inflate=null,r[da]=1007,this[er](r)}});var rr=M((wh,ln)=>{"use strict";var{isUtf8:ma}=require("buffer"),Pf=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function kf(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function _i(r){let t=r.length,i=0;for(;i<t;)if(!(r[i]&128))i++;else if((r[i]&224)===192){if(i+1===t||(r[i+1]&192)!==128||(r[i]&254)===192)return!1;i+=2}else if((r[i]&240)===224){if(i+2>=t||(r[i+1]&192)!==128||(r[i+2]&192)!==128||r[i]===224&&(r[i+1]&224)===128||r[i]===237&&(r[i+1]&224)===160)return!1;i+=3}else if((r[i]&248)===240){if(i+3>=t||(r[i+1]&192)!==128||(r[i+2]&192)!==128||(r[i+3]&192)!==128||r[i]===240&&(r[i+1]&240)===128||r[i]===244&&r[i+1]>143||r[i]>244)return!1;i+=4}else return!1;return!0}ln.exports={isValidStatusCode:kf,isValidUTF8:_i,tokenChars:Pf};if(ma)ln.exports.isValidUTF8=function(r){return r.length<24?_i(r):ma(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=require("utf-8-validate");ln.exports.isValidUTF8=function(t){return t.length<32?_i(t):r(t)}}catch{}});var wi=M((xh,Ra)=>{"use strict";var{Writable:Af}=require("stream"),_a=tr(),{BINARY_TYPES:Of,EMPTY_BUFFER:ga,kStatusCode:Bf,kWebSocket:If}=je(),{concat:gi,toArrayBuffer:Lf,unmask:Wf}=Zt(),{isValidStatusCode:Df,isValidUTF8:ba}=rr(),un=Buffer[Symbol.species],qf=Promise.resolve(),Ff=typeof queueMicrotask=="function"?queueMicrotask:Nf,xt=0,ya=1,Sa=2,wa=3,bi=4,xa=5,yi=6,Si=class extends Af{constructor(t={}){super(),this._binaryType=t.binaryType||Of[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[If]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=xt,this._loop=!1}_write(t,i,s){if(this._opcode===8&&this._state==xt)return s();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(s)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=new un(s.buffer,s.byteOffset+t,s.length-t),new un(s.buffer,s.byteOffset,t)}let i=Buffer.allocUnsafe(t);do{let s=this._buffers[0],o=i.length-t;t>=s.length?i.set(this._buffers.shift(),o):(i.set(new Uint8Array(s.buffer,s.byteOffset,t),o),this._buffers[0]=new un(s.buffer,s.byteOffset+t,s.length-t)),t-=s.length}while(t>0);return i}startLoop(t){let i;this._loop=!0;do switch(this._state){case xt:i=this.getInfo();break;case ya:i=this.getPayloadLength16();break;case Sa:i=this.getPayloadLength64();break;case wa:this.getMask();break;case bi:i=this.getData(t);break;case xa:this._loop=!1;return;default:this._loop=!1,Ff(()=>{this._state=xt,this.startLoop(t)});return}while(this._loop);t(i)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if(t[0]&48)return this._loop=!1,z(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let i=(t[0]&64)===64;if(i&&!this._extensions[_a.extensionName])return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(i)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,z(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=i}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,z(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(i)return this._loop=!1,z(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1)return this._loop=!1,z(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,z(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,z(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,z(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=ya;else if(this._payloadLength===127)this._state=Sa;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),i=t.readUInt32BE(0);return i>Math.pow(2,53-32)-1?(this._loop=!1,z(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=i*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=wa:this._state=bi}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=bi}getData(t){let i=ga;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}i=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&Wf(i,this._mask)}if(this._opcode>7)return this.controlMessage(i);if(this._compressed){this._state=xa,this.decompress(i,t);return}return i.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(i)),this.dataMessage()}decompress(t,i){this._extensions[_a.extensionName].decompress(t,this._fin,(o,l)=>{if(o)return i(o);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return i(z(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}let f=this.dataMessage();if(f)return i(f);this.startLoop(i)})}dataMessage(){if(this._fin){let t=this._messageLength,i=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=gi(i,t):this._binaryType==="arraybuffer"?s=Lf(gi(i,t)):s=i,this.emit("message",s,!0)}else{let s=gi(i,t);if(!this._skipUTF8Validation&&!ba(s))return this._loop=!1,z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=yi}controlMessage(t){if(this._opcode===8)if(this._loop=!1,t.length===0)this.emit("conclude",1005,ga),this.end(),this._state=xt;else{let i=t.readUInt16BE(0);if(!Df(i))return z(RangeError,`invalid status code ${i}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=new un(t.buffer,t.byteOffset+2,t.length-2);if(!this._skipUTF8Validation&&!ba(s))return z(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",i,s),this.end(),this._state=xt}else this._opcode===9?(this.emit("ping",t),this._state=yi):(this.emit("pong",t),this._state=yi)}};Ra.exports=Si;function z(r,t,i,s,o){let l=new r(i?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(l,z),l.code=o,l[Bf]=s,l}function Nf(r){qf.then(r).catch(Mf)}function Uf(r){throw r}function Mf(r){process.nextTick(Uf,r)}});var Ri=M((Eh,Ta)=>{"use strict";var{Duplex:Rh}=require("stream"),{randomFillSync:jf}=require("crypto"),Ea=tr(),{EMPTY_BUFFER:zf}=je(),{isValidStatusCode:$f}=rr(),{mask:va,toBuffer:Rt}=Zt(),pe=Symbol("kByteLength"),Hf=Buffer.alloc(4),xi=class r{constructor(t,i,s){this._extensions=i||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,i){let s,o=!1,l=2,f=!1;i.mask&&(s=i.maskBuffer||Hf,i.generateMask?i.generateMask(s):jf(s,0,4),f=(s[0]|s[1]|s[2]|s[3])===0,l=6);let m;typeof t=="string"?(!i.mask||f)&&i[pe]!==void 0?m=i[pe]:(t=Buffer.from(t),m=t.length):(m=t.length,o=i.mask&&i.readOnly&&!f);let p=m;m>=65536?(l+=8,p=127):m>125&&(l+=2,p=126);let d=Buffer.allocUnsafe(o?m+l:l);return d[0]=i.fin?i.opcode|128:i.opcode,i.rsv1&&(d[0]|=64),d[1]=p,p===126?d.writeUInt16BE(m,2):p===127&&(d[2]=d[3]=0,d.writeUIntBE(m,4,6)),i.mask?(d[1]|=128,d[l-4]=s[0],d[l-3]=s[1],d[l-2]=s[2],d[l-1]=s[3],f?[d,t]:o?(va(t,s,d,l,m),[d]):(va(t,s,t,0,m),[d,t])):[d,t]}close(t,i,s,o){let l;if(t===void 0)l=zf;else{if(typeof t!="number"||!$f(t))throw new TypeError("First argument must be a valid error code number");if(i===void 0||!i.length)l=Buffer.allocUnsafe(2),l.writeUInt16BE(t,0);else{let m=Buffer.byteLength(i);if(m>123)throw new RangeError("The message must not be greater than 123 bytes");l=Buffer.allocUnsafe(2+m),l.writeUInt16BE(t,0),typeof i=="string"?l.write(i,2):l.set(i,2)}}let f={[pe]:l.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,l,!1,f,o]):this.sendFrame(r.frame(l,f),o)}ping(t,i,s){let o,l;if(typeof t=="string"?(o=Buffer.byteLength(t),l=!1):(t=Rt(t),o=t.length,l=Rt.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let f={[pe]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:9,readOnly:l,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,f,s]):this.sendFrame(r.frame(t,f),s)}pong(t,i,s){let o,l;if(typeof t=="string"?(o=Buffer.byteLength(t),l=!1):(t=Rt(t),o=t.length,l=Rt.readOnly),o>125)throw new RangeError("The data size must not be greater than 125 bytes");let f={[pe]:o,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:10,readOnly:l,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,f,s]):this.sendFrame(r.frame(t,f),s)}send(t,i,s){let o=this._extensions[Ea.extensionName],l=i.binary?2:1,f=i.compress,m,p;if(typeof t=="string"?(m=Buffer.byteLength(t),p=!1):(t=Rt(t),m=t.length,p=Rt.readOnly),this._firstFragment?(this._firstFragment=!1,f&&o&&o.params[o._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(f=m>=o._threshold),this._compress=f):(f=!1,l=0),i.fin&&(this._firstFragment=!0),o){let d={[pe]:m,fin:i.fin,generateMask:this._generateMask,mask:i.mask,maskBuffer:this._maskBuffer,opcode:l,readOnly:p,rsv1:f};this._deflating?this.enqueue([this.dispatch,t,this._compress,d,s]):this.dispatch(t,this._compress,d,s)}else this.sendFrame(r.frame(t,{[pe]:m,fin:i.fin,generateMask:this._generateMask,mask:i.mask,maskBuffer:this._maskBuffer,opcode:l,readOnly:p,rsv1:!1}),s)}dispatch(t,i,s,o){if(!i){this.sendFrame(r.frame(t,s),o);return}let l=this._extensions[Ea.extensionName];this._bufferedBytes+=s[pe],this._deflating=!0,l.compress(t,s.fin,(f,m)=>{if(this._socket.destroyed){let p=new Error("The socket was closed while data was being compressed");typeof o=="function"&&o(p);for(let d=0;d<this._queue.length;d++){let S=this._queue[d],b=S[S.length-1];typeof b=="function"&&b(p)}return}this._bufferedBytes-=s[pe],this._deflating=!1,s.readOnly=!1,this.sendFrame(r.frame(m,s),o),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[3][pe],Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[3][pe],this._queue.push(t)}sendFrame(t,i){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],i),this._socket.uncork()):this._socket.write(t[0],i)}};Ta.exports=xi});var Wa=M((vh,La)=>{"use strict";var{kForOnEventAttribute:nr,kListener:Ei}=je(),Ca=Symbol("kCode"),Pa=Symbol("kData"),ka=Symbol("kError"),Aa=Symbol("kMessage"),Oa=Symbol("kReason"),Et=Symbol("kTarget"),Ba=Symbol("kType"),Ia=Symbol("kWasClean"),ke=class{constructor(t){this[Et]=null,this[Ba]=t}get target(){return this[Et]}get type(){return this[Ba]}};Object.defineProperty(ke.prototype,"target",{enumerable:!0});Object.defineProperty(ke.prototype,"type",{enumerable:!0});var it=class extends ke{constructor(t,i={}){super(t),this[Ca]=i.code===void 0?0:i.code,this[Oa]=i.reason===void 0?"":i.reason,this[Ia]=i.wasClean===void 0?!1:i.wasClean}get code(){return this[Ca]}get reason(){return this[Oa]}get wasClean(){return this[Ia]}};Object.defineProperty(it.prototype,"code",{enumerable:!0});Object.defineProperty(it.prototype,"reason",{enumerable:!0});Object.defineProperty(it.prototype,"wasClean",{enumerable:!0});var vt=class extends ke{constructor(t,i={}){super(t),this[ka]=i.error===void 0?null:i.error,this[Aa]=i.message===void 0?"":i.message}get error(){return this[ka]}get message(){return this[Aa]}};Object.defineProperty(vt.prototype,"error",{enumerable:!0});Object.defineProperty(vt.prototype,"message",{enumerable:!0});var ir=class extends ke{constructor(t,i={}){super(t),this[Pa]=i.data===void 0?null:i.data}get data(){return this[Pa]}};Object.defineProperty(ir.prototype,"data",{enumerable:!0});var Vf={addEventListener(r,t,i={}){for(let o of this.listeners(r))if(!i[nr]&&o[Ei]===t&&!o[nr])return;let s;if(r==="message")s=function(l,f){let m=new ir("message",{data:f?l:l.toString()});m[Et]=this,fn(t,this,m)};else if(r==="close")s=function(l,f){let m=new it("close",{code:l,reason:f.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});m[Et]=this,fn(t,this,m)};else if(r==="error")s=function(l){let f=new vt("error",{error:l,message:l.message});f[Et]=this,fn(t,this,f)};else if(r==="open")s=function(){let l=new ke("open");l[Et]=this,fn(t,this,l)};else return;s[nr]=!!i[nr],s[Ei]=t,i.once?this.once(r,s):this.on(r,s)},removeEventListener(r,t){for(let i of this.listeners(r))if(i[Ei]===t&&!i[nr]){this.removeListener(r,i);break}}};La.exports={CloseEvent:it,ErrorEvent:vt,Event:ke,EventTarget:Vf,MessageEvent:ir};function fn(r,t,i){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,i):r.call(t,i)}});var vi=M((Th,Da)=>{"use strict";var{tokenChars:sr}=rr();function ye(r,t,i){r[t]===void 0?r[t]=[i]:r[t].push(i)}function Gf(r){let t=Object.create(null),i=Object.create(null),s=!1,o=!1,l=!1,f,m,p=-1,d=-1,S=-1,b=0;for(;b<r.length;b++)if(d=r.charCodeAt(b),f===void 0)if(S===-1&&sr[d]===1)p===-1&&(p=b);else if(b!==0&&(d===32||d===9))S===-1&&p!==-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b);let y=r.slice(p,S);d===44?(ye(t,y,i),i=Object.create(null)):f=y,p=S=-1}else throw new SyntaxError(`Unexpected character at index ${b}`);else if(m===void 0)if(S===-1&&sr[d]===1)p===-1&&(p=b);else if(d===32||d===9)S===-1&&p!==-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b),ye(i,r.slice(p,S),!0),d===44&&(ye(t,f,i),i=Object.create(null),f=void 0),p=S=-1}else if(d===61&&p!==-1&&S===-1)m=r.slice(p,b),p=S=-1;else throw new SyntaxError(`Unexpected character at index ${b}`);else if(o){if(sr[d]!==1)throw new SyntaxError(`Unexpected character at index ${b}`);p===-1?p=b:s||(s=!0),o=!1}else if(l)if(sr[d]===1)p===-1&&(p=b);else if(d===34&&p!==-1)l=!1,S=b;else if(d===92)o=!0;else throw new SyntaxError(`Unexpected character at index ${b}`);else if(d===34&&r.charCodeAt(b-1)===61)l=!0;else if(S===-1&&sr[d]===1)p===-1&&(p=b);else if(p!==-1&&(d===32||d===9))S===-1&&(S=b);else if(d===59||d===44){if(p===-1)throw new SyntaxError(`Unexpected character at index ${b}`);S===-1&&(S=b);let y=r.slice(p,S);s&&(y=y.replace(/\\/g,""),s=!1),ye(i,m,y),d===44&&(ye(t,f,i),i=Object.create(null),f=void 0),m=void 0,p=S=-1}else throw new SyntaxError(`Unexpected character at index ${b}`);if(p===-1||l||d===32||d===9)throw new SyntaxError("Unexpected end of input");S===-1&&(S=b);let w=r.slice(p,S);return f===void 0?ye(t,w,i):(m===void 0?ye(i,w,!0):s?ye(i,m,w.replace(/\\/g,"")):ye(i,m,w),ye(t,f,i)),t}function Qf(r){return Object.keys(r).map(t=>{let i=r[t];return Array.isArray(i)||(i=[i]),i.map(s=>[t].concat(Object.keys(s).map(o=>{let l=s[o];return Array.isArray(l)||(l=[l]),l.map(f=>f===!0?o:`${o}=${f}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Da.exports={format:Qf,parse:Gf}});var Ai=M((kh,Ga)=>{"use strict";var Yf=require("events"),Kf=require("https"),Jf=require("http"),Na=require("net"),Zf=require("tls"),{randomBytes:Xf,createHash:ec}=require("crypto"),{Duplex:Ch,Readable:Ph}=require("stream"),{URL:Ti}=require("url"),$e=tr(),tc=wi(),rc=Ri(),{BINARY_TYPES:qa,EMPTY_BUFFER:cn,GUID:nc,kForOnEventAttribute:Ci,kListener:ic,kStatusCode:sc,kWebSocket:G,NOOP:Ua}=je(),{EventTarget:{addEventListener:oc,removeEventListener:ac}}=Wa(),{format:lc,parse:uc}=vi(),{toBuffer:fc}=Zt(),cc=30*1e3,Ma=Symbol("kAborted"),Pi=[8,13],Ae=["CONNECTING","OPEN","CLOSING","CLOSED"],dc=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,F=class r extends Yf{constructor(t,i,s){super(),this._binaryType=qa[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=cn,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,i===void 0?i=[]:Array.isArray(i)||(typeof i=="object"&&i!==null?(s=i,i=[]):i=[i]),ja(this,t,i,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){qa.includes(t)&&(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,i,s){let o=new tc({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new rc(t,this._extensions,s.generateMask),this._receiver=o,this._socket=t,o[G]=this,t[G]=this,o.on("conclude",mc),o.on("drain",_c),o.on("error",gc),o.on("message",bc),o.on("ping",yc),o.on("pong",Sc),t.setTimeout&&t.setTimeout(0),t.setNoDelay&&t.setNoDelay(),i.length>0&&t.unshift(i),t.on("close",$a),t.on("data",hn),t.on("end",Ha),t.on("error",Va),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[$e.extensionName]&&this._extensions[$e.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,i){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){let s="WebSocket was closed before the connection was established";re(this,this._req,s);return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(t,i,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),cc)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=i=void 0):typeof i=="function"&&(s=i,i=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){ki(this,t,s);return}i===void 0&&(i=!this._isServer),this._sender.ping(t||cn,i,s)}pong(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=i=void 0):typeof i=="function"&&(s=i,i=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){ki(this,t,s);return}i===void 0&&(i=!this._isServer),this._sender.pong(t||cn,i,s)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,i,s){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof i=="function"&&(s=i,i={}),typeof t=="number"&&(t=t.toString()),this.readyState!==r.OPEN){ki(this,t,s);return}let o={binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0,...i};this._extensions[$e.extensionName]||(o.compress=!1),this._sender.send(t||cn,o,s)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){let t="WebSocket was closed before the connection was established";re(this,this._req,t);return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(F,"CONNECTING",{enumerable:!0,value:Ae.indexOf("CONNECTING")});Object.defineProperty(F.prototype,"CONNECTING",{enumerable:!0,value:Ae.indexOf("CONNECTING")});Object.defineProperty(F,"OPEN",{enumerable:!0,value:Ae.indexOf("OPEN")});Object.defineProperty(F.prototype,"OPEN",{enumerable:!0,value:Ae.indexOf("OPEN")});Object.defineProperty(F,"CLOSING",{enumerable:!0,value:Ae.indexOf("CLOSING")});Object.defineProperty(F.prototype,"CLOSING",{enumerable:!0,value:Ae.indexOf("CLOSING")});Object.defineProperty(F,"CLOSED",{enumerable:!0,value:Ae.indexOf("CLOSED")});Object.defineProperty(F.prototype,"CLOSED",{enumerable:!0,value:Ae.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(F.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(F.prototype,`on${r}`,{enumerable:!0,get(){for(let t of this.listeners(r))if(t[Ci])return t[ic];return null},set(t){for(let i of this.listeners(r))if(i[Ci]){this.removeListener(r,i);break}typeof t=="function"&&this.addEventListener(r,t,{[Ci]:!0})}})});F.prototype.addEventListener=oc;F.prototype.removeEventListener=ac;Ga.exports=F;function ja(r,t,i,s){let o={protocolVersion:Pi[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Pi.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${Pi.join(", ")})`);let l;if(t instanceof Ti)l=t;else try{l=new Ti(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}l.protocol==="http:"?l.protocol="ws:":l.protocol==="https:"&&(l.protocol="wss:"),r._url=l.href;let f=l.protocol==="wss:",m=l.protocol==="ws+unix:",p;if(l.protocol!=="ws:"&&!f&&!m?p=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:m&&!l.pathname?p="The URL's pathname is empty":l.hash&&(p="The URL contains a fragment identifier"),p){let R=new SyntaxError(p);if(r._redirects===0)throw R;dn(r,R);return}let d=f?443:80,S=Xf(16).toString("base64"),b=f?Kf.request:Jf.request,w=new Set,y;if(o.createConnection=f?pc:hc,o.defaultPort=o.defaultPort||d,o.port=l.port||d,o.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,o.headers={...o.headers,"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":S,Connection:"Upgrade",Upgrade:"websocket"},o.path=l.pathname+l.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(y=new $e(o.perMessageDeflate!==!0?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=lc({[$e.extensionName]:y.offer()})),i.length){for(let R of i){if(typeof R!="string"||!dc.test(R)||w.has(R))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(R)}o.headers["Sec-WebSocket-Protocol"]=i.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(l.username||l.password)&&(o.auth=`${l.username}:${l.password}`),m){let R=o.path.split(":");o.socketPath=R[0],o.path=R[1]}let g;if(o.followRedirects){if(r._redirects===0){r._originalIpc=m,r._originalSecure=f,r._originalHostOrSocketPath=m?o.socketPath:l.host;let R=s&&s.headers;if(s={...s,headers:{}},R)for(let[v,P]of Object.entries(R))s.headers[v.toLowerCase()]=P}else if(r.listenerCount("redirect")===0){let R=m?r._originalIpc?o.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:l.host===r._originalHostOrSocketPath;(!R||r._originalSecure&&!f)&&(delete o.headers.authorization,delete o.headers.cookie,R||delete o.headers.host,o.auth=void 0)}o.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64")),g=r._req=b(o),r._redirects&&r.emit("redirect",r.url,g)}else g=r._req=b(o);o.timeout&&g.on("timeout",()=>{re(r,g,"Opening handshake has timed out")}),g.on("error",R=>{g===null||g[Ma]||(g=r._req=null,dn(r,R))}),g.on("response",R=>{let v=R.headers.location,P=R.statusCode;if(v&&o.followRedirects&&P>=300&&P<400){if(++r._redirects>o.maxRedirects){re(r,g,"Maximum redirects exceeded");return}g.abort();let L;try{L=new Ti(v,t)}catch{let T=new SyntaxError(`Invalid URL: ${v}`);dn(r,T);return}ja(r,L,i,s)}else r.emit("unexpected-response",g,R)||re(r,g,`Unexpected server response: ${R.statusCode}`)}),g.on("upgrade",(R,v,P)=>{if(r.emit("upgrade",R),r.readyState!==F.CONNECTING)return;if(g=r._req=null,R.headers.upgrade.toLowerCase()!=="websocket"){re(r,v,"Invalid Upgrade header");return}let L=ec("sha1").update(S+nc).digest("base64");if(R.headers["sec-websocket-accept"]!==L){re(r,v,"Invalid Sec-WebSocket-Accept header");return}let N=R.headers["sec-websocket-protocol"],T;if(N!==void 0?w.size?w.has(N)||(T="Server sent an invalid subprotocol"):T="Server sent a subprotocol but none was requested":w.size&&(T="Server sent no subprotocol"),T){re(r,v,T);return}N&&(r._protocol=N);let q=R.headers["sec-websocket-extensions"];if(q!==void 0){if(!y){re(r,v,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let O;try{O=uc(q)}catch{re(r,v,"Invalid Sec-WebSocket-Extensions header");return}let le=Object.keys(O);if(le.length!==1||le[0]!==$e.extensionName){re(r,v,"Server indicated an extension that was not requested");return}try{y.accept(O[$e.extensionName])}catch{re(r,v,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[$e.extensionName]=y}r.setSocket(v,P,{generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})}),o.finishRequest?o.finishRequest(g,r):g.end()}function dn(r,t){r._readyState=F.CLOSING,r.emit("error",t),r.emitClose()}function hc(r){return r.path=r.socketPath,Na.connect(r)}function pc(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=Na.isIP(r.host)?"":r.host),Zf.connect(r)}function re(r,t,i){r._readyState=F.CLOSING;let s=new Error(i);Error.captureStackTrace(s,re),t.setHeader?(t[Ma]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(dn,r,s)):(t.destroy(s),t.once("error",r.emit.bind(r,"error")),t.once("close",r.emitClose.bind(r)))}function ki(r,t,i){if(t){let s=fc(t).length;r._socket?r._sender._bufferedBytes+=s:r._bufferedAmount+=s}if(i){let s=new Error(`WebSocket is not open: readyState ${r.readyState} (${Ae[r.readyState]})`);process.nextTick(i,s)}}function mc(r,t){let i=this[G];i._closeFrameReceived=!0,i._closeMessage=t,i._closeCode=r,i._socket[G]!==void 0&&(i._socket.removeListener("data",hn),process.nextTick(za,i._socket),r===1005?i.close():i.close(r,t))}function _c(){let r=this[G];r.isPaused||r._socket.resume()}function gc(r){let t=this[G];t._socket[G]!==void 0&&(t._socket.removeListener("data",hn),process.nextTick(za,t._socket),t.close(r[sc])),t.emit("error",r)}function Fa(){this[G].emitClose()}function bc(r,t){this[G].emit("message",r,t)}function yc(r){let t=this[G];t.pong(r,!t._isServer,Ua),t.emit("ping",r)}function Sc(r){this[G].emit("pong",r)}function za(r){r.resume()}function $a(){let r=this[G];this.removeListener("close",$a),this.removeListener("data",hn),this.removeListener("end",Ha),r._readyState=F.CLOSING;let t;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(t=r._socket.read())!==null&&r._receiver.write(t),r._receiver.end(),this[G]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",Fa),r._receiver.on("finish",Fa))}function hn(r){this[G]._receiver.write(r)||this.pause()}function Ha(){let r=this[G];r._readyState=F.CLOSING,r._receiver.end(),this.end()}function Va(){let r=this[G];this.removeListener("error",Va),this.on("error",Ua),r&&(r._readyState=F.CLOSING,this.destroy())}});var Ya=M((Ah,Qa)=>{"use strict";var{tokenChars:wc}=rr();function xc(r){let t=new Set,i=-1,s=-1,o=0;for(o;o<r.length;o++){let f=r.charCodeAt(o);if(s===-1&&wc[f]===1)i===-1&&(i=o);else if(o!==0&&(f===32||f===9))s===-1&&i!==-1&&(s=o);else if(f===44){if(i===-1)throw new SyntaxError(`Unexpected character at index ${o}`);s===-1&&(s=o);let m=r.slice(i,s);if(t.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);t.add(m),i=s=-1}else throw new SyntaxError(`Unexpected character at index ${o}`)}if(i===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let l=r.slice(i,o);if(t.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);return t.add(l),t}Qa.exports={parse:xc}});var rl=M((Bh,tl)=>{"use strict";var Rc=require("events"),pn=require("http"),{Duplex:Oh}=require("stream"),{createHash:Ec}=require("crypto"),Ka=vi(),st=tr(),vc=Ya(),Tc=Ai(),{GUID:Cc,kWebSocket:Pc}=je(),kc=/^[+/0-9A-Za-z]{22}==$/,Ja=0,Za=1,el=2,Oi=class extends Rc{constructor(t,i){if(super(),t={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Tc,...t},t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=pn.createServer((s,o)=>{let l=pn.STATUS_CODES[426];o.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),o.end(l)}),this._server.listen(t.port,t.host,t.backlog,i)):t.server&&(this._server=t.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=Ac(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(o,l,f)=>{this.handleUpgrade(o,l,f,s)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=Ja}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===el){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(or,this);return}if(t&&this.once("close",t),this._state!==Za)if(this._state=Za,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(or,this):process.nextTick(or,this);else{let i=this._server;this._removeListeners(),this._removeListeners=this._server=null,i.close(()=>{or(this)})}}shouldHandle(t){if(this.options.path){let i=t.url.indexOf("?");if((i!==-1?t.url.slice(0,i):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,i,s,o){i.on("error",Xa);let l=t.headers["sec-websocket-key"],f=+t.headers["sec-websocket-version"];if(t.method!=="GET"){ot(this,t,i,405,"Invalid HTTP method");return}if(t.headers.upgrade.toLowerCase()!=="websocket"){ot(this,t,i,400,"Invalid Upgrade header");return}if(!l||!kc.test(l)){ot(this,t,i,400,"Missing or invalid Sec-WebSocket-Key header");return}if(f!==8&&f!==13){ot(this,t,i,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(t)){ar(i,400);return}let m=t.headers["sec-websocket-protocol"],p=new Set;if(m!==void 0)try{p=vc.parse(m)}catch{ot(this,t,i,400,"Invalid Sec-WebSocket-Protocol header");return}let d=t.headers["sec-websocket-extensions"],S={};if(this.options.perMessageDeflate&&d!==void 0){let b=new st(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let w=Ka.parse(d);w[st.extensionName]&&(b.accept(w[st.extensionName]),S[st.extensionName]=b)}catch{ot(this,t,i,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let b={origin:t.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(b,(w,y,g,R)=>{if(!w)return ar(i,y||401,g,R);this.completeUpgrade(S,l,p,t,i,s,o)});return}if(!this.options.verifyClient(b))return ar(i,401)}this.completeUpgrade(S,l,p,t,i,s,o)}completeUpgrade(t,i,s,o,l,f,m){if(!l.readable||!l.writable)return l.destroy();if(l[Pc])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>Ja)return ar(l,503);let d=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Ec("sha1").update(i+Cc).digest("base64")}`],S=new this.options.WebSocket(null);if(s.size){let b=this.options.handleProtocols?this.options.handleProtocols(s,o):s.values().next().value;b&&(d.push(`Sec-WebSocket-Protocol: ${b}`),S._protocol=b)}if(t[st.extensionName]){let b=t[st.extensionName].params,w=Ka.format({[st.extensionName]:[b]});d.push(`Sec-WebSocket-Extensions: ${w}`),S._extensions=t}this.emit("headers",d,o),l.write(d.concat(`\r
`).join(`\r
`)),l.removeListener("error",Xa),S.setSocket(l,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(S),S.on("close",()=>{this.clients.delete(S),this._shouldEmitClose&&!this.clients.size&&process.nextTick(or,this)})),m(S,o)}};tl.exports=Oi;function Ac(r,t){for(let i of Object.keys(t))r.on(i,t[i]);return function(){for(let s of Object.keys(t))r.removeListener(s,t[s])}}function or(r){r._state=el,r.emit("close")}function Xa(){this.destroy()}function ar(r,t,i,s){i=i||pn.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(i),...s},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${t} ${pn.STATUS_CODES[t]}\r
`+Object.keys(s).map(o=>`${o}: ${s[o]}`).join(`\r
`)+`\r
\r
`+i)}function ot(r,t,i,s,o){if(r.listenerCount("wsClientError")){let l=new Error(o);Error.captureStackTrace(l,ot),r.emit("wsClientError",l,i,t)}else ar(i,s,o)}});var Vc={};Zs(Vc,{onBrowserWindowCreated:()=>$c,output:()=>Ie,requestCallbackMap:()=>Tt});module.exports=ju(Vc);var zo=V(so());var Uo=V(require("node:http"),1),Mo=V(require("node:https"),1),rt=V(require("node:zlib"),1),te=V(require("node:stream"),1),Kt=require("node:buffer");function $u(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let t=r.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let i=r.substring(5,t).split(";"),s="",o=!1,l=i[0]||"text/plain",f=l;for(let S=1;S<i.length;S++)i[S]==="base64"?o=!0:i[S]&&(f+=`;${i[S]}`,i[S].indexOf("charset=")===0&&(s=i[S].substring(8)));!i[0]&&!s.length&&(f+=";charset=US-ASCII",s="US-ASCII");let m=o?"base64":"ascii",p=unescape(r.substring(t+1)),d=Buffer.from(p,m);return d.type=l,d.typeFull=f,d.charset=s,d}var oo=$u;var oe=V(require("node:stream"),1),Ce=require("node:util"),X=require("node:buffer");zt();Hr();var Te=class extends Error{constructor(t,i){super(t),Error.captureStackTrace(this,this.constructor),this.type=i}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var K=class extends Te{constructor(t,i,s){super(t,i),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var Vr=Symbol.toStringTag,ei=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[Vr]==="URLSearchParams",Ht=r=>r&&typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[Vr]),_o=r=>typeof r=="object"&&(r[Vr]==="AbortSignal"||r[Vr]==="EventTarget"),go=(r,t)=>{let i=new URL(t).hostname,s=new URL(r).hostname;return i===s||i.endsWith(`.${s}`)},bo=(r,t)=>{let i=new URL(t).protocol,s=new URL(r).protocol;return i===s};var of=(0,Ce.promisify)(oe.default.pipeline),J=Symbol("Body internals"),ge=class{constructor(t,{size:i=0}={}){let s=null;t===null?t=null:ei(t)?t=X.Buffer.from(t.toString()):Ht(t)||X.Buffer.isBuffer(t)||(Ce.types.isAnyArrayBuffer(t)?t=X.Buffer.from(t):ArrayBuffer.isView(t)?t=X.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof oe.default||(t instanceof Xe?(t=mo(t),s=t.type.split("=")[1]):t=X.Buffer.from(String(t))));let o=t;X.Buffer.isBuffer(t)?o=oe.default.Readable.from(t):Ht(t)&&(o=oe.default.Readable.from(t.stream())),this[J]={body:t,stream:o,boundary:s,disturbed:!1,error:null},this.size=i,t instanceof oe.default&&t.on("error",l=>{let f=l instanceof Te?l:new K(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[J].error=f})}get body(){return this[J].stream}get bodyUsed(){return this[J].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:i,byteLength:s}=await ni(this);return t.slice(i,i+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new Xe,o=new URLSearchParams(await this.text());for(let[l,f]of o)s.append(l,f);return s}let{toFormData:i}=await Promise.resolve().then(()=>(vo(),Eo));return i(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[J].body&&this[J].body.type||"",i=await this.arrayBuffer();return new ve([i],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await ni(this);return new TextDecoder().decode(t)}buffer(){return ni(this)}};ge.prototype.buffer=(0,Ce.deprecate)(ge.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ge.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,Ce.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function ni(r){if(r[J].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[J].disturbed=!0,r[J].error)throw r[J].error;let{body:t}=r;if(t===null)return X.Buffer.alloc(0);if(!(t instanceof oe.default))return X.Buffer.alloc(0);let i=[],s=0;try{for await(let o of t){if(r.size>0&&s+o.length>r.size){let l=new K(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw t.destroy(l),l}s+=o.length,i.push(o)}}catch(o){throw o instanceof Te?o:new K(`Invalid response body while trying to fetch ${r.url}: ${o.message}`,"system",o)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return i.every(o=>typeof o=="string")?X.Buffer.from(i.join("")):X.Buffer.concat(i,s)}catch(o){throw new K(`Could not create Buffer from response body for ${r.url}: ${o.message}`,"system",o)}else throw new K(`Premature close of server response while trying to fetch ${r.url}`)}var St=(r,t)=>{let i,s,{body:o}=r[J];if(r.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof oe.default&&typeof o.getBoundary!="function"&&(i=new oe.PassThrough({highWaterMark:t}),s=new oe.PassThrough({highWaterMark:t}),o.pipe(i),o.pipe(s),r[J].stream=i,o=s),o},af=(0,Ce.deprecate)(r=>r.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Yr=(r,t)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":ei(r)?"application/x-www-form-urlencoded;charset=UTF-8":Ht(r)?r.type||null:X.Buffer.isBuffer(r)||Ce.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r instanceof Xe?`multipart/form-data; boundary=${t[J].boundary}`:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${af(r)}`:r instanceof oe.default?null:"text/plain;charset=UTF-8",To=r=>{let{body:t}=r[J];return t===null?0:Ht(t)?t.size:X.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Co=async(r,{body:t})=>{t===null?r.end():await of(t,r)};var ii=require("node:util"),Qt=V(require("node:http"),1),Kr=typeof Qt.default.validateHeaderName=="function"?Qt.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let t=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},si=typeof Qt.default.validateHeaderValue=="function"?Qt.default.validateHeaderValue:(r,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let i=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(i,"code",{value:"ERR_INVALID_CHAR"}),i}},ee=class r extends URLSearchParams{constructor(t){let i=[];if(t instanceof r){let s=t.raw();for(let[o,l]of Object.entries(s))i.push(...l.map(f=>[o,f]))}else if(t!=null)if(typeof t=="object"&&!ii.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)i.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");i=[...t].map(o=>{if(typeof o!="object"||ii.types.isBoxedPrimitive(o))throw new TypeError("Each header pair must be an iterable object");return[...o]}).map(o=>{if(o.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...o]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return i=i.length>0?i.map(([s,o])=>(Kr(s),si(s,String(o)),[String(s).toLowerCase(),String(o)])):void 0,super(i),new Proxy(this,{get(s,o,l){switch(o){case"append":case"set":return(f,m)=>(Kr(f),si(f,String(m)),URLSearchParams.prototype[o].call(s,String(f).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return f=>(Kr(f),URLSearchParams.prototype[o].call(s,String(f).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,o,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let i=this.getAll(t);if(i.length===0)return null;let s=i.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,i=void 0){for(let s of this.keys())Reflect.apply(t,i,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,i)=>(t[i]=this.getAll(i),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,i)=>{let s=this.getAll(i);return i==="host"?t[i]=s[0]:t[i]=s.length>1?s:s[0],t},{})}};Object.defineProperties(ee.prototype,["get","entries","forEach","values"].reduce((r,t)=>(r[t]={enumerable:!0},r),{}));function Po(r=[]){return new ee(r.reduce((t,i,s,o)=>(s%2===0&&t.push(o.slice(s,s+2)),t),[]).filter(([t,i])=>{try{return Kr(t),si(t,String(i)),!0}catch{return!1}}))}var lf=new Set([301,302,303,307,308]),Jr=r=>lf.has(r);var he=Symbol("Response internals"),ae=class r extends ge{constructor(t=null,i={}){super(t,i);let s=i.status!=null?i.status:200,o=new ee(i.headers);if(t!==null&&!o.has("Content-Type")){let l=Yr(t,this);l&&o.append("Content-Type",l)}this[he]={type:"default",url:i.url,status:s,statusText:i.statusText||"",headers:o,counter:i.counter,highWaterMark:i.highWaterMark}}get type(){return this[he].type}get url(){return this[he].url||""}get status(){return this[he].status}get ok(){return this[he].status>=200&&this[he].status<300}get redirected(){return this[he].counter>0}get statusText(){return this[he].statusText}get headers(){return this[he].headers}get highWaterMark(){return this[he].highWaterMark}clone(){return new r(St(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,i=302){if(!Jr(i))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new r(null,{headers:{location:new URL(t).toString()},status:i})}static error(){let t=new r(null,{status:0,statusText:""});return t[he].type="error",t}static json(t=void 0,i={}){let s=JSON.stringify(t);if(s===void 0)throw new TypeError("data is not JSON serializable");let o=new ee(i&&i.headers);return o.has("content-type")||o.set("content-type","application/json"),new r(s,{...i,headers:o})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(ae.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var qo=require("node:url"),Fo=require("node:util");var ko=r=>{if(r.search)return r.search;let t=r.href.length-1,i=r.hash||(r.href[t]==="#"?"#":"");return r.href[t-i.length]==="?"?"?":""};var Oo=require("node:net");function Ao(r,t=!1){return r==null||(r=new URL(r),/^(about|blob|data):$/.test(r.protocol))?"no-referrer":(r.username="",r.password="",r.hash="",t&&(r.pathname="",r.search=""),r)}var Bo=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Io="strict-origin-when-cross-origin";function Lo(r){if(!Bo.has(r))throw new TypeError(`Invalid referrerPolicy: ${r}`);return r}function uf(r){if(/^(http|ws)s:$/.test(r.protocol))return!0;let t=r.host.replace(/(^\[)|(]$)/g,""),i=(0,Oo.isIP)(t);return i===4&&/^127\./.test(t)||i===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:r.host==="localhost"||r.host.endsWith(".localhost")?!1:r.protocol==="file:"}function wt(r){return/^about:(blank|srcdoc)$/.test(r)||r.protocol==="data:"||/^(blob|filesystem):$/.test(r.protocol)?!0:uf(r)}function Wo(r,{referrerURLCallback:t,referrerOriginCallback:i}={}){if(r.referrer==="no-referrer"||r.referrerPolicy==="")return null;let s=r.referrerPolicy;if(r.referrer==="about:client")return"no-referrer";let o=r.referrer,l=Ao(o),f=Ao(o,!0);l.toString().length>4096&&(l=f),t&&(l=t(l)),i&&(f=i(f));let m=new URL(r.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return f;case"unsafe-url":return l;case"strict-origin":return wt(l)&&!wt(m)?"no-referrer":f.toString();case"strict-origin-when-cross-origin":return l.origin===m.origin?l:wt(l)&&!wt(m)?"no-referrer":f;case"same-origin":return l.origin===m.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===m.origin?l:f;case"no-referrer-when-downgrade":return wt(l)&&!wt(m)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Do(r){let t=(r.get("referrer-policy")||"").split(/[,\s]+/),i="";for(let s of t)s&&Bo.has(s)&&(i=s);return i}var j=Symbol("Request internals"),Yt=r=>typeof r=="object"&&typeof r[j]=="object",ff=(0,Fo.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),tt=class r extends ge{constructor(t,i={}){let s;if(Yt(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let o=i.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(o)&&(o=o.toUpperCase()),!Yt(i)&&"data"in i&&ff(),(i.body!=null||Yt(t)&&t.body!==null)&&(o==="GET"||o==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=i.body?i.body:Yt(t)&&t.body!==null?St(t):null;super(l,{size:i.size||t.size||0});let f=new ee(i.headers||t.headers||{});if(l!==null&&!f.has("Content-Type")){let d=Yr(l,this);d&&f.set("Content-Type",d)}let m=Yt(t)?t.signal:null;if("signal"in i&&(m=i.signal),m!=null&&!_o(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let p=i.referrer==null?t.referrer:i.referrer;if(p==="")p="no-referrer";else if(p){let d=new URL(p);p=/^about:(\/\/)?client$/.test(d)?"client":d}else p=void 0;this[j]={method:o,redirect:i.redirect||t.redirect||"follow",headers:f,parsedURL:s,signal:m,referrer:p},this.follow=i.follow===void 0?t.follow===void 0?20:t.follow:i.follow,this.compress=i.compress===void 0?t.compress===void 0?!0:t.compress:i.compress,this.counter=i.counter||t.counter||0,this.agent=i.agent||t.agent,this.highWaterMark=i.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=i.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=i.referrerPolicy||t.referrerPolicy||""}get method(){return this[j].method}get url(){return(0,qo.format)(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}get referrer(){if(this[j].referrer==="no-referrer")return"";if(this[j].referrer==="client")return"about:client";if(this[j].referrer)return this[j].referrer.toString()}get referrerPolicy(){return this[j].referrerPolicy}set referrerPolicy(t){this[j].referrerPolicy=Lo(t)}clone(){return new r(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(tt.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var No=r=>{let{parsedURL:t}=r[j],i=new ee(r[j].headers);i.has("Accept")||i.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let m=To(r);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&i.set("Content-Length",s),r.referrerPolicy===""&&(r.referrerPolicy=Io),r.referrer&&r.referrer!=="no-referrer"?r[j].referrer=Wo(r):r[j].referrer="no-referrer",r[j].referrer instanceof URL&&i.set("Referer",r.referrer),i.has("User-Agent")||i.set("User-Agent","node-fetch"),r.compress&&!i.has("Accept-Encoding")&&i.set("Accept-Encoding","gzip, deflate, br");let{agent:o}=r;typeof o=="function"&&(o=o(t));let l=ko(t),f={path:t.pathname+l,method:r.method,headers:i[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:o};return{parsedURL:t,options:f}};var Zr=class extends Te{constructor(t,i="aborted"){super(t,i)}};Hr();ti();var cf=new Set(["data:","http:","https:"]);async function Xr(r,t){return new Promise((i,s)=>{let o=new tt(r,t),{parsedURL:l,options:f}=No(o);if(!cf.has(l.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let g=oo(o.url),R=new ae(g,{headers:{"Content-Type":g.typeFull}});i(R);return}let m=(l.protocol==="https:"?Mo.default:Uo.default).request,{signal:p}=o,d=null,S=()=>{let g=new Zr("The operation was aborted.");s(g),o.body&&o.body instanceof te.default.Readable&&o.body.destroy(g),!(!d||!d.body)&&d.body.emit("error",g)};if(p&&p.aborted){S();return}let b=()=>{S(),y()},w=m(l.toString(),f);p&&p.addEventListener("abort",b);let y=()=>{w.abort(),p&&p.removeEventListener("abort",b)};w.on("error",g=>{s(new K(`request to ${o.url} failed, reason: ${g.message}`,"system",g)),y()}),df(w,g=>{d&&d.body&&d.body.destroy(g)}),process.version<"v14"&&w.on("socket",g=>{let R;g.prependListener("end",()=>{R=g._eventsCount}),g.prependListener("close",v=>{if(d&&R<g._eventsCount&&!v){let P=new Error("Premature close");P.code="ERR_STREAM_PREMATURE_CLOSE",d.body.emit("error",P)}})}),w.on("response",g=>{w.setTimeout(0);let R=Po(g.rawHeaders);if(Jr(g.statusCode)){let T=R.get("Location"),q=null;try{q=T===null?null:new URL(T,o.url)}catch{if(o.redirect!=="manual"){s(new K(`uri requested responds with an invalid redirect URL: ${T}`,"invalid-redirect")),y();return}}switch(o.redirect){case"error":s(new K(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),y();return;case"manual":break;case"follow":{if(q===null)break;if(o.counter>=o.follow){s(new K(`maximum redirect reached at: ${o.url}`,"max-redirect")),y();return}let O={headers:new ee(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:St(o),signal:o.signal,size:o.size,referrer:o.referrer,referrerPolicy:o.referrerPolicy};if(!go(o.url,q)||!bo(o.url,q))for(let $ of["authorization","www-authenticate","cookie","cookie2"])O.headers.delete($);if(g.statusCode!==303&&o.body&&t.body instanceof te.default.Readable){s(new K("Cannot follow redirect with body being a readable stream","unsupported-redirect")),y();return}(g.statusCode===303||(g.statusCode===301||g.statusCode===302)&&o.method==="POST")&&(O.method="GET",O.body=void 0,O.headers.delete("content-length"));let le=Do(R);le&&(O.referrerPolicy=le),i(Xr(new tt(q,O))),y();return}default:return s(new TypeError(`Redirect option '${o.redirect}' is not a valid value of RequestRedirect`))}}p&&g.once("end",()=>{p.removeEventListener("abort",b)});let v=(0,te.pipeline)(g,new te.PassThrough,T=>{T&&s(T)});process.version<"v12.10"&&g.on("aborted",b);let P={url:o.url,status:g.statusCode,statusText:g.statusMessage,headers:R,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},L=R.get("Content-Encoding");if(!o.compress||o.method==="HEAD"||L===null||g.statusCode===204||g.statusCode===304){d=new ae(v,P),i(d);return}let N={flush:rt.default.Z_SYNC_FLUSH,finishFlush:rt.default.Z_SYNC_FLUSH};if(L==="gzip"||L==="x-gzip"){v=(0,te.pipeline)(v,rt.default.createGunzip(N),T=>{T&&s(T)}),d=new ae(v,P),i(d);return}if(L==="deflate"||L==="x-deflate"){let T=(0,te.pipeline)(g,new te.PassThrough,q=>{q&&s(q)});T.once("data",q=>{(q[0]&15)===8?v=(0,te.pipeline)(v,rt.default.createInflate(),O=>{O&&s(O)}):v=(0,te.pipeline)(v,rt.default.createInflateRaw(),O=>{O&&s(O)}),d=new ae(v,P),i(d)}),T.once("end",()=>{d||(d=new ae(v,P),i(d))});return}if(L==="br"){v=(0,te.pipeline)(v,rt.default.createBrotliDecompress(),T=>{T&&s(T)}),d=new ae(v,P),i(d);return}d=new ae(v,P),i(d)}),Co(w,o).catch(s)})}function df(r,t){let i=Kt.Buffer.from(`0\r
\r
`),s=!1,o=!1,l;r.on("response",f=>{let{headers:m}=f;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),r.on("socket",f=>{let m=()=>{if(s&&!o){let d=new Error("Premature close");d.code="ERR_STREAM_PREMATURE_CLOSE",t(d)}},p=d=>{o=Kt.Buffer.compare(d.slice(-5),i)===0,!o&&l&&(o=Kt.Buffer.compare(l.slice(-3),i.slice(0,3))===0&&Kt.Buffer.compare(d.slice(-2),i.slice(3))===0),l=d};f.prependListener("close",m),f.on("data",p),r.on("close",()=>{f.removeListener("close",m),f.removeListener("data",p)})})}var $o=require("node:fs/promises"),Ho=require("node:fs"),rn=require("node:path"),Vo=require("node:stream/promises"),Go=require("node:crypto");var be=require("fs"),ai=require("path");var nt,jo=LiteLoader.plugins.NSQQ.path.data,tn=(0,ai.join)(jo,"tmp/upload"),en=(0,ai.join)(jo,"settings.json"),oi={qq:"",url:"localhost:2536"};(0,be.existsSync)(tn)||(0,be.mkdirSync)(tn,{recursive:!0});if(!(0,be.existsSync)(en))nt=oi,(0,be.writeFileSync)(en,JSON.stringify(oi,null,4),"utf-8");else{let r=(0,be.readFileSync)(en,"utf-8");nt=li(JSON.parse(r),oi),(0,be.writeFileSync)(en,JSON.stringify(nt,null,4),"utf-8")}var Qo=()=>(0,Go.randomBytes)(16).toString("hex"),hf=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,Yo=r=>{let t=[],i=s=>{for(let o in s)s[o]instanceof Map||(typeof s[o]!="object"&&typeof s[o]!="function"?t.push([o,s[o],s]):i(s[o]))};return i(r),t};async function Ko(r){let t=new URL(r),i,s,o;switch(t.protocol){case"https:":{let l=await Xr(t);i=(0,rn.basename)(t.pathname);let f=l.headers.get("Content-Disposition");if(f&&f.indexOf("attachment")!==-1){let m=hf.exec(f);m&&m[1]&&(i=m[1].replace(/['"]/g,""))}if(o=l.headers.get("Content-Type")||void 0,o&&!i.includes(".")){let m=zo.default.getExtension(o);i+=m?"."+m:""}s=await pf(l.body,i);break}case"base64:":{let l=t.pathname;i=Qo()+".png",s=await mf(Buffer.from(l,"base64"),i);break}default:throw new Error(`unsupportted protocol: ${t.protocol}`)}return s}async function pf(r,t){let i=await Jo(t);return await(0,Vo.finished)(r.pipe((0,Ho.createWriteStream)(i))),i}async function mf(r,t){let i=await Jo(t);return await(0,$o.writeFile)(i,r),i}async function Jo(r){return(0,rn.join)(tn,`${Qo()}-${r}`)}function li(r,t){let i=Object.keys(r),s=Object.keys(t);for(let o of s)i.includes(o)?typeof r[o]=="object"&&typeof t[o]=="object"&&(r[o]=li(r[o],t[o])):r[o]=t[o];return r}var ui={},fi={};function Zo(r,t,i){console.log(`\x1B[34m[uinCache]\x1B[0m ${t} -> ${i}`,"color: blue"),!(parseInt(t)===0||parseInt(i)===0)&&(r[t]=i,r[i]=t)}function _f(r){let t={uid:"uin",uin:"uid",Uid:"Uin",Uin:"Uid",uidStr:"uinStr",uinStr:"uidStr",UidStr:"UinStr",UinStr:"UidStr"};for(let i in t)if(r.endsWith(i))return r.slice(0,-i.length)+t[i]}function Xo(r){for(let[t,i,s]of Yo(r)){let o;if(o=_f(t),o&&s[o]){if(parseInt(s[o])==0||ui[i]||parseInt(i)==0)continue;Zo(ui,i,s[o])}if(t==="msgId"){if(parseInt(s[t])==0||fi[i]||parseInt(i)==0)continue;Zo(fi,i,s.peerUid)}}}function Jt(r){return ui[r]??r}function ea(r){return fi[r]??r}var ul=require("node:events");var Oc=V(ia(),1),Bc=V(wi(),1),Ic=V(Ri(),1),Bi=V(Ai(),1),Lc=V(rl(),1);var He=require("electron");var nl=V(require("crypto")),_n=new Uint8Array(256),mn=_n.length;function Ii(){return mn>_n.length-16&&(nl.default.randomFillSync(_n),mn=0),_n.slice(mn,mn+=16)}var H=[];for(let r=0;r<256;++r)H.push((r+256).toString(16).slice(1));function il(r,t=0){return H[r[t+0]]+H[r[t+1]]+H[r[t+2]]+H[r[t+3]]+"-"+H[r[t+4]]+H[r[t+5]]+"-"+H[r[t+6]]+H[r[t+7]]+"-"+H[r[t+8]]+H[r[t+9]]+"-"+H[r[t+10]]+H[r[t+11]]+H[r[t+12]]+H[r[t+13]]+H[r[t+14]]+H[r[t+15]]}var sl=V(require("crypto")),Li={randomUUID:sl.default.randomUUID};function Wc(r,t,i){if(Li.randomUUID&&!t&&!r)return Li.randomUUID();r=r||{};let s=r.random||(r.rng||Ii)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){i=i||0;for(let o=0;o<16;++o)t[i+o]=s[o];return t}return il(s)}var Wi=Wc;He.ipcMain.emit=He.ipcMain.emit.bind(He.ipcMain);var ne=async(r,t,i,s)=>{let o=Wi(),l=await Promise.race([new Promise(f=>{Tt[o]=f,He.ipcMain.emit=He.ipcMain.emit.bind(He.ipcMain),He.ipcMain.emit(r,{sender:{send:(...m)=>{f(m)}}},{type:"request",callbackId:o,eventName:t},[i,...s])})]);return delete Tt[o],l};function Dc(r){return{elementType:1,elementId:"",textElement:{content:r.data.text,atType:0,atUid:"",atTinyId:"",atNtUid:""}}}function qc(r){let t=Jt(r.data.qq);return{elementType:1,elementId:"",textElement:{content:"",atType:t==="all"?1:2,atUid:t==="all"?"all":t,atTinyId:"",atNtUid:t==="all"?"all":t}}}async function Fc(r){let t=await ne("IPC_UP_2","ns-FsApi-2","getFileType",[r]),i=await ne("IPC_UP_2","ns-FsApi-2","getFileMd5",[r]),s=`${i}.${t.ext}`,o=await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/getRichMediaFilePathForGuild",[{path_info:{md5HexStr:i,fileName:s,elementType:2,elementSubType:0,thumbSize:0,needCreate:!0,downloadType:1,file_uuid:""}}]);await ne("IPC_UP_2","ns-FsApi-2","copyFile",[{fromPath:r,toPath:o}]);let l=await ne("IPC_UP_2","ns-FsApi-2","getImageSizeFromPath",[r]),f=await ne("IPC_UP_2","ns-FsApi-2","getFileSize",[r]);return{md5HexStr:i,fileSize:f,picWidth:l.width,picHeight:l.height,fileName:s,sourcePath:o,original:!0,picType:1001,picSubType:0,fileUuid:"",fileSubId:"",thumbFileSize:0,summary:""}}async function Nc(r){let t=await Ko(r.data.file);return r=await Fc(t),{elementType:2,elementId:"",picElement:r}}function Uc(r){return{chatType:r.chatType=="friend"?1:r.chatType=="group"?2:1,peerUid:r.uid,guildId:""}}var gn={Text:Dc,At:qc,Peer:Uc,Image:Nc};async function ol(r){switch(r.action){case"get_login_info":Oe({data:{user_id:ie,nickname:""},echo:r.echo});break;case"get_guild_service_profile":Oe({data:{nickname:ie,tiny_id:"",avatar_url:""},echo:r.echo});break;case"get_online_clients":Oe({data:{clients:[]},echo:r.echo});break;case"get_version_info":Oe({data:{app_name:"NSQQ",app_version:"v1.0.0",app_full_name:"NSQQ",protocol_name:6,protocol_version:"v11",coolq_edition:"pro",coolq_directory:"","go-cqhttp":!1,plugin_version:"4.15.0",plugin_build_number:99,plugin_build_configuration:"release",runtime_version:"v1.0.0",runtime_os:"ntqq",version:"v1.0.0"},echo:r.echo});break;case"send_msg":let t=r.params.message;await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/sendMsg",[{msgId:"0",peer:{chatType:2,peerUid:String(r.params.group_id),guildId:""},msgElements:await Promise.all(t.map(async i=>{if(i.type=="text")return gn.Text(i);if(i.type=="at")return gn.At(i);if(i.type=="image")return await gn.Image(i)})),msgAttributeInfos:new Map},void 0]),lr.on("my_message",i=>{Oe({data:{message_id:i.msgId},echo:r.echo})});break;case"delete_msg":await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelMsgService/recallMsg",[{peer:{chatType:2,peerUid:ea(r.params.message_id),guildId:""},msgIds:[r.params.message_id]}]);case"send_like":await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelProfileLikeService/setBuddyProfileLike",[{doLikeUserInfo:{friendUid:"u_4B8ETD3ySVv--pNnQAupOA",sourceId:71,doLikeCount:1,doLikeTollCount:0}},void 0]);default:break}}var Mc=`ws://${nt.url}/go-cqhttp`,Be,al=null,jc=5,Di=0;async function qi(){return await Promise.race([new Promise(r=>{Be=new Bi.default(Mc),Ie(`\u8FDE\u63A5\u5730\u5740: ${Be.url}`),Be.on("open",()=>{if(Ie("WebSocket \u8FDE\u63A5\u5DF2\u5EFA\u7ACB"),Di=0,ie!==0){let t={time:Date.now(),self_id:ie,post_type:"meta_event",meta_event_type:"lifecycle",sub_type:"enable"};Oe(t),r(!0)}}),Be.on("message",t=>{ol(JSON.parse(t))}),Be.on("close",(t,i)=>{Ie(`WebSocket \u8FDE\u63A5\u5DF2\u5173\u95ED\uFF0C\u4EE3\u7801: ${t}, \u539F\u56E0: ${i}`),Di<jc?(Di++,al=setTimeout(()=>{Ie("\u5C1D\u8BD5\u91CD\u65B0\u8FDE\u63A5 WebSocket..."),qi()},500)):(clearInterval(al),Ie("\u8FBE\u5230\u6700\u5927\u91CD\u8FDE\u5C1D\u8BD5\u6B21\u6570\uFF0C\u505C\u6B62\u91CD\u8FDE\u3002"))}),Be.on("error",t=>{console.error(`WebSocket \u8FDE\u63A5\u51FA\u73B0\u9519\u8BEF: ${t.message}`)})})])}function Oe(r){Be.send(JSON.stringify(r))}async function ll(r){await ne("IPC_UP_2","ns-ntApi-2","nodeIKernelGroupService/getMemberInfo",[r,void 0])}var ie=0,lr=new ul.EventEmitter;function zc(r,t){for(let i in r)if(r.hasOwnProperty(i)&&i.endsWith(t)&&r[i]!==null)return i}async function fl(r){let t=r?.[0]?.cmdName,i=r?.[0]?.payload;if(r?.account?.length>0&&ie===0){if(String(parseInt(r.account,10))!==nt.qq)return;ie=parseInt(r.account,10);let s={time:Date.now(),self_id:ie,post_type:"meta_event",meta_event_type:"lifecycle",sub_type:"enable"};await qi(),Oe(s),Ie(`${ie} - \u767B\u5F55\u6210\u529F`)}if(ie!==0)switch(Xo(i),t){case"nodeIKernelMsgListener/onRecvMsg":let s=i.msgList[0];await ll({forceUpdate:!1,groupCode:+s.peerUid,uids:[s.senderUid]});let o={time:Date.now(),self_id:ie,post_type:"message",message_type:s.msgType===1?"private":"group",sub_type:"normal",message_id:s.msgId,group_id:parseInt(s.peerUid,10),user_id:Jt(s.senderUid),anonymous:null,message:[],raw_message:"",font:0,sender:{user_id:Jt(s.senderUid),nickname:s.sendNickName,sex:"",age:0}};s.elements.forEach(f=>{switch(zc(f,"Element")){case"textElement":o.raw_message+=f.textElement?.content,o.message.push({type:"text",data:{text:f.textElement?.content}});break;case"faceElement":o.message.push({type:"face",data:{id:f.faceElement?.faceIndex}});break;case"picElement":o.message.push({type:"image",data:{file:f.picElement?.sourcePath}});break}}),Be.send(JSON.stringify(o));break;case"nodeIKernelRecentContactListener/onRecentContactListChanged":let l=i.changedList[0];parseInt(l.senderUin,10)===ie&&lr.emit("my_message",l);break;case"nodeIKernelProfileListener/onProfileDetailInfoChanged":lr.emit("getUserInfo",i.info);break;default:break}}var Tt={};async function $c(r){let t=r.webContents.send,i=(s,...o)=>(Tt[o[0].callbackId]&&Tt[o[0].callbackId]?.call(o[0],o[1]),fl(o?.[1]),t.call(r.webContents,s,...o));r.webContents.send=i}function cl(r,t){if(typeof r=="object")for(let i in r)r.hasOwnProperty(i)&&(r[i]=cl(r[i],t));else typeof r=="string"&&r.length>t&&(r=r.substring(0,t-2)+"..");return r}function Hc(r,t=64){try{return r.map(i=>{let s=JSON.parse(i);return s=cl(s,t),JSON.stringify(s)})}catch{return r}}function Ie(...r){console.log("\x1B[32m[NSQQ]\x1B[0m",...Hc(r))}0&&(module.exports={onBrowserWindowCreated,output,requestCallbackMap});
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
